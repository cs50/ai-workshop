0
00:00:43,419 --> 00:00:43,430
All

1
00:00:44,290 --> 00:00:44,610
right,

2
00:00:44,849 --> 00:00:46,700
this is CS 50.

3
00:00:46,919 --> 00:00:48,360
This is already week 9,

4
00:00:48,450 --> 00:00:50,529
and I dare say this week is the most

5
00:00:50,529 --> 00:00:53,130
representative of what you'll be doing after the class

6
00:00:53,130 --> 00:00:56,759
if you so choose to program in the future and tackle some project that's new to you.

7
00:00:56,889 --> 00:00:57,209
In fact,

8
00:00:57,299 --> 00:00:59,680
the closest to this week was perhaps week 6,

9
00:00:59,689 --> 00:01:02,130
wherein we didn't really introduce all that many new

10
00:01:02,130 --> 00:01:05,209
concepts but really translated them from C into Python.

11
00:01:05,250 --> 00:01:05,919
And so this week,

12
00:01:05,930 --> 00:01:06,319
in particular,

13
00:01:06,370 --> 00:01:10,239
the goal is to really synthesize the past 10 weeks of class,

14
00:01:10,489 --> 00:01:11,970
drawing upon a lot of the building blocks that are.

15
00:01:12,045 --> 00:01:12,755
Hopefully now,

16
00:01:13,396 --> 00:01:16,475
metaphorically in your toolbox and gives you an opportunity

17
00:01:16,475 --> 00:01:18,755
now to apply those ideas to new problems,

18
00:01:18,835 --> 00:01:20,456
in particular web programming.

19
00:01:20,515 --> 00:01:22,956
So every day you and I are using the web in some form,

20
00:01:23,036 --> 00:01:25,115
every day you and I are using mobile apps in some form,

21
00:01:25,155 --> 00:01:28,155
and we said last week that the languages underlying a lot of

22
00:01:28,155 --> 00:01:31,435
those applications are HTML and JavaScript for the layout and aesthetics,

23
00:01:31,496 --> 00:01:34,606
and then also in part JavaScript for a lot of the client side

24
00:01:34,916 --> 00:01:37,206
interactivity that you might experience nowadays.

25
00:01:37,356 --> 00:01:40,555
Well today we come full circle and bring back a server.

26
00:01:40,671 --> 00:01:43,582
Side component whereby we'll again write some Python,

27
00:01:43,622 --> 00:01:46,262
we'll again write some SQL code and use

28
00:01:46,262 --> 00:01:49,501
it to make our full fledged own web applications

29
00:01:49,501 --> 00:01:53,692
and in turn if you so choose mobile applications as for your final project as well.

30
00:01:53,982 --> 00:01:56,291
So up until now when we did anything with the web,

31
00:01:56,382 --> 00:01:58,092
you ran this command last week,

32
00:01:58,101 --> 00:01:58,942
HTTP server,

33
00:01:58,952 --> 00:01:59,942
which literally did just that.

34
00:01:59,982 --> 00:02:03,342
It spawned a so-called HTTP server that is a web server whose purpose

35
00:02:03,342 --> 00:02:06,022
in life is just to serve up content from like your current folder,

36
00:02:06,061 --> 00:02:07,052
any files they're in,

37
00:02:07,302 --> 00:02:08,352
any folders therein.

38
00:02:08,382 --> 00:02:09,181
And so all of the U.

39
00:02:09,295 --> 00:02:11,386
URLs generally followed a certain format.

40
00:02:11,447 --> 00:02:18,367
So if your URL were example.com recall just denotes the root of the web server.

41
00:02:18,406 --> 00:02:21,697
And so in there typically by default you would see a directory index.

42
00:02:21,886 --> 00:02:23,486
We'll see today that that goes away

43
00:02:23,486 --> 00:02:25,977
because generally when you visit something.com/,

44
00:02:26,207 --> 00:02:27,526
you want to see the actual website,

45
00:02:27,606 --> 00:02:29,727
not the contents of everything in the server.

46
00:02:29,766 --> 00:02:31,326
So we'll see how to address that.

47
00:02:31,486 --> 00:02:34,406
But the URLs up until now have been a form like file.

48
00:02:34,606 --> 00:02:35,207
HTML,

49
00:02:35,406 --> 00:02:37,766
literally referencing a file in that folder or.

50
00:02:37,923 --> 00:02:38,753
folder slash,

51
00:02:38,794 --> 00:02:41,994
which just means whatever is inside of that folder or folder file.

52
00:02:42,154 --> 00:02:45,673
HTML or you can nest these things however long that you

53
00:02:45,673 --> 00:02:48,113
want and recall that more generally we said that you're referring

54
00:02:48,113 --> 00:02:51,313
to some kind of path on the server where path is

55
00:02:51,313 --> 00:02:54,384
a step of folders ending in perhaps a file name.

56
00:02:54,554 --> 00:02:56,313
So today we're going to generalize that at least in

57
00:02:56,313 --> 00:02:59,253
terms of nomenclature and start talking more about routes because

58
00:02:59,253 --> 00:03:02,233
essentially in web programming we are going to exercise a

59
00:03:02,233 --> 00:03:05,184
lot more control over what is in the URL.

60
00:03:05,373 --> 00:03:06,503
So back in the day.

61
00:03:06,729 --> 00:03:08,960
It referred to literally a file on the server,

62
00:03:09,039 --> 00:03:10,630
and as recently as last week,

63
00:03:10,720 --> 00:03:13,350
the URLs referred to literally a file on the server.

64
00:03:13,639 --> 00:03:14,119
However,

65
00:03:14,279 --> 00:03:17,470
we'll see in code that we can actually just parse this,

66
00:03:17,520 --> 00:03:19,630
that is analyze what is after

67
00:03:19,880 --> 00:03:20,250
the

68
00:03:20,559 --> 00:03:24,669
domain name in a URL and just use this as generic input

69
00:03:24,669 --> 00:03:27,110
to the server to figure out what kind of output to produce.

70
00:03:27,240 --> 00:03:28,559
We're going to see the same convention though

71
00:03:28,559 --> 00:03:30,520
if you want to pass in specific parameters,

72
00:03:30,720 --> 00:03:31,669
key value pairers,

73
00:03:32,000 --> 00:03:34,080
we'll use a question mark after our so-called route,

74
00:03:34,320 --> 00:03:34,800
key equals.

75
00:03:35,072 --> 00:03:36,863
And then if there's another one or more,

76
00:03:36,953 --> 00:03:39,352
we'll just separate them by ampersands.

77
00:03:39,393 --> 00:03:43,873
And to do all of this we're going to recall the inside of those virtual

78
00:03:43,873 --> 00:03:47,313
envelopes recall that if we did something like on Google.com to search for cats,

79
00:03:47,382 --> 00:03:50,902
what was really being sent to the server was a request for slash search,

80
00:03:51,113 --> 00:03:52,432
which notice is not search.

81
00:03:52,712 --> 00:03:53,393
HTML.

82
00:03:53,473 --> 00:03:54,912
There's no folder per se there.

83
00:03:55,033 --> 00:03:58,503
This is just the name of a program really running on Google servers,

84
00:03:58,613 --> 00:03:59,792
and that's going to be the so-called

85
00:03:59,792 --> 00:04:02,143
route that we ourselves start programming today.

86
00:04:02,313 --> 00:04:02,792
Question mark.

87
00:04:03,166 --> 00:04:05,186
cats just meant that the query parameter,

88
00:04:05,225 --> 00:04:06,695
the input from the web form,

89
00:04:06,906 --> 00:04:10,345
is going to contain in this particular example the word cats.

90
00:04:10,585 --> 00:04:11,906
So how are we going to do I'll do this?

91
00:04:11,985 --> 00:04:14,496
So we could implement our own web server in C.

92
00:04:14,666 --> 00:04:17,946
It would be a nightmare to like use a language as low level as C

93
00:04:17,946 --> 00:04:21,216
and actually deal with something as high level as writing code for the web.

94
00:04:21,466 --> 00:04:23,346
We're instead going to use Python for the most part,

95
00:04:23,425 --> 00:04:25,135
if only because it's much higher level,

96
00:04:25,305 --> 00:04:27,696
but even then we would probably,

97
00:04:27,746 --> 00:04:30,295
if we wanted to do this thing from scratch,

98
00:04:30,466 --> 00:04:32,178
we would have to write a A lot of Python

99
00:04:32,178 --> 00:04:35,459
code to like analyze the insides of these envelopes,

100
00:04:35,498 --> 00:04:38,058
figure out what inputs are being passed to the server,

101
00:04:38,098 --> 00:04:40,489
and then figure out how to access that in Python code.

102
00:04:40,618 --> 00:04:43,539
It's just a lot of work to just get a web application up and working.

103
00:04:43,579 --> 00:04:45,389
And so what the world generally does is they don't

104
00:04:45,389 --> 00:04:48,408
reinvent the wheel of writing their own web server.

105
00:04:48,579 --> 00:04:51,498
rather they use an off the shelf fairly generic web

106
00:04:51,498 --> 00:04:54,128
server or application server as it might be called,

107
00:04:54,299 --> 00:04:54,799
and we,

108
00:04:54,819 --> 00:04:55,178
for instance,

109
00:04:55,188 --> 00:04:56,658
are going to use something called Flask.

110
00:04:56,739 --> 00:04:59,098
Now Flask is a framework as the world would say,

111
00:04:59,139 --> 00:04:59,449
or

112
00:04:59,611 --> 00:05:00,291
More specifically,

113
00:05:00,332 --> 00:05:01,291
a micro framework,

114
00:05:01,332 --> 00:05:03,532
which just means it's a library of code that other people

115
00:05:03,532 --> 00:05:06,671
wrote to make it easier for us to implement web applications.

116
00:05:06,731 --> 00:05:11,122
So they took the time to figure out how to handle get requests on a server,

117
00:05:11,372 --> 00:05:13,002
post requests on a server,

118
00:05:13,131 --> 00:05:15,891
figure out how to extract key value pairs from URLs,

119
00:05:15,902 --> 00:05:18,171
the sort of commodity stuff that like literally every

120
00:05:18,171 --> 00:05:20,562
web application on the internet has to do anyway,

121
00:05:20,611 --> 00:05:23,372
so we don't have to retrace those steps ourselves.

122
00:05:23,462 --> 00:05:24,932
What this will allow us to do is only

123
00:05:24,932 --> 00:05:27,611
implement the problems that we care about by using.

124
00:05:27,695 --> 00:05:29,125
This framework and to be clear,

125
00:05:29,244 --> 00:05:31,484
a framework much like bootstrap is not only a

126
00:05:31,484 --> 00:05:33,635
library that someone else has written for you,

127
00:05:33,725 --> 00:05:35,915
but it's like a set of conventions that you follow

128
00:05:35,915 --> 00:05:39,364
in order to use the library in their recommended way.

129
00:05:39,445 --> 00:05:42,644
So it's more of a generic term that includes library and a set of conventions.

130
00:05:42,704 --> 00:05:44,005
And how do you know how to use either?

131
00:05:44,125 --> 00:05:46,725
You just read the documentation or take a class in which we're

132
00:05:46,725 --> 00:05:49,595
about to give you an introduction to some of this right here.

133
00:05:49,804 --> 00:05:53,125
So instead of running today HTTP server to start

134
00:05:53,125 --> 00:05:55,804
a web server that just serves up static content.

135
00:05:56,037 --> 00:05:57,638
Files and folders in our account.

136
00:05:57,838 --> 00:06:00,997
We're instead going to run the command moving forward flask space,

137
00:06:01,238 --> 00:06:01,708
run,

138
00:06:01,917 --> 00:06:05,558
and this is going to look for code that we've written in our current directory.

139
00:06:05,657 --> 00:06:08,078
And if it is in accordance with the conventions

140
00:06:08,078 --> 00:06:10,588
to which I'm alluding by using this so-called framework,

141
00:06:10,757 --> 00:06:14,608
then it's going to start our web application on some TCP port,

142
00:06:14,678 --> 00:06:15,037
for instance,

143
00:06:15,048 --> 00:06:15,717
8080,

144
00:06:15,727 --> 00:06:17,187
as we discussed last week.

145
00:06:17,358 --> 00:06:17,828
To do this,

146
00:06:17,877 --> 00:06:19,437
all we have to have in our current folder

147
00:06:19,437 --> 00:06:22,907
is minimally a file called app.ie by default.

148
00:06:23,118 --> 00:06:23,958
This is hinting at an.

149
00:06:24,080 --> 00:06:26,230
Application written in the language called Python and what

150
00:06:26,230 --> 00:06:28,061
code we put in there we'll soon see.

151
00:06:28,270 --> 00:06:32,631
And then ideally we would have another text file called requirements.text

152
00:06:32,631 --> 00:06:35,591
by convention inside of which is just one per line,

153
00:06:35,631 --> 00:06:39,101
the name of all of the libraries that we want this web application to include.

154
00:06:39,311 --> 00:06:39,790
In other words,

155
00:06:39,871 --> 00:06:41,501
if I go over here to VS code,

156
00:06:41,871 --> 00:06:43,390
if I don't have such a file,

157
00:06:43,430 --> 00:06:43,941
that's fine,

158
00:06:43,990 --> 00:06:45,591
but I want to use a framework like Flask,

159
00:06:45,601 --> 00:06:48,971
recall our PIP command for installing Python packages.

160
00:06:48,990 --> 00:06:49,960
I could just say PI,

161
00:06:50,240 --> 00:06:50,811
install,

162
00:06:51,110 --> 00:06:51,670
flask,

163
00:06:51,830 --> 00:06:52,010
E.

164
00:06:52,403 --> 00:06:56,104
And that would go ahead and install the flask framework or library for me just like

165
00:06:56,104 --> 00:07:00,614
we did a few weeks ago with installing the silly little cow say library as well.

166
00:07:00,753 --> 00:07:02,894
I've already done that in advance and better still,

167
00:07:03,023 --> 00:07:03,794
I've installed,

168
00:07:04,144 --> 00:07:04,973
I've come with

169
00:07:05,384 --> 00:07:06,854
uh my code today,

170
00:07:07,104 --> 00:07:09,384
both of these files AAinerequirements.text.

171
00:07:09,403 --> 00:07:10,014
And in fact,

172
00:07:10,144 --> 00:07:13,174
if I go ahead and create one just for fun here,

173
00:07:13,384 --> 00:07:16,104
all you need to do in a requirements.text file is literally

174
00:07:16,104 --> 00:07:18,533
put the name of the library that you want to include,

175
00:07:18,664 --> 00:07:20,343
and then you run PIP in a slightly different.

176
00:07:20,467 --> 00:07:24,886
Way to install that library or any other libraries that are in that file as well.

177
00:07:25,096 --> 00:07:28,326
So let me wave my hands at the requirements.text for moving forward.

178
00:07:28,416 --> 00:07:31,226
It just means what libraries do you want to use with this web application so

179
00:07:31,226 --> 00:07:34,816
you don't have to remember or memorize them and type them all out manually.

180
00:07:35,136 --> 00:07:35,457
All right,

181
00:07:35,566 --> 00:07:38,096
so what's going to go inside of app.ie?

182
00:07:38,217 --> 00:07:38,296
Well,

183
00:07:38,377 --> 00:07:41,177
the minimal amount of code that we can write to make our own

184
00:07:41,177 --> 00:07:44,647
web application that does something like print out Hello world to my browser

185
00:07:44,937 --> 00:07:46,407
could look like this.

186
00:07:46,617 --> 00:07:48,346
Now there's a bit of new syntax here,

187
00:07:48,377 --> 00:07:50,089
but All that much today moving forward,

188
00:07:50,170 --> 00:07:53,209
the very first line just says from Flask import flask,

189
00:07:53,290 --> 00:07:56,920
which is a weird way of just saying give me access to the flask library.

190
00:07:57,010 --> 00:07:58,290
Capitalization no matters,

191
00:07:58,350 --> 00:08:01,649
and so the package that we're using is called Flask lowercase,

192
00:08:01,890 --> 00:08:04,440
but we want to have access to a special function in there

193
00:08:04,609 --> 00:08:06,130
called Flask F.

194
00:08:06,250 --> 00:08:07,799
So this is sort of a copy paste line.

195
00:08:07,970 --> 00:08:09,250
The next one's a little weird looking,

196
00:08:09,329 --> 00:08:11,880
but it essentially says Give me a variable called app

197
00:08:12,250 --> 00:08:16,279
and turn this file into a flask application.

198
00:08:16,359 --> 00:08:16,730
We haven't seen.

199
00:08:16,852 --> 00:08:17,562
In a few weeks,

200
00:08:17,683 --> 00:08:20,433
but there was that weird if conditional that we put at the bottom

201
00:08:20,433 --> 00:08:23,953
of some of our Python code a few weeks back that just said if

202
00:08:25,562 --> 00:08:30,442
and it mentioned in there name if name equals equals_ma_co.

203
00:08:30,562 --> 00:08:33,082
So we've seen an illusion to name for our purposes.

204
00:08:33,212 --> 00:08:36,602
Name just refers to whatever the name of this file here is,

205
00:08:36,682 --> 00:08:37,832
no matter what I call it,

206
00:08:37,962 --> 00:08:41,893
you can sort of access the current file by way of this special global variable.

207
00:08:42,001 --> 00:08:44,963
So this line collectively just means turn this file.

208
00:08:45,306 --> 00:08:48,955
into a flask application and store the result in a variable

209
00:08:48,955 --> 00:08:51,466
called app so I can now do stuff with flask.

210
00:08:51,596 --> 00:08:52,786
And what am I going to do?

211
00:08:53,036 --> 00:08:53,236
Well,

212
00:08:53,395 --> 00:08:53,986
down here,

213
00:08:54,156 --> 00:08:56,236
let me first point out a familiar syntax.

214
00:08:56,325 --> 00:08:59,056
I'm defining a function that I called index by convention,

215
00:08:59,085 --> 00:09:00,585
but I could have called it anything I want,

216
00:09:00,755 --> 00:09:04,005
whose sole purpose in life is just to return quote unquote hello world,

217
00:09:04,116 --> 00:09:07,265
which is the super simple output this web app is going to display.

218
00:09:07,716 --> 00:09:08,145
But,

219
00:09:08,315 --> 00:09:10,315
and this is the new syntax I'm using

220
00:09:10,315 --> 00:09:13,156
here what's generally called a Python decorator.

221
00:09:13,429 --> 00:09:16,098
Which is a type of function that essentially

222
00:09:16,708 --> 00:09:19,539
affects the behavior of the function right after it.

223
00:09:19,708 --> 00:09:21,648
So by saying at app.

224
00:09:21,958 --> 00:09:23,689
routes,

225
00:09:24,028 --> 00:09:26,059
this is telling the flask framework,

226
00:09:26,189 --> 00:09:28,158
associate this index function

227
00:09:28,429 --> 00:09:29,229
with this route,

228
00:09:29,388 --> 00:09:31,169
the single forward slash,

229
00:09:31,379 --> 00:09:35,198
and that's how we're going to take over the default behavior of the slash

230
00:09:35,708 --> 00:09:40,179
portion of the URL by telling it to return whatever this function returns,

231
00:09:40,229 --> 00:09:41,309
and we'll see this in action.

232
00:09:42,059 --> 00:09:42,590
Now,

233
00:09:42,700 --> 00:09:44,289
so let me go over here,

234
00:09:44,539 --> 00:09:45,969
say to VS code,

235
00:09:45,979 --> 00:09:47,330
and within VS code,

236
00:09:47,419 --> 00:09:52,489
I'm going to whip up exactly that application in a file called app.ie just

237
00:09:52,489 --> 00:09:55,929
so as to combine this and some subsequent examples maybe the same folder.

238
00:09:56,039 --> 00:09:59,010
I'm going to first create a directory or folder called hello.

239
00:09:59,179 --> 00:10:01,409
I'm going to go into that hello folder.

240
00:10:01,659 --> 00:10:04,340
I'm going to go ahead and recreate that same

241
00:10:04,340 --> 00:10:06,760
requirements file just for good measure to Tell the

242
00:10:06,760 --> 00:10:08,919
world that I want to use the flask library

243
00:10:08,919 --> 00:10:12,030
here and then I'm additionally gonna create now A.ie,

244
00:10:12,119 --> 00:10:13,159
and I'll type this fairly quickly,

245
00:10:13,200 --> 00:10:16,510
but I'm just reciting what we saw a moment ago from the flask package,

246
00:10:16,599 --> 00:10:18,239
import the flask function,

247
00:10:18,630 --> 00:10:19,570
lowercase F

248
00:10:19,849 --> 00:10:20,909
F respectively,

249
00:10:21,119 --> 00:10:22,520
then give me a variable called app,

250
00:10:22,599 --> 00:10:26,229
set it equal to that function call passing in the name of this file,

251
00:10:26,359 --> 00:10:27,710
whatever it actually is.

252
00:10:28,000 --> 00:10:28,869
And then lastly,

253
00:10:28,919 --> 00:10:31,109
let's go ahead and call at.

254
00:10:31,270 --> 00:10:31,539
App.

255
00:10:32,140 --> 00:10:35,539
route la which says hey Python,

256
00:10:35,580 --> 00:10:39,619
whatever the next function is associate it with this slash

257
00:10:39,619 --> 00:10:41,729
route and so I'm going to define that function.

258
00:10:41,770 --> 00:10:45,530
I can call it anything I want oo or bar or baz but

259
00:10:45,530 --> 00:10:49,729
insofar as slash represents the index of the website like the default page,

260
00:10:49,820 --> 00:10:51,099
I'm just gonna go ahead and call it by

261
00:10:51,099 --> 00:10:55,869
convention index and then return for now hello world.

262
00:10:56,210 --> 00:10:57,109
And that's it.

263
00:10:57,320 --> 00:11:02,840
So whereas last week when I was writing code in HTML files I was making web pages.

264
00:11:03,080 --> 00:11:05,690
Now I've created what we'll call a web application,

265
00:11:05,719 --> 00:11:07,119
and it's an application in the sense that

266
00:11:07,119 --> 00:11:08,799
there's actually some logic going on there.

267
00:11:08,880 --> 00:11:09,880
There's some functions,

268
00:11:10,000 --> 00:11:11,159
there could be some conditionals,

269
00:11:11,239 --> 00:11:12,280
there's clearly a variable.

270
00:11:12,359 --> 00:11:14,440
There could be loops and all of the sort of

271
00:11:14,440 --> 00:11:17,989
stuff we've seen in Scratch andC and Python as well,

272
00:11:18,239 --> 00:11:19,880
we'll now see back in this Python.

273
00:11:20,036 --> 00:11:20,546
File.

274
00:11:20,966 --> 00:11:22,036
So how do we now run this?

275
00:11:22,156 --> 00:11:22,257
Well,

276
00:11:22,327 --> 00:11:26,106
let me go back into my terminal window here and I'll clear it just for good measure.

277
00:11:26,236 --> 00:11:27,786
I'm going to go ahead and run flask,

278
00:11:27,966 --> 00:11:28,367
run,

279
00:11:28,476 --> 00:11:28,986
enter.

280
00:11:29,236 --> 00:11:31,317
I'm going to see some cryptic looking output,

281
00:11:31,356 --> 00:11:33,117
but there's that familiar pop up with the green

282
00:11:33,117 --> 00:11:35,427
button that wants to open up this application,

283
00:11:35,596 --> 00:11:38,507
whereas HTTP Server uses 8080 by default.

284
00:11:38,677 --> 00:11:41,267
Flask uses Port 5000 by default,

285
00:11:41,396 --> 00:11:42,307
and here we have it.

286
00:11:42,557 --> 00:11:45,754
I've just opened up my Second tab and we spent a lot of time there last week.

287
00:11:45,823 --> 00:11:47,914
This is the server I'm running,

288
00:11:48,033 --> 00:11:48,984
not on Port 8080,

289
00:11:48,994 --> 00:11:50,504
but on Port 5000 today,

290
00:11:50,713 --> 00:11:55,244
and there is the contents of what was spit out by my very first application.

291
00:11:55,473 --> 00:11:59,424
Now even though the browser is rendering this like it is a webpage,

292
00:11:59,434 --> 00:12:01,794
notice this if I inspect,

293
00:12:01,953 --> 00:12:04,383
if I right click or control click anywhere on the screen

294
00:12:04,633 --> 00:12:06,783
and go to View page source,

295
00:12:06,994 --> 00:12:07,424
you'll see.

296
00:12:07,481 --> 00:12:09,341
There's no actual HTML on this page.

297
00:12:09,390 --> 00:12:10,911
It's literally a single line of text,

298
00:12:11,070 --> 00:12:11,281
Hello,

299
00:12:11,630 --> 00:12:12,101
world.

300
00:12:12,270 --> 00:12:15,270
If I close that and right click or control click again and go

301
00:12:15,270 --> 00:12:18,390
to inspect like we did last week to open up developer tools,

302
00:12:18,591 --> 00:12:21,671
you'll see that the browser has actually filled in some blanks here for

303
00:12:21,671 --> 00:12:25,700
me by just rendering as it should the minimal possible web page,

304
00:12:25,710 --> 00:12:30,991
but the content I actually sent to the web browser is only literally hello world.

305
00:12:31,919 --> 00:12:34,570
So how can I actually send a web page of my

306
00:12:34,570 --> 00:12:36,849
own rather than letting the browser do something like this?

307
00:12:36,929 --> 00:12:37,280
Well,

308
00:12:37,450 --> 00:12:38,650
I could go ahead and.

309
00:12:39,299 --> 00:12:41,450
Close that and go back to my application.

310
00:12:41,619 --> 00:12:43,140
I'm gonna go ahead now and hide the

311
00:12:43,140 --> 00:12:45,330
terminal just because the server is still running,

312
00:12:45,409 --> 00:12:47,289
and what I'm gonna go ahead and do here is,

313
00:12:47,380 --> 00:12:47,690
well,

314
00:12:47,900 --> 00:12:51,260
nothing's really stopping me from returning not just a string of texts,

315
00:12:51,340 --> 00:12:52,489
but a string of HTML,

316
00:12:52,500 --> 00:12:53,770
and this might not look pretty,

317
00:12:53,900 --> 00:12:57,330
but let me go ahead and do open bracket doc type,

318
00:12:57,460 --> 00:12:59,059
HTML close bracket,

319
00:12:59,380 --> 00:13:00,419
then HTML,

320
00:13:00,460 --> 00:13:01,130
then head,

321
00:13:01,200 --> 00:13:01,979
then title,

322
00:13:01,989 --> 00:13:05,450
and I'll just title this for instance hello to keep it simple.

323
00:13:05,719 --> 00:13:06,710
backslash title,

324
00:13:06,780 --> 00:13:08,659
backslash head open bracket bod.

325
00:13:09,359 --> 00:13:14,640
hello world backslash backslash HTML close quotes and

326
00:13:14,640 --> 00:13:16,030
I used single quotes in this case,

327
00:13:16,059 --> 00:13:18,059
but I could have just as easily used double quotes,

328
00:13:18,070 --> 00:13:19,400
but that's a full fledged web page.

329
00:13:19,479 --> 00:13:21,669
Like that's the minimal amount of content we saw last week.

330
00:13:21,679 --> 00:13:21,909
Actually,

331
00:13:21,960 --> 00:13:22,469
you know what,

332
00:13:22,640 --> 00:13:23,200
for good measure,

333
00:13:23,260 --> 00:13:25,020
let's actually add lang equals.

334
00:13:25,960 --> 00:13:27,919
So it's actually fortuitous that you use single quotes

335
00:13:27,919 --> 00:13:29,549
because now I have some double quotes inside.

336
00:13:29,679 --> 00:13:31,159
And even though this is not pretty printed,

337
00:13:31,200 --> 00:13:35,190
it's just one massive mouthful of HTML all along one line.

338
00:13:35,380 --> 00:13:37,070
When I now go back to the browser,

339
00:13:37,239 --> 00:13:38,489
reload the page.

340
00:13:38,950 --> 00:13:40,299
As by clicking here

341
00:13:40,549 --> 00:13:42,590
and then view page source again,

342
00:13:42,630 --> 00:13:44,539
here's what my browser received this time.

343
00:13:44,770 --> 00:13:48,270
Indeed it's the full fledged HTML and in fact if

344
00:13:48,270 --> 00:13:51,710
I close that tab and reopen developer tools by inspect,

345
00:13:51,869 --> 00:13:55,349
now we'll see in the tab absolutely everything that I sent over,

346
00:13:55,549 --> 00:13:56,390
including a title,

347
00:13:56,789 --> 00:13:58,140
including the lang equals the N,

348
00:13:58,150 --> 00:13:59,419
and had I typed even more,

349
00:13:59,669 --> 00:14:01,510
we would have seen that too.

350
00:14:02,369 --> 00:14:02,950
All right,

351
00:14:03,280 --> 00:14:05,380
so what was the point of this exercise?

352
00:14:05,469 --> 00:14:06,349
It feels as though

353
00:14:06,559 --> 00:14:08,190
that I've really just taken more time,

354
00:14:08,239 --> 00:14:10,559
added more complexity to achieve literally what I

355
00:14:10,559 --> 00:14:12,390
could have done last week by just creating

356
00:14:12,599 --> 00:14:13,000
Index.

357
00:14:13,200 --> 00:14:16,000
HTML myself without any Python code.

358
00:14:16,119 --> 00:14:18,880
But I dare say what we're trying to do is lay the foundation for

359
00:14:18,880 --> 00:14:21,400
a full-fledged interactive website that maybe has

360
00:14:21,400 --> 00:14:23,390
forms that we can submit to the application

361
00:14:23,549 --> 00:14:25,280
that allows us to generate not just one page,

362
00:14:25,289 --> 00:14:27,530
but maybe 2 or 3 or any number.

363
00:14:27,679 --> 00:14:29,640
So what you're seeing here is sort of the beginning.

364
00:14:29,791 --> 00:14:34,822
Of Google.com's search application or gmail.com itself or

365
00:14:34,822 --> 00:14:37,331
Facebook.com or any web application you can think of

366
00:14:37,742 --> 00:14:43,302
begins with a little code that theoretically looks a little something like this.

367
00:14:43,461 --> 00:14:46,262
But this is kind of stupid to put HTML hard coded

368
00:14:46,262 --> 00:14:49,932
no less in one long string here inside of my application.

369
00:14:50,101 --> 00:14:51,062
Let's try to factor this out.

370
00:14:51,142 --> 00:14:54,182
That was a lesson we preached last week about sort of factoring out our JavaScript,

371
00:14:54,221 --> 00:14:55,471
factoring out our CSS.

372
00:14:55,581 --> 00:14:57,101
We can do the same thing with our actual.

373
00:14:57,213 --> 00:14:59,323
HTML here and so what I'm actually going to

374
00:14:59,323 --> 00:15:03,164
do is import not only the flask function but

375
00:15:03,164 --> 00:15:05,963
also another function that per its documentation comes with

376
00:15:05,963 --> 00:15:09,484
Flask called render template with an underscore in between.

377
00:15:09,643 --> 00:15:12,174
This is a function whose purpose in life is to render a template,

378
00:15:12,323 --> 00:15:12,684
so to speak,

379
00:15:12,713 --> 00:15:13,453
of HTML.

380
00:15:13,723 --> 00:15:15,754
We'll see what we mean by template in just a bit.

381
00:15:15,924 --> 00:15:20,004
But down here what I'm going to do is now delete all of that code and let

382
00:15:20,004 --> 00:15:23,443
me just assume that I'm going to put that same code in a file called index.

383
00:15:23,643 --> 00:15:24,484
HTML just.

384
00:15:24,635 --> 00:15:25,565
I did last week.

385
00:15:25,786 --> 00:15:29,135
So let's instead return the return value of render

386
00:15:29,546 --> 00:15:33,255
template of quote unquote index.html.

387
00:15:33,585 --> 00:15:35,236
Now that file does not yet exist.

388
00:15:35,385 --> 00:15:35,705
Indeed,

389
00:15:35,745 --> 00:15:37,656
if I go into my terminal window,

390
00:15:37,945 --> 00:15:39,745
create a second terminal just so I can leave

391
00:15:39,745 --> 00:15:41,976
the server running but still see what's going on,

392
00:15:42,106 --> 00:15:46,385
I'm going to CD into that same Hello directory type LS to list my files,

393
00:15:46,426 --> 00:15:49,216
and I only see app.ie requirements.text.

394
00:15:49,385 --> 00:15:51,945
But it turns out per flask's documentation.

395
00:15:52,530 --> 00:15:54,919
If you want to create your own HTML files,

396
00:15:55,090 --> 00:15:59,150
you simply have to add a directory that by convention is called templates,

397
00:15:59,250 --> 00:15:59,849
and that's it.

398
00:15:59,929 --> 00:16:01,780
So in addition to app.pi requirements.text,

399
00:16:01,789 --> 00:16:03,099
I need a folder called Templates.

400
00:16:03,169 --> 00:16:04,679
So let's go back into VS code,

401
00:16:04,969 --> 00:16:07,679
maker templates capitalization matters,

402
00:16:07,969 --> 00:16:08,830
all lowercase.

403
00:16:09,130 --> 00:16:13,229
Now let me go ahead and CD into templates and run the code command

404
00:16:13,229 --> 00:16:17,609
and create a file called index.html in the templates folder and then super.

405
00:16:17,744 --> 00:16:18,104
Quickly,

406
00:16:18,375 --> 00:16:19,164
let me hide this.

407
00:16:19,335 --> 00:16:21,164
Let me whip up that same page again.

408
00:16:21,414 --> 00:16:22,664
Doc type HTML,

409
00:16:22,815 --> 00:16:28,585
HTML lang equals EN close bracket head close bracket,

410
00:16:28,815 --> 00:16:30,015
title close bracket,

411
00:16:30,174 --> 00:16:30,604
hello,

412
00:16:30,655 --> 00:16:32,414
and then down here body close bracket,

413
00:16:32,474 --> 00:16:32,784
hello,

414
00:16:32,854 --> 00:16:33,494
comma world.

415
00:16:33,614 --> 00:16:35,525
So autocomplete is helping me type quickly,

416
00:16:35,575 --> 00:16:38,854
but now I have a file with my HTML that

417
00:16:38,854 --> 00:16:42,155
this application I claim is going to spit out automatically

418
00:16:42,494 --> 00:16:43,054
for me.

419
00:16:43,469 --> 00:16:44,460
So let's see the effect.

420
00:16:44,539 --> 00:16:46,549
Let me go back into my other browser tab.

421
00:16:46,619 --> 00:16:50,400
Let me close the developer tools and let me quite simply just click reload.

422
00:16:51,260 --> 00:16:52,880
And no apparent change.

423
00:16:52,969 --> 00:16:54,809
It's working exactly as it did before,

424
00:16:54,890 --> 00:16:57,640
but I've laid the foundation for making a much more

425
00:16:58,119 --> 00:17:02,289
useful layout of my files so that I can actually keep my logic,

426
00:17:02,330 --> 00:17:03,080
my Python code,

427
00:17:03,090 --> 00:17:04,280
and my HTML

428
00:17:04,530 --> 00:17:05,598
a bit separate

429
00:17:05,829 --> 00:17:06,608
from that.

430
00:17:06,930 --> 00:17:07,170
All right,

431
00:17:07,329 --> 00:17:07,489
well,

432
00:17:07,608 --> 00:17:09,969
how can we make this into something even more interesting?

433
00:17:10,050 --> 00:17:10,130
Well,

434
00:17:10,170 --> 00:17:12,560
let's start to take some actual user input,

435
00:17:12,650 --> 00:17:13,400
for instance.

436
00:17:13,530 --> 00:17:19,050
So wouldn't it be nice if I could pass in via the URL something like Q equals cats,

437
00:17:19,130 --> 00:17:20,170
but maybe something like

438
00:17:20,368 --> 00:17:23,089
name equals David or name equals Kelly and

439
00:17:23,089 --> 00:17:25,089
actually see the name that's being outputted.

440
00:17:25,239 --> 00:17:25,689
In other words,

441
00:17:25,770 --> 00:17:29,449
let me zoom in up here and let me pretend like this happened automatically.

442
00:17:29,569 --> 00:17:30,839
Let me do question mark,

443
00:17:31,130 --> 00:17:31,560
uh,

444
00:17:31,569 --> 00:17:32,969
name equals David E.

445
00:17:34,369 --> 00:17:34,410
Well,

446
00:17:34,449 --> 00:17:36,400
it would be nice if I saw hello David.

447
00:17:36,530 --> 00:17:39,250
I'll I'll propose rather than just hello comma world.

448
00:17:39,329 --> 00:17:42,209
So how do I actually get access to everything after the question?

449
00:17:42,579 --> 00:17:42,630
Well,

450
00:17:43,329 --> 00:17:47,229
here is where a framework like Flask and any number of alternatives starts to shine.

451
00:17:47,530 --> 00:17:51,040
It gives me that answer for automatically.

452
00:17:51,130 --> 00:17:52,689
And so it turns out in Flask,

453
00:17:52,770 --> 00:17:53,520
once you've used it,

454
00:17:53,650 --> 00:17:55,689
you have access to a special global variable,

455
00:17:55,770 --> 00:17:58,489
as we'll call it called request.orgs,

456
00:17:58,530 --> 00:18:01,010
where args just means the arguments or the parameters

457
00:18:01,010 --> 00:18:04,199
that were passed in to this HTTP request.

458
00:18:04,449 --> 00:18:05,329
So how do we use this?

459
00:18:05,369 --> 00:18:05,489
Well,

460
00:18:05,609 --> 00:18:07,650
let me go back to VS code here.

461
00:18:08,079 --> 00:18:09,739
And at the very top line,

462
00:18:09,819 --> 00:18:13,939
in addition to importing Flask F render template,

463
00:18:14,140 --> 00:18:15,969
let's also import request,

464
00:18:16,099 --> 00:18:19,369
which is a global variable that comes with the flask framework,

465
00:18:19,579 --> 00:18:20,989
and then I'm gonna use it

466
00:18:21,500 --> 00:18:22,339
as follows.

467
00:18:22,380 --> 00:18:24,050
I'm gonna go ahead and say

468
00:18:24,479 --> 00:18:25,219
um.

469
00:18:26,180 --> 00:18:29,170
A second argument to the render template function where I'm going to

470
00:18:29,170 --> 00:18:33,959
say placeholder equals request actually let me not do that yet.

471
00:18:34,089 --> 00:18:39,119
Let me first create a variable name equals request.args

472
00:18:39,369 --> 00:18:41,880
and then let me go ahead and get the name

473
00:18:42,420 --> 00:18:44,040
key from the arguments.

474
00:18:44,130 --> 00:18:45,189
And then down here,

475
00:18:45,209 --> 00:18:47,040
let's go ahead and pass in

476
00:18:47,400 --> 00:18:49,890
placeholder equals name.

477
00:18:50,219 --> 00:18:52,449
So what am I doing here on line 8?

478
00:18:52,489 --> 00:18:53,900
I'm creating a variable called name.

479
00:18:54,089 --> 00:18:56,849
I'm storing in that the value that's in the request

480
00:18:56,849 --> 00:19:00,689
global variable in what's apparently a dictionary called AGs,

481
00:19:00,969 --> 00:19:02,800
specifically the name key therein.

482
00:19:02,930 --> 00:19:06,050
So if the thing after the question mark name equals is David,

483
00:19:06,290 --> 00:19:07,119
this should give me David.

484
00:19:07,130 --> 00:19:07,650
If it's Kelly,

485
00:19:07,660 --> 00:19:08,939
it should give me Kelly instead.

486
00:19:09,209 --> 00:19:12,000
Then what I'm doing is rendering this template

487
00:19:12,369 --> 00:19:12,930
called index.

488
00:19:13,089 --> 00:19:13,609
HTML,

489
00:19:13,689 --> 00:19:15,959
but I'm additionally passing in some named parameters.

490
00:19:15,969 --> 00:19:16,209
We talked.

491
00:19:16,347 --> 00:19:19,937
Briefly about that in week 6 when we introduced the idea that Python can take

492
00:19:19,937 --> 00:19:24,126
not only a comma separated list of arguments but some of which can have names.

493
00:19:24,217 --> 00:19:26,536
So I'm proposing that one such name of an

494
00:19:26,536 --> 00:19:29,646
argument to this render template function can be placeholder,

495
00:19:29,857 --> 00:19:30,587
for instance.

496
00:19:30,817 --> 00:19:33,886
Now at the moment this code isn't going to do anything useful

497
00:19:34,057 --> 00:19:36,266
if I go back indeed to the other tab,

498
00:19:36,577 --> 00:19:38,276
click reload after zooming in,

499
00:19:38,337 --> 00:19:40,087
even with my name in the URL,

500
00:19:40,217 --> 00:19:42,376
you'll see that we still see hello David.

501
00:19:42,693 --> 00:19:47,994
But here's where things now get interesting and here too is what we mean by template.

502
00:19:48,183 --> 00:19:50,213
If I go back into VS code,

503
00:19:50,583 --> 00:19:51,543
open up index.

504
00:19:51,703 --> 00:19:52,774
HTML again,

505
00:19:52,984 --> 00:19:55,813
and instead of putting the word world there,

506
00:19:56,024 --> 00:19:57,343
what I'd like to see is not hello world,

507
00:19:57,394 --> 00:19:57,994
but hello

508
00:19:58,663 --> 00:19:59,453
placeholder,

509
00:19:59,543 --> 00:20:03,173
but of course if I literally type that I'm gonna see literally placeholder unless

510
00:20:03,463 --> 00:20:08,203
I surround placeholder with pairs of curly braces like this.

511
00:20:08,600 --> 00:20:10,831
By using these pairs of curly braces,

512
00:20:10,951 --> 00:20:14,061
I'm telling Flask that I want to interpolate,

513
00:20:14,151 --> 00:20:14,551
so to speak,

514
00:20:14,571 --> 00:20:15,151
that variable.

515
00:20:15,191 --> 00:20:16,941
I want to substitute in its value.

516
00:20:17,110 --> 00:20:18,870
So this is yet another syntax in Python.

517
00:20:18,880 --> 00:20:20,100
We saw F strings.

518
00:20:20,230 --> 00:20:23,581
In C we saw percent S when using something like print F.

519
00:20:23,911 --> 00:20:27,941
In an HTML file when using flask specifically,

520
00:20:28,191 --> 00:20:32,041
we use these pair of curly braces to denote this

521
00:20:32,041 --> 00:20:34,590
is indeed a placeholder whose value should be plugged in.

522
00:20:35,180 --> 00:20:38,050
So now let's go back over to the second tab,

523
00:20:38,219 --> 00:20:40,770
recall if I zoom in that passed in already

524
00:20:40,770 --> 00:20:43,089
to this URL is question mark name equals David,

525
00:20:43,099 --> 00:20:44,930
and this time when I click reload,

526
00:20:45,140 --> 00:20:45,709
voila,

527
00:20:45,859 --> 00:20:46,689
now I see

528
00:20:47,099 --> 00:20:48,280
my actual name.

529
00:20:48,500 --> 00:20:51,219
And unlike the JavaScript examples last week

530
00:20:51,219 --> 00:20:53,209
which were doing everything client side,

531
00:20:53,400 --> 00:20:54,540
notice here if I.

532
00:20:54,675 --> 00:20:58,535
Go to right click or control click and view page source.

533
00:20:58,744 --> 00:21:03,704
What's noteworthy today is that David in this case literally came from the server.

534
00:21:03,765 --> 00:21:05,285
This was not rendered client side.

535
00:21:05,464 --> 00:21:08,224
The server sent this HTML and specifically

536
00:21:08,545 --> 00:21:09,415
this text.

537
00:21:09,864 --> 00:21:13,295
So if I go back to the same tab here,

538
00:21:13,505 --> 00:21:14,185
zoom in.

539
00:21:14,819 --> 00:21:18,000
And change David for instance to Kelly.

540
00:21:18,329 --> 00:21:21,939
What I should see instead when I hit enter is hello Kelly,

541
00:21:21,949 --> 00:21:24,439
and indeed if I go back to the source code and reload

542
00:21:24,729 --> 00:21:25,760
the page there,

543
00:21:26,050 --> 00:21:27,339
I should see

544
00:21:27,689 --> 00:21:31,880
in the view page source that the server sent indeed hello Kelly.

545
00:21:32,050 --> 00:21:34,040
So it's in this sense that it's an application.

546
00:21:34,119 --> 00:21:38,489
The URL is providing input to the application by way of this URL format,

547
00:21:38,530 --> 00:21:42,339
the so called get the get string that's being passed in.

548
00:21:42,569 --> 00:21:43,369
And if I look at the.

549
00:21:43,630 --> 00:21:46,020
that I'm running app.ie is the code that's running.

550
00:21:46,229 --> 00:21:47,510
It is grabbing

551
00:21:47,869 --> 00:21:48,699
that name

552
00:21:48,910 --> 00:21:49,900
from the URL.

553
00:21:50,109 --> 00:21:52,300
I am then passing it into

554
00:21:52,630 --> 00:21:54,699
my index.html file,

555
00:21:54,869 --> 00:21:59,270
and then my HTML file is plugging the actual value in for me.

556
00:21:59,640 --> 00:22:00,859
And so what's going on with,

557
00:22:00,869 --> 00:22:01,229
for instance,

558
00:22:01,310 --> 00:22:02,469
these curly braces?

559
00:22:02,550 --> 00:22:02,670
Well,

560
00:22:02,790 --> 00:22:06,900
here too is where we're actually using a library and included in Flask

561
00:22:06,900 --> 00:22:11,099
is another library called Jinja and Gina is what's called a templating library,

562
00:22:11,109 --> 00:22:13,189
and there's so many templating libraries in the world.

563
00:22:13,300 --> 00:22:15,310
G Jinja is actually fairly simple,

564
00:22:15,390 --> 00:22:15,859
which is nice,

565
00:22:15,910 --> 00:22:17,300
and which is why Flask uses it.

566
00:22:17,430 --> 00:22:19,349
And for now you can just think of Gina as being the

567
00:22:19,349 --> 00:22:24,310
library that knows how to interpolate variables inside of pairs of curl.

568
00:22:24,469 --> 00:22:25,189
braces.

569
00:22:25,310 --> 00:22:27,349
So why are we introducing it another frame,

570
00:22:27,589 --> 00:22:28,250
another library?

571
00:22:28,310 --> 00:22:28,430
Well,

572
00:22:28,660 --> 00:22:31,150
the folks who implemented Flask decided that it was not

573
00:22:31,150 --> 00:22:34,339
worth their time reinventing the wheel of a templating language,

574
00:22:34,550 --> 00:22:37,459
a language via which you can figure out what values to plug in where.

575
00:22:37,630 --> 00:22:40,619
So they just lean on another library that someone else wrote

576
00:22:40,619 --> 00:22:44,030
years prior so as to not reinvent that wheel themselves,

577
00:22:44,069 --> 00:22:46,219
and that's all that's going on with the framework in this case.

578
00:22:46,229 --> 00:22:49,109
It's using perhaps multiple libraries instead.

579
00:22:49,520 --> 00:22:49,540
All right,

580
00:22:50,869 --> 00:22:51,609
so

581
00:22:52,150 --> 00:22:54,140
what then is a template?

582
00:22:54,310 --> 00:22:56,030
So this then is a template.

583
00:22:56,069 --> 00:22:56,910
What you're looking at here,

584
00:22:57,030 --> 00:22:59,910
hellocom placeholder is a template in the sense that it's kind of

585
00:22:59,910 --> 00:23:02,540
the blueprint for the web page I want the user to see,

586
00:23:02,989 --> 00:23:06,380
but it's going to be dynamically generated using

587
00:23:06,380 --> 00:23:09,109
indeed this blueprint by plugging in the value.

588
00:23:09,219 --> 00:23:13,489
Placeholder inside of those pairs of curly braces.

589
00:23:13,589 --> 00:23:14,609
And so that's why index.

590
00:23:14,770 --> 00:23:18,089
HTML starting today is in a folder called Templates because this is

591
00:23:18,089 --> 00:23:20,800
not just static HTML like the stuff we wrote last week.

592
00:23:21,130 --> 00:23:21,849
This is the

593
00:23:22,030 --> 00:23:26,319
the blueprint for the actual HTML

594
00:23:26,569 --> 00:23:28,770
that we want the browser to spit out.

595
00:23:29,270 --> 00:23:30,479
But there's a bug here.

596
00:23:30,790 --> 00:23:32,099
Notice what's going to happen here.

597
00:23:32,109 --> 00:23:35,270
If I go up to this URL and I get rid of the name altogether.

598
00:23:35,349 --> 00:23:35,670
For instance,

599
00:23:35,680 --> 00:23:39,579
I just visit the slash route without any key value pairs and hit enter.

600
00:23:39,910 --> 00:23:40,670
This is sort of bad,

601
00:23:40,790 --> 00:23:41,859
bad request.

602
00:23:41,949 --> 00:23:43,349
It's an HTTP 400.

603
00:23:43,430 --> 00:23:43,609
In fact,

604
00:23:43,670 --> 00:23:44,599
if you look at the tab,

605
00:23:44,829 --> 00:23:47,900
here's another HTTP status code that we probably haven't seen before,

606
00:23:47,989 --> 00:23:51,229
but 400 just means the user did something wrong by not passing in.

607
00:23:51,530 --> 00:23:52,989
The parameter that was expected.

608
00:23:53,119 --> 00:23:53,189
Well,

609
00:23:53,239 --> 00:23:57,510
that's a little bad design if like the user has to manually type in things to the URLs.

610
00:23:57,520 --> 00:23:58,959
Like no human actually does that.

611
00:23:59,040 --> 00:24:01,709
That's not good for business or customers in general.

612
00:24:02,000 --> 00:24:06,390
So I can go back into app.ie and just make a little bit of conditional code here,

613
00:24:06,400 --> 00:24:10,959
and here's to where we see what makes this an application and not just a static page.

614
00:24:11,314 --> 00:24:14,074
Instead of just blindly getting the name here,

615
00:24:14,194 --> 00:24:15,944
I could instead do something like this.

616
00:24:16,155 --> 00:24:16,275
Well,

617
00:24:16,354 --> 00:24:20,714
if the name parameter is in request.orgs,

618
00:24:20,755 --> 00:24:24,665
and this is just Python syntax for asking if this key is in this dictionary,

619
00:24:24,954 --> 00:24:26,744
then I'm going to go ahead and define name

620
00:24:26,744 --> 00:24:30,395
and set it equal to request.org's quote unquote name.

621
00:24:30,969 --> 00:24:33,199
Else if there is no name in the request,

622
00:24:33,250 --> 00:24:34,770
well then I might as well give some

623
00:24:34,770 --> 00:24:37,359
default value like name equals quote unquote world,

624
00:24:37,569 --> 00:24:40,849
and that alone logically makes sure that I only try

625
00:24:40,849 --> 00:24:45,479
to access request.org's name if the key is actually there.

626
00:24:45,650 --> 00:24:47,079
So if I go back to the browser now,

627
00:24:47,209 --> 00:24:48,369
reload without any.

628
00:24:48,489 --> 00:24:52,349
Thing else in the URL now we're back in business and it's saying hello world,

629
00:24:52,359 --> 00:24:56,680
but if I go up to the URL bar and add name equals David enter

630
00:24:57,040 --> 00:24:57,709
that too

631
00:24:57,930 --> 00:24:58,670
now works.

632
00:24:58,680 --> 00:25:00,640
So it's a web application in the sense that not only

633
00:25:00,640 --> 00:25:03,150
does it have function calls as well as a variable,

634
00:25:03,160 --> 00:25:06,189
but now we've got some conditional logic with Boolean expressions

635
00:25:06,760 --> 00:25:07,770
as well.

636
00:25:08,930 --> 00:25:09,260
All right,

637
00:25:09,410 --> 00:25:12,079
questions on anything we've done thus far,

638
00:25:12,729 --> 00:25:13,599
because it was a lot,

639
00:25:13,810 --> 00:25:14,369
all.

640
00:25:15,250 --> 00:25:16,079
At once,

641
00:25:16,819 --> 00:25:17,689
questions thus far,

642
00:25:17,770 --> 00:25:18,010
yeah.

643
00:25:21,500 --> 00:25:22,050
Good question.

644
00:25:22,089 --> 00:25:22,569
Let's try that.

645
00:25:22,609 --> 00:25:25,290
What if I just did question mark name equals nothing?

646
00:25:25,410 --> 00:25:25,719
Well,

647
00:25:25,849 --> 00:25:27,270
let me go back to that other tab,

648
00:25:27,530 --> 00:25:27,619
uh,

649
00:25:27,729 --> 00:25:29,680
delete the name David and hit enter,

650
00:25:29,930 --> 00:25:30,849
and I indeed see hello,

651
00:25:31,449 --> 00:25:31,770
nothing.

652
00:25:31,930 --> 00:25:32,319
Why?

653
00:25:32,609 --> 00:25:34,760
Because the name key is provided now.

654
00:25:34,800 --> 00:25:36,040
It just doesn't have a value.

655
00:25:36,130 --> 00:25:38,369
And so the conditional has the same answer.

656
00:25:38,410 --> 00:25:38,530
Well,

657
00:25:38,609 --> 00:25:39,010
yes,

658
00:25:39,050 --> 00:25:41,079
name is in request.orgs,

659
00:25:41,089 --> 00:25:41,439
but

660
00:25:41,689 --> 00:25:43,359
there's just no value associated with it.

661
00:25:43,449 --> 00:25:46,810
And here again is the value or a hint at the value of using a framework like Flask.

662
00:25:47,250 --> 00:25:48,324
The The fact that I can just

663
00:25:48,614 --> 00:25:51,895
import the request global variable and then ask questions

664
00:25:51,895 --> 00:25:55,094
like is this parameter in this dictionary means I

665
00:25:55,094 --> 00:25:58,724
don't have to write any of the code that like figures out what the URL looks like,

666
00:25:58,854 --> 00:26:00,994
break it apart between the question mark and

667
00:26:00,994 --> 00:26:02,905
the equal signs and any ampersands therein.

668
00:26:02,974 --> 00:26:07,084
Like that's all sort of generic logic that every web application has to do.

669
00:26:07,295 --> 00:26:07,614
So again,

670
00:26:07,655 --> 00:26:10,535
Flask is sort of doing that lift for me and I

671
00:26:10,535 --> 00:26:13,125
can just focus on focus on the logic that I actually

672
00:26:13,574 --> 00:26:14,175
care about.

673
00:26:14,959 --> 00:26:15,160
All right,

674
00:26:15,239 --> 00:26:15,319
well,

675
00:26:15,359 --> 00:26:16,430
a quick convention here.

676
00:26:16,599 --> 00:26:19,199
It's I've used the word placeholder here just to kind of hit

677
00:26:19,199 --> 00:26:21,469
the nail on the head and make clear this is a placeholder,

678
00:26:21,640 --> 00:26:24,439
but frankly it's a little more readable stylistically

679
00:26:24,439 --> 00:26:26,640
to not just put hello generic placeholder,

680
00:26:26,650 --> 00:26:29,439
but to say something like hello common name so that a colleague or

681
00:26:29,439 --> 00:26:32,119
even myself looking at this file down the line knows that OK,

682
00:26:32,239 --> 00:26:34,189
we're trying to print out the user's name here.

683
00:26:34,589 --> 00:26:35,160
That's fine.

684
00:26:35,189 --> 00:26:37,969
You can change the name of these variables to be anything you want,

685
00:26:38,030 --> 00:26:39,180
and even though it looks weird,

686
00:26:39,270 --> 00:26:43,060
it's conventional in Flask to do something like this name equals name.

687
00:26:43,349 --> 00:26:46,339
But each of these names means something different.

688
00:26:46,630 --> 00:26:50,359
This is the name of the placeholder that I'm going to put in my actual template.

689
00:26:50,574 --> 00:26:52,875
This is the value that I actually want to give it,

690
00:26:52,885 --> 00:26:55,444
and it just keeps me a little saner by just reusing

691
00:26:55,444 --> 00:26:58,805
the same name instead of calling it placeholder or placeholder 1,

692
00:26:58,885 --> 00:26:59,525
placeholder 2,

693
00:26:59,604 --> 00:27:00,285
placeholder 3,

694
00:27:00,295 --> 00:27:01,834
or something generic like that.

695
00:27:02,074 --> 00:27:03,025
Now it's just a little clear,

696
00:27:03,084 --> 00:27:04,234
even though it looks weird

697
00:27:04,484 --> 00:27:06,675
to say name equals name.

698
00:27:07,165 --> 00:27:07,364
Again,

699
00:27:07,484 --> 00:27:09,994
that just allows me to do this in my template.

700
00:27:10,555 --> 00:27:10,685
All right,

701
00:27:10,765 --> 00:27:10,925
well,

702
00:27:11,005 --> 00:27:13,165
what more can I do after that?

703
00:27:13,285 --> 00:27:13,324
Well,

704
00:27:13,405 --> 00:27:14,604
let me propose that

705
00:27:14,885 --> 00:27:16,525
we can actually go in.

706
00:27:16,920 --> 00:27:18,619
And simplify this code a little bit.

707
00:27:18,699 --> 00:27:21,339
It turns out this is so common to just ask a question as

708
00:27:21,339 --> 00:27:24,250
to whether the parameter is there and then do something with it or not

709
00:27:24,420 --> 00:27:26,380
that flask comes with some logic to do this.

710
00:27:26,479 --> 00:27:26,819
And in fact,

711
00:27:26,859 --> 00:27:29,250
I can get rid of all four of these lines,

712
00:27:29,420 --> 00:27:32,849
just go ahead and with confidence declare a variable called name,

713
00:27:33,060 --> 00:27:34,979
set it equal to request.orgs,

714
00:27:35,140 --> 00:27:39,459
but in the so-called dictionary use a function called get that comes with it.

715
00:27:39,645 --> 00:27:44,056
Technically doesn't relate to the verb that was used by HTTP.

716
00:27:44,135 --> 00:27:46,166
This just means literally get me the following.

717
00:27:46,385 --> 00:27:49,005
And if you want to get the parameter called name,

718
00:27:49,215 --> 00:27:51,086
you literally just say quote unquote name.

719
00:27:51,255 --> 00:27:51,806
However,

720
00:27:52,015 --> 00:27:54,456
in case there is no name parameter,

721
00:27:54,536 --> 00:27:57,416
you can also give this function a default value like world.

722
00:27:57,696 --> 00:28:01,365
And so now we've collapsed into 4 lines from 4 lines into 1,

723
00:28:01,615 --> 00:28:02,255
that exact same.

724
00:28:02,452 --> 00:28:02,852
Logic.

725
00:28:03,052 --> 00:28:05,491
So this gets me the HTTP parameter called name,

726
00:28:05,812 --> 00:28:06,881
but if it's not there,

727
00:28:07,011 --> 00:28:10,241
it gives me a default value of world so that no matter what,

728
00:28:10,452 --> 00:28:12,562
this name variable has what I care about.

729
00:28:12,732 --> 00:28:12,982
Indeed,

730
00:28:13,011 --> 00:28:14,241
if I go back over here,

731
00:28:14,491 --> 00:28:17,982
let's type in how about name equals David again E

732
00:28:18,812 --> 00:28:19,281
that's there.

733
00:28:19,371 --> 00:28:24,881
If I type in uh no name enter that too is now working as well.

734
00:28:25,550 --> 00:28:25,819
All right,

735
00:28:26,150 --> 00:28:26,189
well,

736
00:28:26,229 --> 00:28:28,609
let's see if we can refine this a bit more.

737
00:28:28,790 --> 00:28:30,219
Let me propose that

738
00:28:30,670 --> 00:28:32,739
in our next version of this,

739
00:28:32,910 --> 00:28:34,420
let's introduce a second route.

740
00:28:34,589 --> 00:28:35,589
So two URLs,

741
00:28:35,630 --> 00:28:38,180
much like what Google has many different URLs,

742
00:28:38,189 --> 00:28:39,439
as does most any web application.

743
00:28:39,510 --> 00:28:41,699
At the moment I'm doing everything in my slash route.

744
00:28:41,869 --> 00:28:43,829
So how might I move away from this?

745
00:28:43,869 --> 00:28:44,180
Well,

746
00:28:44,430 --> 00:28:46,785
let me go ahead and not only add a Second route,

747
00:28:46,944 --> 00:28:50,295
but in actual form via which the user can type in their name.

748
00:28:50,464 --> 00:28:51,175
So to do this,

749
00:28:51,354 --> 00:28:52,734
let me propose that

750
00:28:53,064 --> 00:28:53,665
in index.

751
00:28:53,844 --> 00:28:54,604
HTML,

752
00:28:55,025 --> 00:28:57,665
instead of just printing out the user's name and trusting that they're

753
00:28:57,665 --> 00:29:00,064
going to have typed their name in manually to the URL,

754
00:29:00,145 --> 00:29:01,655
which again is not normal behavior,

755
00:29:01,785 --> 00:29:05,505
let's actually show the user a form via which they can do exactly that.

756
00:29:05,744 --> 00:29:06,944
So here's my form tag.

757
00:29:07,239 --> 00:29:07,709
Uh,

758
00:29:07,750 --> 00:29:11,319
let's say the method I'm going to use is get so that I see everything in the URL.

759
00:29:11,630 --> 00:29:13,390
Let's give myself an input,

760
00:29:13,670 --> 00:29:14,109
uh,

761
00:29:14,229 --> 00:29:17,699
that whose name is name because this is the human's name,

762
00:29:17,949 --> 00:29:19,500
and notice somewhat confusingly

763
00:29:19,869 --> 00:29:23,579
this name on the left is the HTTP sorry,

764
00:29:23,819 --> 00:29:27,859
this name on the left is the HTML attribute that we saw last week,

765
00:29:27,989 --> 00:29:30,579
so it's different from what we just did in Python,

766
00:29:30,589 --> 00:29:32,380
even though they're all called the same thing.

767
00:29:32,630 --> 00:29:35,160
The type of this input is going to be text.

768
00:29:35,500 --> 00:29:37,890
And let's go ahead and make this a little more user friendly.

769
00:29:37,930 --> 00:29:39,640
Let's put some placeholder text

770
00:29:39,849 --> 00:29:42,760
called name so the human knows what what to type in.

771
00:29:42,930 --> 00:29:45,170
Let's go ahead and disable autocomplete just so we

772
00:29:45,170 --> 00:29:47,640
don't see previous input into this text box,

773
00:29:47,650 --> 00:29:51,479
and let's autofocus it so that the cursor is blinking in the text box

774
00:29:51,849 --> 00:29:52,599
by default.

775
00:29:52,810 --> 00:29:53,449
Then lastly,

776
00:29:53,489 --> 00:29:54,609
let's go ahead and have a button,

777
00:29:54,689 --> 00:29:55,880
the type of which is submit,

778
00:29:55,890 --> 00:29:58,000
so that clicking this button actually submits the form,

779
00:29:58,209 --> 00:30:00,770
and I'm just gonna call this button like greet because I want

780
00:30:00,770 --> 00:30:03,569
the user to be able to greet themselves by clicking this button.

781
00:30:04,229 --> 00:30:04,780
Now

782
00:30:04,949 --> 00:30:06,349
I should specify action.

783
00:30:06,390 --> 00:30:09,709
The only other time we used action is when we actually went to HDPS

784
00:30:09,829 --> 00:30:13,060
www.google.com/search.

785
00:30:13,310 --> 00:30:16,349
That's not relevant today because I'm trying to print hello world,

786
00:30:16,550 --> 00:30:18,060
not search for cats and such,

787
00:30:18,229 --> 00:30:20,020
but this is where I too have control.

788
00:30:20,229 --> 00:30:25,280
If I want to submit this form to a specific location on in my web application,

789
00:30:25,430 --> 00:30:26,869
action is where I can specify it.

790
00:30:26,989 --> 00:30:29,069
So why don't I pretend that they're.

791
00:30:29,209 --> 00:30:32,979
exists a route in my application called slash greet,

792
00:30:33,109 --> 00:30:36,030
and if you go to example.com/greet,

793
00:30:36,650 --> 00:30:38,369
question mark name equals David,

794
00:30:38,589 --> 00:30:40,660
this now will greet the user with hello

795
00:30:41,109 --> 00:30:41,439
David,

796
00:30:41,510 --> 00:30:42,199
for instance.

797
00:30:42,390 --> 00:30:43,699
But slash greet does not exist.

798
00:30:43,829 --> 00:30:45,030
If we go back to app.ie,

799
00:30:45,229 --> 00:30:49,140
literally the only route that currently exists is single slash,

800
00:30:49,349 --> 00:30:50,469
but I can change that.

801
00:30:50,630 --> 00:30:54,150
I can go into my app.ie as I have here.

802
00:30:54,699 --> 00:30:56,050
And below this function

803
00:30:56,260 --> 00:30:59,449
I can go ahead and define app.route quote unquote slash

804
00:30:59,449 --> 00:31:02,449
greet and just invent any route that I want.

805
00:31:02,650 --> 00:31:05,020
I can then define a function that will be called whenever

806
00:31:05,020 --> 00:31:07,739
that route is visited by convention to keep myself sane.

807
00:31:07,750 --> 00:31:10,140
I'm going to call the function the same thing as the route,

808
00:31:10,219 --> 00:31:11,609
but you don't have to do this.

809
00:31:11,780 --> 00:31:14,609
It's just to minimize decisions I have to make.

810
00:31:14,819 --> 00:31:15,910
And then in this function,

811
00:31:15,979 --> 00:31:18,780
what I'm going to do is this return render template.

812
00:31:19,390 --> 00:31:19,800
Greet.

813
00:31:20,119 --> 00:31:20,750
HTML,

814
00:31:20,760 --> 00:31:21,660
which doesn't exist yet,

815
00:31:21,709 --> 00:31:23,099
but there's a problem to be solved,

816
00:31:23,270 --> 00:31:26,660
and then I can pass in the name of the user.

817
00:31:26,829 --> 00:31:28,430
I'm gonna go ahead and save myself a line

818
00:31:28,430 --> 00:31:31,719
of code and just say request.orgs.get name world.

819
00:31:33,869 --> 00:31:34,270
In other words,

820
00:31:34,319 --> 00:31:34,910
strictly speaking,

821
00:31:34,949 --> 00:31:37,020
I don't need that variable on its own line.

822
00:31:37,229 --> 00:31:40,229
This has the effect of what we already did in index,

823
00:31:40,270 --> 00:31:41,660
but I'm doing it all in one

824
00:31:41,869 --> 00:31:43,069
elegant one liner.

825
00:31:43,400 --> 00:31:44,939
And now in index,

826
00:31:45,229 --> 00:31:47,910
insofar as I want the index of the site to just show

827
00:31:47,910 --> 00:31:49,989
the user the form via which they can type in their name,

828
00:31:50,030 --> 00:31:53,510
this one's easy now render template quote unquote index.

829
00:31:53,750 --> 00:31:54,619
HTML

830
00:31:54,979 --> 00:31:56,099
and return

831
00:31:56,390 --> 00:31:57,689
that template.

832
00:31:58,030 --> 00:31:58,709
So to recap,

833
00:31:58,869 --> 00:31:59,400
here's index.

834
00:31:59,599 --> 00:32:00,109
HTML,

835
00:32:00,150 --> 00:32:02,339
which is now a form instead of a template for hello,

836
00:32:02,709 --> 00:32:03,459
such and such.

837
00:32:03,709 --> 00:32:06,510
App.ie is going to return that template whenever I

838
00:32:06,510 --> 00:32:08,780
visit the index or slash of the page,

839
00:32:08,869 --> 00:32:12,829
and then this greet route is going to handle the case of printing out.

840
00:32:13,410 --> 00:32:13,609
Greet.

841
00:32:13,810 --> 00:32:15,640
HTML passing in the user's name.

842
00:32:15,930 --> 00:32:16,010
All right,

843
00:32:16,050 --> 00:32:17,849
I think I'm not quite good to go yet,

844
00:32:17,930 --> 00:32:18,770
but let's try this out.

845
00:32:18,930 --> 00:32:20,800
Let me go back to my browser tab,

846
00:32:20,969 --> 00:32:21,540
reload,

847
00:32:21,719 --> 00:32:22,410
and there we have it.

848
00:32:22,449 --> 00:32:27,180
I have a web form now instead of the uh the hello so and so.

849
00:32:27,270 --> 00:32:29,890
I'm going to go ahead and type in my name and notice the URL at the moment,

850
00:32:29,930 --> 00:32:31,280
even though Chrome is hiding it,

851
00:32:31,449 --> 00:32:33,959
technically it's there slash,

852
00:32:34,089 --> 00:32:37,400
but Chrome and most browsers today sort of hide as much stuff as they

853
00:32:37,609 --> 00:32:39,760
can if it's not all that intellectually interesting,

854
00:32:39,930 --> 00:32:42,099
but watch what happens when I click greet to the URL.

855
00:32:42,739 --> 00:32:47,050
It automatically sends me to slash greet question mark name equals David,

856
00:32:47,089 --> 00:32:49,729
and this is just like the way the forms worked last

857
00:32:49,729 --> 00:32:52,689
week when we recreated our own version of Google in search.

858
00:32:52,890 --> 00:32:56,400
HTML because the action there was google.com/search.

859
00:32:56,569 --> 00:32:58,359
The user was whisked away to Google Server.

860
00:32:58,479 --> 00:33:00,369
Today I stay on the same server because the

861
00:33:00,369 --> 00:33:02,800
action I used was quite simply slash greet,

862
00:33:02,969 --> 00:33:04,760
which is assumed to be on my own server,

863
00:33:05,010 --> 00:33:07,150
but clearly I screwed something up because I have a big

864
00:33:07,385 --> 00:33:10,305
internal server error in front of me as you soon will too.

865
00:33:10,385 --> 00:33:15,984
Odds are as you dive into this 500 is the status code that means your fault somehow.

866
00:33:16,145 --> 00:33:17,094
Now why is that?

867
00:33:17,505 --> 00:33:17,665
Well,

868
00:33:17,775 --> 00:33:20,425
it's unclear from this generic black and white message.

869
00:33:20,505 --> 00:33:20,854
However,

870
00:33:21,305 --> 00:33:22,224
because I'm the developer,

871
00:33:22,305 --> 00:33:23,775
I can go back to VS code,

872
00:33:23,944 --> 00:33:25,295
open my terminal window,

873
00:33:25,334 --> 00:33:27,064
and recall that I have two terminals open now,

874
00:33:27,145 --> 00:33:28,375
one that I can type stuff in,

875
00:33:28,454 --> 00:33:31,545
the other of which is still running from before.

876
00:33:32,069 --> 00:33:33,329
Let me open up that one

877
00:33:33,469 --> 00:33:36,180
and you'll see if I maximize my terminal window,

878
00:33:36,349 --> 00:33:38,819
a whole bunch of scary error messages here,

879
00:33:38,829 --> 00:33:40,660
but the relevant one

880
00:33:40,910 --> 00:33:42,569
is probably going to be,

881
00:33:42,670 --> 00:33:43,459
let's see,

882
00:33:43,750 --> 00:33:44,660
down here,

883
00:33:45,030 --> 00:33:46,709
raise template not found error,

884
00:33:46,829 --> 00:33:48,219
ginja exceptions,

885
00:33:48,670 --> 00:33:49,390
template not found,

886
00:33:49,510 --> 00:33:49,869
greet.

887
00:33:50,109 --> 00:33:50,670
HTML.

888
00:33:50,949 --> 00:33:52,869
So there's a lot of esoteric error messages here,

889
00:33:52,920 --> 00:33:54,020
more so than usual,

890
00:33:54,150 --> 00:33:56,150
but the simple fact is that I just.

891
00:33:56,296 --> 00:33:58,765
Screwed up and I did not create re.

892
00:33:59,156 --> 00:33:59,686
HTML,

893
00:33:59,845 --> 00:34:01,715
so file not found by the server.

894
00:34:01,885 --> 00:34:03,485
So the user doesn't see all that complexity.

895
00:34:03,566 --> 00:34:04,796
That's deliberate by design.

896
00:34:04,965 --> 00:34:07,125
It's generally not good for cybersecurity if you're

897
00:34:07,125 --> 00:34:09,166
revealing to the user all of the error

898
00:34:09,166 --> 00:34:11,206
messages that are happening on your server because

899
00:34:11,206 --> 00:34:13,375
maybe that suggests they can hack in some

900
00:34:13,554 --> 00:34:15,485
some way by taking advantage of those error

901
00:34:15,485 --> 00:34:17,275
messages and the information implicit in them,

902
00:34:17,525 --> 00:34:20,525
but they are there in your terminal window to actually see and die.

903
00:34:20,862 --> 00:34:21,052
No.

904
00:34:21,362 --> 00:34:22,302
So how do I fix this?

905
00:34:22,342 --> 00:34:22,422
Well,

906
00:34:22,581 --> 00:34:23,101
not a problem.

907
00:34:23,181 --> 00:34:24,701
Let me shrink my terminal window back down.

908
00:34:24,981 --> 00:34:26,672
Let me code a file called greet.

909
00:34:26,981 --> 00:34:27,710
HTML.

910
00:34:28,101 --> 00:34:28,592
And in greet.

911
00:34:28,851 --> 00:34:29,342
HTML,

912
00:34:29,382 --> 00:34:31,621
let's create the template via which I'm going to greet the user,

913
00:34:31,672 --> 00:34:33,391
which ironically is the exact same

914
00:34:33,701 --> 00:34:34,501
as index.

915
00:34:34,672 --> 00:34:36,371
HTML used to be.

916
00:34:36,581 --> 00:34:38,251
So let me recreate that real quick.

917
00:34:38,621 --> 00:34:39,871
Doc type HTML.

918
00:34:40,221 --> 00:34:41,351
Let me close my terminal.

919
00:34:41,621 --> 00:34:44,931
HTML lang equals EN head.

920
00:34:45,360 --> 00:34:45,600
Uh,

921
00:34:45,610 --> 00:34:46,389
title,

922
00:34:46,679 --> 00:34:47,469
hello,

923
00:34:48,800 --> 00:34:49,188
hello,

924
00:34:49,280 --> 00:34:49,750
comma,

925
00:34:49,800 --> 00:34:50,668
and there's my,

926
00:34:50,830 --> 00:34:51,250
uh,

927
00:34:51,360 --> 00:34:52,469
here's my placeholder

928
00:34:52,800 --> 00:34:53,790
hellocom name.

929
00:34:54,000 --> 00:34:54,719
So to be clear,

930
00:34:54,840 --> 00:34:55,520
the index.

931
00:34:55,679 --> 00:34:58,919
HTML template doesn't have any curly braces or anything dynamic.

932
00:34:58,939 --> 00:35:01,350
It just spits out the HTML for the form.

933
00:35:01,639 --> 00:35:01,959
Greet.

934
00:35:02,199 --> 00:35:05,270
HTML spits out HTML and the actual greeting,

935
00:35:05,479 --> 00:35:08,879
and it's app.ie that decides which of these to show the user,

936
00:35:08,959 --> 00:35:11,199
either index.html if they visit.

937
00:35:11,465 --> 00:35:13,504
Slash route or greet.

938
00:35:13,784 --> 00:35:17,344
HTML if they somehow find their way to the slash greet route,

939
00:35:17,364 --> 00:35:20,175
which they will automatically by simply submitting

940
00:35:20,584 --> 00:35:21,415
that form.

941
00:35:21,625 --> 00:35:21,745
All right,

942
00:35:21,784 --> 00:35:24,854
so let's go back into this internal server error and go back to the form.

943
00:35:25,145 --> 00:35:26,435
Nothing has changed with the form,

944
00:35:26,504 --> 00:35:27,985
but now when I type in David,

945
00:35:28,024 --> 00:35:28,614
click greet,

946
00:35:28,705 --> 00:35:33,745
not only will the URL change to be slash greet question mark name equals David,

947
00:35:34,064 --> 00:35:35,935
I actually now see the content

948
00:35:36,225 --> 00:35:37,375
that I expected

949
00:35:38,024 --> 00:35:38,665
a moment.

950
00:35:39,060 --> 00:35:39,080
Ago.

951
00:35:40,409 --> 00:35:40,530
All right,

952
00:35:40,649 --> 00:35:40,770
well,

953
00:35:40,810 --> 00:35:42,620
now it's an opportunity to critique.

954
00:35:42,729 --> 00:35:44,449
I have these two templates open index.

955
00:35:44,610 --> 00:35:45,320
HTML

956
00:35:45,570 --> 00:35:45,929
and greet.

957
00:35:46,169 --> 00:35:48,000
HTML and even if you've never

958
00:35:48,219 --> 00:35:52,040
done web programming before and even if you never did HTML before last week,

959
00:35:52,330 --> 00:35:55,449
what is bad about this design intuitively?

960
00:35:56,699 --> 00:35:57,100
Say again?

961
00:35:58,270 --> 00:35:59,560
Abstraction in what sense?

962
00:36:02,379 --> 00:36:02,729
Yes,

963
00:36:02,939 --> 00:36:05,260
so that's exactly the hang up I have here.

964
00:36:05,340 --> 00:36:08,100
There's a lot of duplication and technically I didn't copy paste,

965
00:36:08,159 --> 00:36:12,790
so I might as well have because notice as I very hintingly go back and forth,

966
00:36:13,100 --> 00:36:15,850
almost every line of code in these files is the same

967
00:36:16,139 --> 00:36:17,540
except for the form,

968
00:36:17,600 --> 00:36:18,810
which is there or not there,

969
00:36:19,139 --> 00:36:20,260
or the hello comma,

970
00:36:20,300 --> 00:36:22,179
like all of the boilerplate HTML,

971
00:36:22,260 --> 00:36:24,379
namely everything I just highlighted here.

972
00:36:24,683 --> 00:36:25,883
1 through 7 in greet.

973
00:36:26,083 --> 00:36:27,762
HTML and this

974
00:36:27,962 --> 00:36:30,522
and this is what we really start to mean about a template.

975
00:36:30,532 --> 00:36:33,322
Like wouldn't it be nice if we could factor out

976
00:36:33,322 --> 00:36:35,992
all of that HTML that's common to both files,

977
00:36:36,163 --> 00:36:39,603
put it in literally a template that both routes can

978
00:36:39,603 --> 00:36:43,433
use so that I can write that boilerplate code once

979
00:36:43,752 --> 00:36:44,643
instead of again and again,

980
00:36:44,762 --> 00:36:45,883
because imagine in your mind's eye,

981
00:36:46,083 --> 00:36:46,163
well,

982
00:36:46,202 --> 00:36:46,762
if I have 3 routes.

983
00:36:46,986 --> 00:36:48,025
Or 4 routes or 5 routes.

984
00:36:48,065 --> 00:36:51,256
I'm going to be like typing the same darn HTML 345 times.

985
00:36:51,426 --> 00:36:53,345
That's got to be dumb and that's got to be

986
00:36:53,345 --> 00:36:56,375
solvable as we've seen in other languages as well.

987
00:36:56,625 --> 00:37:00,855
So let me indeed go ahead and try to improve this and the syntax is a little weird,

988
00:37:00,906 --> 00:37:03,416
but it's the kind of thing you get used to quite quickly.

989
00:37:03,625 --> 00:37:06,426
I'm going to go ahead and create a third HTML

990
00:37:06,426 --> 00:37:09,156
file now by going back to my terminal window.

991
00:37:10,050 --> 00:37:12,370
inside still my templates directory and by convention

992
00:37:12,370 --> 00:37:13,899
this file is going to be called layout.

993
00:37:14,050 --> 00:37:14,649
HTML.

994
00:37:14,729 --> 00:37:15,270
Why this?

995
00:37:15,409 --> 00:37:17,560
That's what the flask documentation tells you to do.

996
00:37:17,850 --> 00:37:18,560
So in layout.

997
00:37:18,689 --> 00:37:19,209
HTML,

998
00:37:19,250 --> 00:37:21,729
I can put all of my boilerplate HTML,

999
00:37:21,770 --> 00:37:24,209
the stuff that is invariant and doesn't change.

1000
00:37:24,290 --> 00:37:25,379
So here we go,

1001
00:37:25,449 --> 00:37:27,360
doc type HTML,

1002
00:37:27,610 --> 00:37:27,860
uh,

1003
00:37:27,889 --> 00:37:30,219
HTML tag lang equals EN,

1004
00:37:30,290 --> 00:37:30,959
close bracket,

1005
00:37:31,129 --> 00:37:31,370
uh,

1006
00:37:31,409 --> 00:37:32,719
open bracket head,

1007
00:37:32,969 --> 00:37:34,280
open bracket title,

1008
00:37:34,330 --> 00:37:36,280
we'll call it hello for all of the pages,

1009
00:37:36,290 --> 00:37:37,439
open bracket body,

1010
00:37:37,610 --> 00:37:38,870
and here's where it gets interest.

1011
00:37:39,030 --> 00:37:43,739
The body is the only thing that has been changing in these two examples.

1012
00:37:43,860 --> 00:37:44,659
In Index.

1013
00:37:44,860 --> 00:37:45,550
HTML,

1014
00:37:45,820 --> 00:37:46,889
it was a web form.

1015
00:37:47,179 --> 00:37:47,590
In Greek.

1016
00:37:47,860 --> 00:37:48,340
HTML,

1017
00:37:48,379 --> 00:37:51,129
it was just a simple string of hello so and so.

1018
00:37:51,500 --> 00:37:54,770
So what I want to tell Flask is that everything in the body

1019
00:37:54,770 --> 00:37:58,979
will just be a dynamic block of code and the syntax for that,

1020
00:37:59,020 --> 00:38:00,489
which takes a little bit getting used to,

1021
00:38:00,659 --> 00:38:02,530
but it's also sort of copy pasteable,

1022
00:38:02,899 --> 00:38:07,290
block body using percent signs this time and because

1023
00:38:07,500 --> 00:38:08,340
I don't want any.

1024
00:38:08,790 --> 00:38:10,070
Such body in the template.

1025
00:38:10,149 --> 00:38:12,179
I'm going to literally close this block

1026
00:38:12,429 --> 00:38:13,429
as follows.

1027
00:38:13,550 --> 00:38:17,709
And here you see another example of sort of HTML like syntax,

1028
00:38:17,770 --> 00:38:19,669
but instead of using angled brackets,

1029
00:38:19,899 --> 00:38:20,350
Gina,

1030
00:38:20,860 --> 00:38:22,590
the templating library that Flask uses,

1031
00:38:22,669 --> 00:38:25,419
uses curly brace and percent sign to open the tag,

1032
00:38:25,590 --> 00:38:27,260
and then the opposite to close it.

1033
00:38:27,389 --> 00:38:30,260
So what you really have here are two ginja tags,

1034
00:38:30,270 --> 00:38:31,100
as we'll call them.

1035
00:38:31,310 --> 00:38:32,229
This one is called Block,

1036
00:38:32,270 --> 00:38:33,750
and I'm defining an arbitrary name here.

1037
00:38:33,790 --> 00:38:35,310
I could have called it Foo bar or baz,

1038
00:38:35,350 --> 00:38:37,790
but because I want this block to refer to the.

1039
00:38:37,929 --> 00:38:40,159
Body of the page by convention I'm going to call it body

1040
00:38:40,439 --> 00:38:41,600
and then this weird syntax,

1041
00:38:41,679 --> 00:38:43,459
which is used in some other languages too,

1042
00:38:43,639 --> 00:38:44,709
just means end

1043
00:38:45,040 --> 00:38:47,149
whatever block you just began.

1044
00:38:47,280 --> 00:38:49,600
And so again you just see reasonable people disagreeing.

1045
00:38:49,659 --> 00:38:53,959
The people who invented HTML used nice angled brackets and words like these.

1046
00:38:54,000 --> 00:38:57,560
The people who came up with ginja used curly braces and percent signs.

1047
00:38:57,600 --> 00:38:58,070
Why?

1048
00:38:58,320 --> 00:38:58,399
Well,

1049
00:38:58,479 --> 00:39:02,169
odds are these are not normal symbols that a human would type when writing code,

1050
00:39:03,290 --> 00:39:04,169
at least in HTML,

1051
00:39:04,239 --> 00:39:07,239
so they just chose something that probably wouldn't collide with.

1052
00:39:07,379 --> 00:39:09,399
Actual syntax the human wants to use.

1053
00:39:09,810 --> 00:39:10,810
So that's it for the template.

1054
00:39:10,889 --> 00:39:11,959
This is now a,

1055
00:39:12,570 --> 00:39:14,560
this is essentially a blueprint

1056
00:39:14,729 --> 00:39:18,320
that doesn't have just a placeholder for a single word or value like name.

1057
00:39:18,530 --> 00:39:21,439
I can put a whole chunk of code here now instead.

1058
00:39:21,610 --> 00:39:22,729
And how do I do that?

1059
00:39:22,810 --> 00:39:22,889
Well,

1060
00:39:22,949 --> 00:39:25,489
let me go into index.html with the moment,

1061
00:39:25,530 --> 00:39:29,320
which at the moment is a little duplicative in that it's got all of this boilerplate.

1062
00:39:29,530 --> 00:39:29,870
So you know what?

1063
00:39:29,879 --> 00:39:31,199
I'm going to go ahead and delete

1064
00:39:31,850 --> 00:39:32,199
everything

1065
00:39:32,409 --> 00:39:34,459
that is already in my layout,

1066
00:39:34,689 --> 00:39:36,649
both above and below that web form.

1067
00:39:37,139 --> 00:39:39,919
And now I'm going to use a bit more gina syntax.

1068
00:39:39,969 --> 00:39:42,290
This tube takes a little while to memorize or copy paste,

1069
00:39:42,330 --> 00:39:42,669
but

1070
00:39:42,969 --> 00:39:43,969
if I want index.

1071
00:39:44,129 --> 00:39:44,879
HTML

1072
00:39:45,090 --> 00:39:45,919
to use

1073
00:39:46,250 --> 00:39:47,229
the layout.

1074
00:39:47,370 --> 00:39:48,959
HTML blueprint,

1075
00:39:49,169 --> 00:39:52,239
I can simply say extends layout.

1076
00:39:52,649 --> 00:39:53,570
HTML

1077
00:39:53,929 --> 00:39:57,239
and then close tag using percent sign close bracket here.

1078
00:39:57,530 --> 00:39:58,159
And then

1079
00:39:58,409 --> 00:40:02,520
if what I want to plug into that layout is the following code,

1080
00:40:02,729 --> 00:40:05,760
I can say as before block body.

1081
00:40:06,320 --> 00:40:07,159
And then

1082
00:40:07,479 --> 00:40:08,149
down here,

1083
00:40:08,320 --> 00:40:09,090
I can say.

1084
00:40:10,419 --> 00:40:11,590
End block

1085
00:40:11,979 --> 00:40:12,489
and that's it.

1086
00:40:12,500 --> 00:40:14,219
And just to be a little nitpicky,

1087
00:40:14,260 --> 00:40:17,100
I'm gonna deinent that slightly and now even though it

1088
00:40:17,100 --> 00:40:19,610
looks like web pages suddenly look a lot uglier,

1089
00:40:19,899 --> 00:40:22,080
well they do because like this is weird looking syntax,

1090
00:40:22,159 --> 00:40:24,500
but I have now distilled index.

1091
00:40:24,699 --> 00:40:26,300
HTML into its essence.

1092
00:40:26,340 --> 00:40:28,409
This is the only thing that changes

1093
00:40:28,780 --> 00:40:33,500
vis a vis the greeting page and so I've put my HTML here that I care about.

1094
00:40:33,659 --> 00:40:35,290
I've said to Flask,

1095
00:40:35,419 --> 00:40:36,899
this is what index.

1096
00:40:37,060 --> 00:40:37,540
HTML.

1097
00:40:37,864 --> 00:40:40,574
Body block shall be where to put it,

1098
00:40:40,745 --> 00:40:40,905
well,

1099
00:40:41,024 --> 00:40:43,554
put it into that particular layout.

1100
00:40:43,665 --> 00:40:44,774
HTML file.

1101
00:40:45,024 --> 00:40:46,304
And so the logic for greet.

1102
00:40:46,544 --> 00:40:47,614
HTML is the same thing.

1103
00:40:47,665 --> 00:40:48,774
It's going to look just as weird,

1104
00:40:48,864 --> 00:40:49,145
but again,

1105
00:40:49,185 --> 00:40:50,014
you get used to it.

1106
00:40:50,185 --> 00:40:53,165
Let's go ahead and delete everything that's boilerplate in greet.

1107
00:40:53,385 --> 00:40:53,985
HTML,

1108
00:40:54,054 --> 00:40:55,175
both above and below.

1109
00:40:55,695 --> 00:40:56,334
Up at the top,

1110
00:40:56,425 --> 00:40:58,465
let's tell Flask that greet.

1111
00:40:58,675 --> 00:41:01,375
HTML2 extends layout.

1112
00:41:02,264 --> 00:41:03,064
HTML.

1113
00:41:04,320 --> 00:41:08,070
And let's go ahead and say to Flask that the block

1114
00:41:08,439 --> 00:41:11,750
uh called Body shall be this for greet.

1115
00:41:12,040 --> 00:41:12,929
HTML.

1116
00:41:13,350 --> 00:41:17,850
And the end of this block is now down here and just to be nitpicky,

1117
00:41:17,889 --> 00:41:19,360
I'll deinvent that too.

1118
00:41:19,610 --> 00:41:19,850
So again,

1119
00:41:19,929 --> 00:41:21,340
the pages look a little weirder now,

1120
00:41:21,370 --> 00:41:24,050
but it's going to follow a paradigm that we just see again and again

1121
00:41:24,050 --> 00:41:27,699
such that the only juicy stuff is what's inside of that body block.

1122
00:41:28,090 --> 00:41:29,850
So now if I go back to my layout,

1123
00:41:29,929 --> 00:41:31,330
it looks exactly like this.

1124
00:41:31,449 --> 00:41:33,030
This indeed is a placeholder,

1125
00:41:33,040 --> 00:41:35,449
not just for a single variable like name.

1126
00:41:35,552 --> 00:41:36,982
The placeholder we did before,

1127
00:41:37,183 --> 00:41:40,893
this is the placeholder for a whole block of code that came from a file,

1128
00:41:40,982 --> 00:41:42,093
not from a variable.

1129
00:41:42,262 --> 00:41:44,173
And so if I go back into my

1130
00:41:44,383 --> 00:41:45,532
other tab here,

1131
00:41:45,782 --> 00:41:48,732
go click back to go back to the web form and reload,

1132
00:41:49,022 --> 00:41:51,222
notice that I have the familiar looking form.

1133
00:41:51,343 --> 00:41:53,732
But if I now look at my

1134
00:41:54,062 --> 00:41:56,173
developer or if I look at view page source,

1135
00:41:56,452 --> 00:41:57,623
notice everything that came.

1136
00:41:57,976 --> 00:42:00,226
from the web page from the server.

1137
00:42:00,476 --> 00:42:02,105
Here's that boilerplate up here.

1138
00:42:02,385 --> 00:42:03,825
Here's that boilerplate down here,

1139
00:42:03,875 --> 00:42:06,156
and here's the stuff that's unique to this page.

1140
00:42:06,186 --> 00:42:06,956
And recall too,

1141
00:42:06,996 --> 00:42:08,795
aesthetically I de indented it,

1142
00:42:08,805 --> 00:42:12,055
which is why it's now no longer pretty printed and what the browser sees.

1143
00:42:12,156 --> 00:42:12,795
Like that's OK.

1144
00:42:12,916 --> 00:42:15,875
There's no reason to obsess over the indentation and the

1145
00:42:15,875 --> 00:42:19,936
pretty printing of what the browser sees ultimately the reason I

1146
00:42:20,360 --> 00:42:25,320
Did this indentation is because arguably when I'm in VS code here and I look at index.

1147
00:42:25,479 --> 00:42:26,270
HTML,

1148
00:42:26,600 --> 00:42:29,120
this is clearly indented inside of the body block

1149
00:42:29,120 --> 00:42:31,310
just so I know what's part of that block.

1150
00:42:31,449 --> 00:42:35,790
The browser does not care about superfluous white space or less thereof.

1151
00:42:37,129 --> 00:42:37,709
All right,

1152
00:42:38,739 --> 00:42:39,780
questions

1153
00:42:40,169 --> 00:42:41,439
on what we've just done here,

1154
00:42:41,500 --> 00:42:46,399
which is to truly take this template out for a spin and now remove

1155
00:42:46,729 --> 00:42:49,530
what redundancies I had accidentally introduced.

1156
00:42:51,250 --> 00:42:52,020
Questions

1157
00:42:53,899 --> 00:42:54,449
No,

1158
00:42:54,530 --> 00:42:54,810
OK,

1159
00:42:55,010 --> 00:42:55,370
amazing.

1160
00:42:55,489 --> 00:42:56,000
All right,

1161
00:42:56,129 --> 00:42:56,310
well,

1162
00:42:56,449 --> 00:42:58,760
let's go ahead and look at this URL again.

1163
00:42:58,929 --> 00:43:02,729
I'm not liking the fact that every example we've done thus far involves

1164
00:43:02,729 --> 00:43:05,570
putting my name or Kelly's name right there in the URL bar.

1165
00:43:05,649 --> 00:43:05,729
Well,

1166
00:43:05,810 --> 00:43:06,409
why is that?

1167
00:43:06,570 --> 00:43:06,610
Well,

1168
00:43:06,689 --> 00:43:08,969
if I have like a nosy sibling and they sit down in my browser,

1169
00:43:09,050 --> 00:43:10,729
they're gonna see like every URL I visited,

1170
00:43:10,889 --> 00:43:12,679
including whose name was greeted.

1171
00:43:12,810 --> 00:43:14,159
Now that's not all that big a deal,

1172
00:43:14,209 --> 00:43:16,889
but now imagine it's a username and a password that the form.

1173
00:43:17,030 --> 00:43:19,979
Submitting or a credit card number that the form is submitting or just

1174
00:43:19,979 --> 00:43:22,409
search terms that you don't want the world knowing you're searching for,

1175
00:43:22,540 --> 00:43:24,010
they're going to end up in the URL bar.

1176
00:43:24,060 --> 00:43:27,699
Why if you are using method equals get for the form.

1177
00:43:27,780 --> 00:43:28,679
That's how get works.

1178
00:43:28,739 --> 00:43:32,290
It literally puts all of the HTTP parameters in the URL,

1179
00:43:32,540 --> 00:43:35,939
which is wonderfully useful if it's sort of low stakes

1180
00:43:35,939 --> 00:43:40,060
stuff like the Google search box or if it is.

1181
00:43:40,159 --> 00:43:43,429
Or potentially low stakes stuff like the Google search box or if you

1182
00:43:43,429 --> 00:43:46,659
just want to be able to hyperlink directly to a URL like this.

1183
00:43:46,709 --> 00:43:47,070
In other words,

1184
00:43:47,110 --> 00:43:49,479
if I put this into an anchor tag,

1185
00:43:49,590 --> 00:43:51,060
open bracket A H ref,

1186
00:43:51,189 --> 00:43:52,110
and a URL like this,

1187
00:43:52,149 --> 00:43:55,310
I could deep link a user to a web page that just always says hello,

1188
00:43:55,629 --> 00:43:55,949
David.

1189
00:43:55,989 --> 00:43:58,739
So get strings contain all of the requisite information

1190
00:43:58,949 --> 00:44:00,739
to render a page for the user,

1191
00:44:00,909 --> 00:44:03,110
but this isn't really good for privacy.

1192
00:44:03,419 --> 00:44:05,370
So recall that there's not only gets,

1193
00:44:05,389 --> 00:44:07,010
but there's also something called post,

1194
00:44:07,209 --> 00:44:09,810
and post is just a different HTTP verb

1195
00:44:10,129 --> 00:44:12,330
that essentially with respect to those virtual envelopes

1196
00:44:12,330 --> 00:44:14,929
next last week sort of puts the information more

1197
00:44:14,929 --> 00:44:18,719
deeply inside of the envelopes such that it's not written right there in the URL bar,

1198
00:44:18,810 --> 00:44:20,120
but it's still accessible

1199
00:44:20,449 --> 00:44:21,840
by the server.

1200
00:44:22,330 --> 00:44:23,320
So if I do this,

1201
00:44:23,409 --> 00:44:24,179
watch what happens.

1202
00:44:24,250 --> 00:44:25,489
Let me go back in.

1203
00:44:25,600 --> 00:44:26,699
To VS code,

1204
00:44:26,909 --> 00:44:27,989
let me go back into index.

1205
00:44:28,189 --> 00:44:28,790
HTML,

1206
00:44:28,870 --> 00:44:29,860
which has the form,

1207
00:44:29,899 --> 00:44:34,020
and let me quite simply change the method from get to post.

1208
00:44:34,270 --> 00:44:36,800
And now let me go back to my other browser tab,

1209
00:44:37,270 --> 00:44:41,219
back to the form and reload so that the form knows that the method has changed.

1210
00:44:41,429 --> 00:44:44,939
Now type in David and click greet and before I do that,

1211
00:44:44,949 --> 00:44:46,540
let me zoom in on the URL bar.

1212
00:44:46,909 --> 00:44:47,629
Notice that.

1213
00:44:48,229 --> 00:44:49,729
The URL does change.

1214
00:44:49,899 --> 00:44:51,060
I'm at slash greet,

1215
00:44:51,379 --> 00:44:53,860
but I haven't revealed to the world or to anyone with

1216
00:44:53,860 --> 00:44:57,330
physical access to my browser what URL I just searched for.

1217
00:44:57,580 --> 00:44:59,530
All they know is that I went to slash greet,

1218
00:44:59,540 --> 00:45:02,399
but not the key value pair or pairs that were passed in.

1219
00:45:02,620 --> 00:45:03,929
Of course this clearly hasn't worked.

1220
00:45:04,020 --> 00:45:06,219
I've got an HTTP status code of 405,

1221
00:45:06,300 --> 00:45:06,949
which means method,

1222
00:45:06,979 --> 00:45:07,139
not.

1223
00:45:07,870 --> 00:45:10,000
That's because flask by default,

1224
00:45:10,030 --> 00:45:11,350
when defining routes,

1225
00:45:11,550 --> 00:45:14,939
simply assumes that you want get instead of post.

1226
00:45:15,169 --> 00:45:16,580
Now get is good

1227
00:45:16,870 --> 00:45:18,100
for the default page.

1228
00:45:18,229 --> 00:45:18,510
In fact,

1229
00:45:18,590 --> 00:45:19,620
when I go back here,

1230
00:45:19,790 --> 00:45:23,080
this is equivalent to me visiting the Slash route just in the browser,

1231
00:45:23,149 --> 00:45:26,229
so I want my index to generally support get.

1232
00:45:26,969 --> 00:45:29,540
But the greet route should support post,

1233
00:45:29,739 --> 00:45:33,090
and the simplest way to do this is to pass in another argument to

1234
00:45:33,090 --> 00:45:36,129
the route function which we haven't needed before because the default is get,

1235
00:45:36,300 --> 00:45:38,729
and I can instead tell Flask

1236
00:45:39,020 --> 00:45:43,060
a comma separated list of the HDP methods that I want this route to support.

1237
00:45:43,070 --> 00:45:44,850
So if I wanted to support just post,

1238
00:45:44,979 --> 00:45:45,419
I can pass.

1239
00:45:45,564 --> 00:45:51,385
In a list containing just post and recall Python uses square brackets for lists,

1240
00:45:51,395 --> 00:45:54,014
which are their version of arrays in C.

1241
00:45:54,354 --> 00:45:55,594
Now by default

1242
00:45:55,915 --> 00:45:58,715
this argument is this methods equals get and that's why

1243
00:45:58,715 --> 00:46:01,205
the only thing supported a moment ago was get.

1244
00:46:01,395 --> 00:46:04,324
That's why I'm now changing it to be post instead.

1245
00:46:04,594 --> 00:46:06,195
I have to make one other change though.

1246
00:46:06,274 --> 00:46:07,955
It turns out if you read the documentation.

1247
00:46:08,530 --> 00:46:12,870
When accessing HDP parameters via post instead of get,

1248
00:46:13,169 --> 00:46:17,459
you move from using request.orgs to request.form.

1249
00:46:17,629 --> 00:46:19,540
This is completely unintuitive

1250
00:46:19,790 --> 00:46:22,070
that request.orgs is get and request.

1251
00:46:22,429 --> 00:46:23,469
form is post.

1252
00:46:23,965 --> 00:46:26,064
because they all come from forms,

1253
00:46:26,145 --> 00:46:27,945
so it's bad naming admittedly.

1254
00:46:28,024 --> 00:46:31,935
So you just kind of have to remember request.orgs is used for get requests.

1255
00:46:32,264 --> 00:46:33,455
form is used for post.

1256
00:46:33,625 --> 00:46:38,665
So all I need to do further is change this to be request.form.

1257
00:46:39,520 --> 00:46:40,479
And that's it.

1258
00:46:40,750 --> 00:46:43,610
Now my web application will support web forms

1259
00:46:43,610 --> 00:46:46,159
submitting to it via post instead of get.

1260
00:46:46,350 --> 00:46:47,820
Let me go ahead and type in my name now.

1261
00:46:47,909 --> 00:46:48,550
I'll zoom in.

1262
00:46:48,669 --> 00:46:52,350
Not that the URL will again change to slash greet with no parameters evident,

1263
00:46:52,469 --> 00:46:52,899
but

1264
00:46:53,229 --> 00:46:55,030
I will be greeted this time because the

1265
00:46:55,030 --> 00:46:57,540
server knew to look deeper into that envelope.

1266
00:46:58,120 --> 00:47:00,389
For those key value pairs instead

1267
00:47:00,600 --> 00:47:03,840
and just to be now uh sort of diagnostic about this,

1268
00:47:03,919 --> 00:47:04,989
let me go back once more,

1269
00:47:05,199 --> 00:47:08,949
let me right click or control click on my desktop and go to inspect.

1270
00:47:09,159 --> 00:47:12,750
Here's where developer tools can be super useful as well.

1271
00:47:12,889 --> 00:47:14,080
I'm gonna go in here.

1272
00:47:14,610 --> 00:47:16,520
And I'm going to go ahead and clear this,

1273
00:47:16,750 --> 00:47:19,919
and now I'm going to type in David again and I'm going to click agree.

1274
00:47:20,229 --> 00:47:23,229
But because I have the network tab open like we played with last week,

1275
00:47:23,310 --> 00:47:24,179
it's going to show me

1276
00:47:24,389 --> 00:47:26,780
all of the requests going from my browser to server,

1277
00:47:26,949 --> 00:47:29,510
which is going to be useful here because not only do I see,

1278
00:47:29,590 --> 00:47:29,790
OK,

1279
00:47:29,870 --> 00:47:31,959
it obviously worked because I got back at 200,

1280
00:47:31,979 --> 00:47:34,020
but if I click on this diagnostic output,

1281
00:47:34,149 --> 00:47:35,239
I can actually go to

1282
00:47:35,479 --> 00:47:37,379
The payload tab here

1283
00:47:37,629 --> 00:47:41,340
and I'll see that the form data that was submitted was name,

1284
00:47:41,550 --> 00:47:42,949
the value of which was David.

1285
00:47:43,110 --> 00:47:44,330
So you can see what you're submitting.

1286
00:47:44,350 --> 00:47:45,030
So you can do this today.

1287
00:47:45,110 --> 00:47:47,399
Like if you want to log into some website,

1288
00:47:47,669 --> 00:47:47,979
Gmail,

1289
00:47:47,989 --> 00:47:48,429
or otherwise,

1290
00:47:48,510 --> 00:47:50,030
you can actually see all of the data that

1291
00:47:50,030 --> 00:47:52,300
your own keyboard is submitting to the server,

1292
00:47:52,389 --> 00:47:55,389
even if it's using posts because the browser that you control,

1293
00:47:55,429 --> 00:47:55,939
of course,

1294
00:47:56,110 --> 00:47:56,810
can see

1295
00:47:57,100 --> 00:47:57,830
the same there.

1296
00:47:59,449 --> 00:48:00,280
All right,

1297
00:48:00,889 --> 00:48:03,580
any questions now on this transition from get

1298
00:48:03,969 --> 00:48:05,399
to post?

1299
00:48:07,179 --> 00:48:07,409
Well,

1300
00:48:07,620 --> 00:48:09,739
kind of on a roll or not going so well.

1301
00:48:09,790 --> 00:48:10,139
We'll see.

1302
00:48:10,370 --> 00:48:10,540
All right,

1303
00:48:10,659 --> 00:48:12,449
so what more can we do with this?

1304
00:48:12,620 --> 00:48:12,659
Well,

1305
00:48:12,699 --> 00:48:13,820
let's give ourselves a couple more

1306
00:48:13,820 --> 00:48:15,929
building blocks before we transition to actually

1307
00:48:16,219 --> 00:48:20,530
implementing some real world problems as I did years ago with one such example.

1308
00:48:20,780 --> 00:48:21,679
Suppose that

1309
00:48:21,899 --> 00:48:24,760
I don't like this direction I'm going in insofar as

1310
00:48:24,760 --> 00:48:26,649
every time I have a page with a form,

1311
00:48:26,860 --> 00:48:29,469
it submits to another route altogether because in

1312
00:48:29,469 --> 00:48:31,020
your mind's eye I just kind of extrapolate.

1313
00:48:31,100 --> 00:48:31,139
Well,

1314
00:48:31,219 --> 00:48:32,780
if I have two forms on my page.

1315
00:48:33,114 --> 00:48:34,455
I now need 4 routes.

1316
00:48:34,514 --> 00:48:35,834
If I have 3 forms,

1317
00:48:35,915 --> 00:48:37,274
I need 6 routes.

1318
00:48:37,395 --> 00:48:39,945
It seems a little annoying that you use one route just

1319
00:48:39,945 --> 00:48:43,314
to show the form and another route to process the form.

1320
00:48:43,395 --> 00:48:45,114
This is going to get annoying over time because it's

1321
00:48:45,114 --> 00:48:46,834
like twice as many routes as might be ideal.

1322
00:48:47,114 --> 00:48:48,314
So is there a way to get kind of the

1323
00:48:48,314 --> 00:48:51,274
best of both worlds and combine these two routes into one

1324
00:48:51,514 --> 00:48:55,554
so that everything related to greeting the user all happens in one place?

1325
00:48:55,754 --> 00:48:55,834
Well,

1326
00:48:55,875 --> 00:48:57,274
you can as follows.

1327
00:48:57,284 --> 00:48:58,635
What I'm going to go ahead and do.

1328
00:48:59,159 --> 00:49:03,229
I delete my greet route altogether and most of my index route,

1329
00:49:03,270 --> 00:49:04,580
but I'm going to ask a question.

1330
00:49:04,790 --> 00:49:08,340
I'm going to first say that the methods that the index route support

1331
00:49:08,340 --> 00:49:12,620
now shall be both get and post as a comma separated list there,

1332
00:49:12,790 --> 00:49:16,739
and then inside of my index route I can simply ask a question of the form if

1333
00:49:16,949 --> 00:49:20,429
the request that is submitted to the server has a method.

1334
00:49:21,110 --> 00:49:23,719
Of post then

1335
00:49:24,219 --> 00:49:26,459
assume that form was submitted.

1336
00:49:26,560 --> 00:49:29,810
This is just a Python comment note to self that I'm gonna go back to in a moment.

1337
00:49:30,110 --> 00:49:32,540
Else if the request method is not post,

1338
00:49:32,620 --> 00:49:34,669
so I could technically say if

1339
00:49:34,929 --> 00:49:36,250
if uh if request dome

1340
00:49:37,780 --> 00:49:39,129
equals equals get,

1341
00:49:39,540 --> 00:49:40,090
then,

1342
00:49:40,179 --> 00:49:43,060
but this is kind of dumb because I only support two verbs,

1343
00:49:43,100 --> 00:49:45,620
so I might as well just assume for efficiency.

1344
00:49:46,260 --> 00:49:52,850
Else handles the get implicitly then go ahead and assume that no form was submitted

1345
00:49:53,260 --> 00:49:54,449
so show form.

1346
00:49:54,540 --> 00:49:56,409
So just notes to self as to what I want to do.

1347
00:49:56,659 --> 00:49:57,780
So how do I show the form?

1348
00:49:57,860 --> 00:50:02,469
Well this line was easy return render template of index.

1349
00:50:03,100 --> 00:50:03,969
HTML.

1350
00:50:04,340 --> 00:50:05,860
If though the form was submitted,

1351
00:50:05,899 --> 00:50:06,620
what do I want to do?

1352
00:50:06,689 --> 00:50:06,739
Well,

1353
00:50:06,860 --> 00:50:07,770
just as before,

1354
00:50:07,870 --> 00:50:07,899
let.

1355
00:50:08,304 --> 00:50:11,544
Return render template greet.

1356
00:50:11,895 --> 00:50:15,534
HTML passing in a name value of request.

1357
00:50:16,024 --> 00:50:20,584
form.ge quote unquote name else a default value of world.

1358
00:50:20,705 --> 00:50:23,064
So the exact same logic from each of the two.

1359
00:50:23,780 --> 00:50:24,929
Functions a moment ago,

1360
00:50:25,090 --> 00:50:28,459
but I've now combined them into one by just using some conditional logic

1361
00:50:28,459 --> 00:50:31,649
and just asking the server if the user got here via post.

1362
00:50:31,860 --> 00:50:31,919
Well,

1363
00:50:31,989 --> 00:50:33,659
the only way they could have gotten here via post

1364
00:50:33,659 --> 00:50:36,449
is by having clicked that button and submitted the form.

1365
00:50:36,659 --> 00:50:38,250
So let's just go ahead and greet them,

1366
00:50:38,459 --> 00:50:40,179
else if they got here via get by just

1367
00:50:40,179 --> 00:50:43,489
typing in example.com or whatever the actual URL is,

1368
00:50:43,580 --> 00:50:43,860
let's.

1369
00:50:43,945 --> 00:50:45,324
Go ahead and show them the template.

1370
00:50:45,455 --> 00:50:46,854
So it's still good design in that I have

1371
00:50:46,854 --> 00:50:50,965
a separate template for each of these pieces of functionality

1372
00:50:51,175 --> 00:50:53,084
that is only minimally different,

1373
00:50:53,455 --> 00:50:58,264
but I'm sort of deciding which of those to show based on the actual logic

1374
00:50:58,534 --> 00:50:59,725
in this here app.

1375
00:51:00,084 --> 00:51:00,215
All right,

1376
00:51:00,254 --> 00:51:02,004
so this is almost perfect

1377
00:51:02,254 --> 00:51:03,205
except for one

1378
00:51:03,574 --> 00:51:04,254
bug.

1379
00:51:04,909 --> 00:51:06,620
What else needs to change

1380
00:51:06,870 --> 00:51:10,159
if I've just combined my greet route and

1381
00:51:10,469 --> 00:51:11,510
this default

1382
00:51:11,949 --> 00:51:12,739
slash

1383
00:51:12,949 --> 00:51:14,260
route as well?

1384
00:51:15,219 --> 00:51:15,600
Yeah

1385
00:51:17,489 --> 00:51:17,840
Yeah,

1386
00:51:17,959 --> 00:51:19,760
so in the form that has index.

1387
00:51:19,939 --> 00:51:20,510
HTML,

1388
00:51:20,760 --> 00:51:23,080
recall that there's an action line that specifies like

1389
00:51:23,080 --> 00:51:25,149
to what URL do you want to submit this.

1390
00:51:25,159 --> 00:51:25,419
Well,

1391
00:51:25,560 --> 00:51:27,399
let me go back to index.html.

1392
00:51:27,600 --> 00:51:29,719
It can't be slash greet anymore because that doesn't exist,

1393
00:51:29,800 --> 00:51:33,320
so I'm just going to delete the word greet and submit it to slash instead.

1394
00:51:33,629 --> 00:51:35,949
Which will have the effect of also just omitting

1395
00:51:35,949 --> 00:51:37,590
it entirely if you don't specify an action,

1396
00:51:37,629 --> 00:51:40,020
it submits to the very location that it came from,

1397
00:51:40,189 --> 00:51:42,540
but if you want to be pedantic and even more clear,

1398
00:51:42,729 --> 00:51:46,340
just specifying that the action now of this form is just this,

1399
00:51:46,590 --> 00:51:49,219
then that will work here too.

1400
00:51:49,919 --> 00:51:50,080
All right,

1401
00:51:50,159 --> 00:51:50,770
so let's test it.

1402
00:51:50,879 --> 00:51:51,969
Let's go back to the other tab,

1403
00:51:52,159 --> 00:51:53,110
back to the form,

1404
00:51:53,280 --> 00:51:53,989
reload.

1405
00:51:54,120 --> 00:51:54,879
It's blank now.

1406
00:51:55,060 --> 00:51:55,760
Type in David,

1407
00:51:55,919 --> 00:51:56,790
click greet,

1408
00:51:57,000 --> 00:51:58,030
and this too is working.

1409
00:51:58,120 --> 00:51:58,399
But again,

1410
00:51:58,479 --> 00:52:00,189
if I go back and reload,

1411
00:52:00,479 --> 00:52:01,570
get is working as well.

1412
00:52:01,719 --> 00:52:04,280
But there's nothing ending up in the URL because I'm now using posts,

1413
00:52:04,320 --> 00:52:06,110
which again tends to be a good thing

1414
00:52:06,360 --> 00:52:08,790
for privacy reasons as well.

1415
00:52:08,959 --> 00:52:11,000
Let me show one final flourish before we transition.

1416
00:52:11,095 --> 00:52:12,885
Something real world motivated.

1417
00:52:13,006 --> 00:52:14,456
If I go into

1418
00:52:14,766 --> 00:52:16,605
app.ie for a while now,

1419
00:52:16,645 --> 00:52:18,766
I've been passing in this default value of world,

1420
00:52:18,926 --> 00:52:19,516
which is fine,

1421
00:52:19,686 --> 00:52:22,355
especially if it's something short and sweet that's the default value,

1422
00:52:22,525 --> 00:52:26,315
but I can actually put a bit of conditional logic in my template as well.

1423
00:52:26,525 --> 00:52:26,926
So in fact,

1424
00:52:27,045 --> 00:52:28,006
let me go into greet.

1425
00:52:28,246 --> 00:52:29,075
HTML

1426
00:52:29,325 --> 00:52:32,406
and trust that I will now be passed in a name variant.

1427
00:52:32,892 --> 00:52:35,852
but I can decide for myself in the template whether

1428
00:52:35,852 --> 00:52:39,172
I want to say hello name or if it's blank hello

1429
00:52:39,451 --> 00:52:40,402
world instead.

1430
00:52:40,572 --> 00:52:41,521
And how might I do this?

1431
00:52:41,572 --> 00:52:41,632
Well,

1432
00:52:41,731 --> 00:52:43,162
I can always say hello,

1433
00:52:43,412 --> 00:52:46,441
but then I'm going to use some ginja syntax that we haven't seen yet.

1434
00:52:46,572 --> 00:52:47,781
But it turns out in Jinja,

1435
00:52:47,812 --> 00:52:49,771
the temping language that Flask uses,

1436
00:52:49,802 --> 00:52:51,681
you can use Python-like syntax too,

1437
00:52:51,691 --> 00:52:53,021
and you can ask questions like,

1438
00:52:53,052 --> 00:52:53,291
well,

1439
00:52:53,332 --> 00:52:53,842
if

1440
00:52:54,281 --> 00:52:56,402
uh the name variable has a value,

1441
00:52:56,572 --> 00:52:58,271
well then go ahead and output

1442
00:52:58,441 --> 00:52:59,491
the value of that name.

1443
00:53:00,000 --> 00:53:02,679
Else if the name variable does not have a value,

1444
00:53:02,800 --> 00:53:05,110
go ahead and output a literal value like world

1445
00:53:05,560 --> 00:53:07,550
and then down here and if.

1446
00:53:07,679 --> 00:53:10,699
So ginja again is a little weird and then it says end block and if,

1447
00:53:10,719 --> 00:53:11,750
but that's the way it is.

1448
00:53:12,000 --> 00:53:13,310
But even though this looks a little weird,

1449
00:53:13,550 --> 00:53:15,000
it's just a nice clever way of.

1450
00:53:15,129 --> 00:53:18,729
A bit of logic into my template and if the name

1451
00:53:19,040 --> 00:53:19,719
has a value,

1452
00:53:19,760 --> 00:53:21,270
so it's not empty or none,

1453
00:53:21,399 --> 00:53:22,469
go ahead and display it.

1454
00:53:22,639 --> 00:53:25,550
Hence the curly braces else go ahead and literally say world.

1455
00:53:25,760 --> 00:53:27,360
Why is it not problematic and you can see

1456
00:53:27,360 --> 00:53:30,310
the dots here that there's all of this white space

1457
00:53:30,969 --> 00:53:31,909
after the word hello,

1458
00:53:31,919 --> 00:53:32,520
comma.

1459
00:53:34,780 --> 00:53:37,500
Like otherwise this would seem to create quite a messy

1460
00:53:37,870 --> 00:53:40,459
paragraph or phrase of text in terms of whitespace,

1461
00:53:40,500 --> 00:53:40,979
but.

1462
00:53:42,820 --> 00:53:45,580
HTML ignores superfluous white space,

1463
00:53:45,620 --> 00:53:47,500
so anything more than a single space just

1464
00:53:47,500 --> 00:53:50,489
gets canonicalized or collapsed into a single space.

1465
00:53:50,540 --> 00:53:53,000
And we saw that recall last week accidentally

1466
00:53:53,000 --> 00:53:55,419
when I had those three paragraphs of text from

1467
00:53:55,939 --> 00:53:57,449
from the duck,

1468
00:53:57,659 --> 00:53:58,219
but I

1469
00:53:58,620 --> 00:54:01,780
wanted them deliberately to be separate paragraphs and they weren't because

1470
00:54:01,780 --> 00:54:04,060
all of that white space was ignored until I actually.

1471
00:54:04,165 --> 00:54:08,024
Introduced the paragraph tag instead.

1472
00:54:08,274 --> 00:54:11,354
So this just moves some of that logic now to the templates.

1473
00:54:11,475 --> 00:54:13,034
So for all this logic and more,

1474
00:54:13,114 --> 00:54:15,794
here's the official documentation for Flask

1475
00:54:15,794 --> 00:54:18,544
and specifically Jinja's own documentation,

1476
00:54:18,754 --> 00:54:20,544
but for the most part we've seen what's

1477
00:54:20,834 --> 00:54:22,385
possible already,

1478
00:54:22,514 --> 00:54:23,824
and I promised a real world example.

1479
00:54:23,995 --> 00:54:25,165
So here now it is.

1480
00:54:25,235 --> 00:54:25,475
So.

1481
00:54:26,010 --> 00:54:26,209
Um,

1482
00:54:26,250 --> 00:54:28,060
back when I took CS 50

1483
00:54:28,370 --> 00:54:29,879
as a sophomore,

1484
00:54:30,090 --> 00:54:31,489
there was no web programming in the class,

1485
00:54:31,500 --> 00:54:35,050
and frankly there was barely any web actually in the world because it was all so new,

1486
00:54:35,129 --> 00:54:36,360
HTML and the like.

1487
00:54:36,649 --> 00:54:41,770
But it was my sophomore spring maybe or junior fall that I also

1488
00:54:41,770 --> 00:54:45,239
got involved in the freshman intramural sports program or Frosh IMS for short,

1489
00:54:45,370 --> 00:54:47,570
and back in the day we would walk from

1490
00:54:47,570 --> 00:54:51,360
say Matthew's Hall to Wigglesworth freshman year at least,

1491
00:54:51,729 --> 00:54:54,250
to register for sports by filling out what was called the sheet.

1492
00:54:54,416 --> 00:54:57,517
Paper and then you would go to the Proctor's dorm room and slide it like

1493
00:54:57,517 --> 00:55:00,806
under their door or through the mail slot and that's how we registered for sports.

1494
00:55:00,846 --> 00:55:03,316
It was sort of ripe for disruption before that was even a phrase.

1495
00:55:03,487 --> 00:55:07,697
And so one of the very first projects I took on myself personally after taking CS 50

1496
00:55:07,697 --> 00:55:09,636
was to figure out how web programming worked

1497
00:55:09,636 --> 00:55:12,757
and Python wasn't really wasn't a thing yet,

1498
00:55:13,166 --> 00:55:15,876
nor was half of the topics we've been talking about thus far.

1499
00:55:15,886 --> 00:55:18,677
But at the time I learned a programming language called Perl.

1500
00:55:18,767 --> 00:55:21,207
I learned a little something about CSV files,

1501
00:55:21,247 --> 00:55:22,806
which we did a couple of weeks back too.

1502
00:55:22,934 --> 00:55:26,803
And I built this the Freshman intramural sports website via which you

1503
00:55:26,803 --> 00:55:28,563
could click on a bunch of links and get some information,

1504
00:55:28,604 --> 00:55:29,513
but most importantly,

1505
00:55:29,724 --> 00:55:32,434
you could register for sports as by typing in your name,

1506
00:55:32,724 --> 00:55:34,444
selecting the sport for which you want to register,

1507
00:55:34,523 --> 00:55:35,273
click submit,

1508
00:55:35,323 --> 00:55:37,523
and no longer walk across Harvard Yard with a

1509
00:55:37,523 --> 00:55:39,684
piece of paper to actually register for sports.

1510
00:55:39,803 --> 00:55:43,874
So we thought we'd use this as sort of the beginning of a motivation for how

1511
00:55:43,874 --> 00:55:46,724
we can now solve problems using web-based interfaces

1512
00:55:46,724 --> 00:55:48,914
using code and also what not to do,

1513
00:55:49,043 --> 00:55:51,323
like background images that repeat like this are not really.

1514
00:55:51,450 --> 00:55:52,430
In fashion anymore,

1515
00:55:52,561 --> 00:55:54,190
nor arguably in 1997,

1516
00:55:54,510 --> 00:55:56,200
but let's leave that as a cliffhanger and come back in

1517
00:55:56,200 --> 00:55:59,950
10 minutes after a snack with reimplementing the Frosh IM's website.

1518
00:56:00,371 --> 00:56:00,831
All right,

1519
00:56:01,000 --> 00:56:01,670
we are back.

1520
00:56:01,841 --> 00:56:07,200
So among the goals now are to recreate the beginnings of a site like

1521
00:56:07,200 --> 00:56:11,121
this for Frosh IMs whereby we want to enable students to visit a form,

1522
00:56:11,281 --> 00:56:12,081
fill out that form,

1523
00:56:12,121 --> 00:56:13,351
and submit it to a server,

1524
00:56:13,361 --> 00:56:14,190
and then register,

1525
00:56:14,200 --> 00:56:16,740
and we'll dispense with all of the

1526
00:56:16,920 --> 00:56:17,920
amazing graphics and such,

1527
00:56:17,930 --> 00:56:19,801
and keep it fairly simplistic and.

1528
00:56:19,978 --> 00:56:20,958
Core HTML.

1529
00:56:21,117 --> 00:56:22,238
So let's go ahead and do this.

1530
00:56:22,308 --> 00:56:23,518
Back here in BS code,

1531
00:56:23,758 --> 00:56:26,877
I've gotten ready now for this next set of examples and in particular

1532
00:56:26,877 --> 00:56:31,367
I've created in advance a directory called Frosh IMs inside of which are

1533
00:56:31,637 --> 00:56:32,278
App.ie,

1534
00:56:32,558 --> 00:56:33,387
requirements.text,

1535
00:56:33,397 --> 00:56:33,978
and templates,

1536
00:56:33,998 --> 00:56:36,508
which are essentially the same as the ones we just created,

1537
00:56:36,587 --> 00:56:39,427
but I stripped out the hello and greeting specific stuff.

1538
00:56:39,597 --> 00:56:41,758
I'm going to go ahead in this terminal and do flask runs,

1539
00:56:41,798 --> 00:56:44,687
so I get the server up and running again on port 5000,

1540
00:56:44,708 --> 00:56:48,397
and then I'm going to go ahead and open up another terminal here as I did before.

1541
00:56:48,675 --> 00:56:52,034
CD and Frosh IMs in that terminal where I'll see the exact same files

1542
00:56:52,034 --> 00:56:54,745
and I'll give you a quick tour of what I created in advance.

1543
00:56:54,955 --> 00:56:56,574
So here in A.ie

1544
00:56:56,955 --> 00:57:00,915
is quite simply the simplest of applications that just renders the index.

1545
00:57:01,094 --> 00:57:02,104
HTML template

1546
00:57:02,354 --> 00:57:04,034
with an expectation in a moment that we're

1547
00:57:04,034 --> 00:57:05,625
going to make it more interesting than that.

1548
00:57:05,955 --> 00:57:06,274
Meanwhile,

1549
00:57:06,354 --> 00:57:06,935
if I open my,

1550
00:57:07,395 --> 00:57:10,044
my terminal again and open up Requirements.txt,

1551
00:57:10,274 --> 00:57:11,274
it just mentions flask,

1552
00:57:11,314 --> 00:57:12,235
but it's already installed,

1553
00:57:12,314 --> 00:57:14,625
so no more to say about that for now.

1554
00:57:14,875 --> 00:57:16,875
Now let me go ahead lastly and open up template.

1555
00:57:17,001 --> 00:57:18,481
It's the templates folder,

1556
00:57:18,511 --> 00:57:19,501
two files they're in,

1557
00:57:19,592 --> 00:57:20,822
the first of which is layout.

1558
00:57:20,951 --> 00:57:21,552
HTML,

1559
00:57:21,951 --> 00:57:25,191
which looks almost the same except I did add a slightly

1560
00:57:25,191 --> 00:57:28,162
more user friendly tag to the head of the page,

1561
00:57:28,191 --> 00:57:29,541
which you might not have seen before,

1562
00:57:29,632 --> 00:57:33,062
but this is a tag that essentially you can copy and paste into templates of your own

1563
00:57:33,312 --> 00:57:37,312
that help the content of a page resize to be mobile friendly.

1564
00:57:37,352 --> 00:57:37,592
In fact,

1565
00:57:37,672 --> 00:57:38,501
without this line,

1566
00:57:38,672 --> 00:57:39,741
if you were to develop

1567
00:57:40,152 --> 00:57:42,261
Problems at 9 or your final project for the web

1568
00:57:42,261 --> 00:57:44,021
and then try to access the site on a phone,

1569
00:57:44,271 --> 00:57:45,431
everything might look quite a bit.

1570
00:57:45,519 --> 00:57:47,178
Small font sizes and more.

1571
00:57:47,428 --> 00:57:51,148
This line tends to help the browsers resize dynamically so that

1572
00:57:51,148 --> 00:57:53,989
it actually matches the width of the device's own with,

1573
00:57:54,069 --> 00:57:54,418
for instance,

1574
00:57:54,428 --> 00:57:56,509
a phone versus a laptop or desktop.

1575
00:57:56,549 --> 00:57:58,388
But otherwise everything else is the same there,

1576
00:57:58,668 --> 00:58:03,999
including the placeholder for the body block that I've find here on line 9.

1577
00:58:04,269 --> 00:58:04,589
Lastly,

1578
00:58:04,628 --> 00:58:05,868
there's one more file that at the

1579
00:58:05,868 --> 00:58:08,579
moment doesn't do anything all that interesting except

1580
00:58:08,948 --> 00:58:13,908
is ready to contain the contents of the registration form for Frosh.

1581
00:58:14,035 --> 00:58:14,466
I am.

1582
00:58:14,666 --> 00:58:14,895
So

1583
00:58:15,025 --> 00:58:16,785
let's go ahead and start with actually that.

1584
00:58:16,865 --> 00:58:18,696
Let me quickly whip up a form

1585
00:58:18,986 --> 00:58:21,625
that minimally gives the user something that they can

1586
00:58:21,625 --> 00:58:23,706
submit to the server to register for sports,

1587
00:58:23,716 --> 00:58:25,805
and then we'll improve upon it a bit iteratively.

1588
00:58:25,986 --> 00:58:29,216
So here inside of the body of index.

1589
00:58:29,385 --> 00:58:29,865
HTML,

1590
00:58:29,906 --> 00:58:31,946
which is going to extend the actual layout,

1591
00:58:31,956 --> 00:58:33,375
the blueprint we already created,

1592
00:58:33,506 --> 00:58:36,385
I'm gonna have a quick title for the page like register just to

1593
00:58:36,385 --> 00:58:38,775
make clear to the student what they need to do using the H1,

1594
00:58:38,785 --> 00:58:40,135
which is the big and bold tag.

1595
00:58:40,345 --> 00:58:42,426
Then I'm gonna go ahead and have a form tag.

1596
00:58:42,850 --> 00:58:43,129
Uh,

1597
00:58:43,209 --> 00:58:45,639
whose action is going to be

1598
00:58:45,959 --> 00:58:46,719
anything I want,

1599
00:58:46,889 --> 00:58:48,840
but since I want the user to register,

1600
00:58:48,969 --> 00:58:51,139
I'm gonna have it go to slash register,

1601
00:58:51,290 --> 00:58:53,449
which makes more sense romantically than greet

1602
00:58:53,449 --> 00:58:55,000
now because we're doing something else.

1603
00:58:55,250 --> 00:58:57,530
The method I'm gonna have the student use is post,

1604
00:58:57,570 --> 00:58:59,570
if only because they don't want their roommates

1605
00:58:59,570 --> 00:59:01,050
knowing what they visited in their browser,

1606
00:59:01,090 --> 00:59:03,770
so this way it will tuck the HTP parameters deeper in

1607
00:59:03,770 --> 00:59:06,879
that virtual envelope so it's not stored in the browser's history.

1608
00:59:07,360 --> 00:59:08,209
Inside of this form.

1609
00:59:08,600 --> 00:59:12,260
I'm going to have minimally an input box for the student's name,

1610
00:59:12,350 --> 00:59:13,830
so I'll call that aptly

1611
00:59:14,110 --> 00:59:16,550
name and set name equal to name in my HTML.

1612
00:59:16,750 --> 00:59:19,459
The type of this text box will be exactly that text.

1613
00:59:19,629 --> 00:59:21,350
And then just to make it a little more user friendly,

1614
00:59:21,389 --> 00:59:24,300
I'm going to add a placeholder of names so they know what to do.

1615
00:59:24,469 --> 00:59:27,510
I'm going to go ahead and turn off autocomplete in case

1616
00:59:27,510 --> 00:59:30,060
multiple roommates want to sign in from the same computer,

1617
00:59:30,179 --> 00:59:31,500
register from the same computer,

1618
00:59:31,750 --> 00:59:35,219
and then we'll turn on Autofocus to put the cursor in that name box.

1619
00:59:35,469 --> 00:59:35,939
And then,

1620
00:59:35,949 --> 00:59:37,110
and you didn't see this last week.

1621
00:59:37,221 --> 00:59:40,652
But if you've ever wondered how drop down menus are implemented in HTML,

1622
00:59:40,662 --> 00:59:41,731
if you've never done this yourself,

1623
00:59:41,852 --> 00:59:44,681
those drop down menus on web pages are called select menus.

1624
00:59:44,991 --> 00:59:47,612
And if I want the user to select a sport to register for,

1625
00:59:47,691 --> 00:59:49,402
I'm going to call this input

1626
00:59:49,691 --> 00:59:50,521
a

1627
00:59:51,332 --> 00:59:52,041
sports,

1628
00:59:52,261 --> 00:59:55,291
and this is an alternative to just having a generic text box where

1629
00:59:55,291 --> 00:59:57,842
we have the students type in the sport they want to register for,

1630
00:59:58,011 --> 01:00:01,642
which would be fraught with typographical errors and changes in capitalization.

1631
01:00:01,812 --> 01:00:02,652
A drop down menu,

1632
01:00:02,662 --> 01:00:02,892
of course,

1633
01:00:03,052 --> 01:00:04,842
standardizes what the human can select.

1634
01:00:05,092 --> 01:00:05,781
So inside.

1635
01:00:05,843 --> 01:00:06,743
This drop down,

1636
01:00:06,793 --> 01:00:08,033
I'm going to have a few options.

1637
01:00:08,343 --> 01:00:09,404
The first of which

1638
01:00:10,033 --> 01:00:11,194
will be,

1639
01:00:11,204 --> 01:00:11,694
uh,

1640
01:00:11,704 --> 01:00:12,454
basketball,

1641
01:00:12,553 --> 01:00:13,224
for instance,

1642
01:00:13,303 --> 01:00:15,783
the second of which will be soccer,

1643
01:00:15,993 --> 01:00:16,833
and the third of which,

1644
01:00:16,914 --> 01:00:19,704
which I think was the 1st 3 with which we debuted back in the day,

1645
01:00:19,954 --> 01:00:21,704
was ultimate frisbee.

1646
01:00:21,874 --> 01:00:25,704
Now these option tags can take some attributes by default.

1647
01:00:25,914 --> 01:00:27,874
They will take on the value of whatever words

1648
01:00:27,874 --> 01:00:29,993
are typed in between the open and closed tags.

1649
01:00:30,073 --> 01:00:31,343
But just to be pedantic,

1650
01:00:31,414 --> 01:00:34,313
I'm going to make clear that the value of selecting this.

1651
01:00:34,706 --> 01:00:35,385
shall be

1652
01:00:35,696 --> 01:00:36,365
basketball,

1653
01:00:36,575 --> 01:00:38,926
but I could change it to be something else if I so chose.

1654
01:00:39,135 --> 01:00:41,246
The value of this selection will be

1655
01:00:41,575 --> 01:00:42,236
soccer,

1656
01:00:42,416 --> 01:00:44,385
and the value of this last option

1657
01:00:44,736 --> 01:00:47,456
will be ultimate frisbee just in case I want

1658
01:00:47,456 --> 01:00:49,926
to store something else in my database ultimately.

1659
01:00:50,335 --> 01:00:52,256
Now that is a complete index.

1660
01:00:52,416 --> 01:00:52,936
HTML,

1661
01:00:52,976 --> 01:00:53,295
I think.

1662
01:00:53,375 --> 01:00:55,006
So if I go back to

1663
01:00:55,496 --> 01:00:56,365
my browser tab,

1664
01:00:56,375 --> 01:00:58,196
which previously was showing me the Hello

1665
01:00:58,196 --> 01:01:00,976
program because I stopped and restarted Flask,

1666
01:01:00,986 --> 01:01:02,936
and you can stop Flask by just hitting control C.

1667
01:01:03,379 --> 01:01:03,540
Uh,

1668
01:01:03,580 --> 01:01:04,419
for interrupting it,

1669
01:01:04,500 --> 01:01:06,459
I'm going to reload the page and I should now see,

1670
01:01:06,580 --> 01:01:06,750
OK,

1671
01:01:06,860 --> 01:01:08,899
a slightly more interesting form with the name

1672
01:01:08,899 --> 01:01:10,969
box with the cursor is blinking there,

1673
01:01:11,179 --> 01:01:12,179
and then a select menu,

1674
01:01:12,300 --> 01:01:13,860
a drop down with three options.

1675
01:01:14,020 --> 01:01:17,689
Now it's a little presumptuous of me to select basketball by default,

1676
01:01:17,699 --> 01:01:20,649
and in fact this is kind of inviting user error if they type in their name,

1677
01:01:20,699 --> 01:01:21,770
don't really think about it,

1678
01:01:21,939 --> 01:01:24,010
and now register for basketball accidentally.

1679
01:01:24,179 --> 01:01:26,370
So I'm going to make a couple of improvements here.

1680
01:01:26,580 --> 01:01:28,570
I'm actually going to have essentially a blank

1681
01:01:28,570 --> 01:01:31,459
option at the top whose value is nothing.

1682
01:01:31,919 --> 01:01:34,300
And I'm going to have it just labeled sport.

1683
01:01:34,510 --> 01:01:35,989
And just to be super clear,

1684
01:01:36,110 --> 01:01:38,560
I'm going to select this value by default.

1685
01:01:38,750 --> 01:01:42,469
So the option tag in HTML supports not only a value attribute but it turns out

1686
01:01:42,469 --> 01:01:45,149
a selected attribute which if present means that's

1687
01:01:45,149 --> 01:01:47,659
the option that will be selected by default.

1688
01:01:48,070 --> 01:01:52,270
So if we go back now to this page and reload to get a new copy of the HTM.

1689
01:01:52,395 --> 01:01:53,645
looks a little better.

1690
01:01:53,766 --> 01:01:55,315
I still have the name at left,

1691
01:01:55,486 --> 01:01:57,125
but the sport now menu looks like this,

1692
01:01:57,216 --> 01:02:01,025
so it's a little more clear what I want them to do from this drop down,

1693
01:02:01,085 --> 01:02:04,635
and sport deliberately on the back end won't have a value,

1694
01:02:04,645 --> 01:02:07,736
and theoretically this will help me determine if they actually selected a

1695
01:02:07,736 --> 01:02:12,115
sport or just clicked register and ignored the drop down still.

1696
01:02:12,285 --> 01:02:12,775
But I do need.

1697
01:02:12,941 --> 01:02:15,701
Way for them to register ideally by clicking a button,

1698
01:02:15,781 --> 01:02:16,771
so I'm going to add a button,

1699
01:02:17,001 --> 01:02:18,731
the type of which is submit,

1700
01:02:18,941 --> 01:02:21,812
and then I'm going to have this button's label be register.

1701
01:02:22,062 --> 01:02:23,892
So now if I go back to the form once more,

1702
01:02:23,941 --> 01:02:24,592
reload,

1703
01:02:24,741 --> 01:02:25,382
I now have,

1704
01:02:25,422 --> 01:02:25,812
I think,

1705
01:02:25,862 --> 01:02:26,931
a complete form,

1706
01:02:26,941 --> 01:02:28,291
albeit not very pretty,

1707
01:02:28,541 --> 01:02:29,731
via which David

1708
01:02:29,981 --> 01:02:30,672
can register,

1709
01:02:30,781 --> 01:02:31,172
for instance,

1710
01:02:31,181 --> 01:02:33,362
for basketball by clicking register and

1711
01:02:34,021 --> 01:02:34,562
darn it,

1712
01:02:34,691 --> 01:02:36,771
I have a 404 not found.

1713
01:02:36,941 --> 01:02:37,862
But why is that?

1714
01:02:39,169 --> 01:02:40,280
Why

1715
01:02:40,489 --> 01:02:41,800
is nothing yet found.

1716
01:02:42,639 --> 01:02:43,879
Why is slash register not found,

1717
01:02:43,959 --> 01:02:44,159
yeah.

1718
01:02:46,229 --> 01:02:46,899
What's that?

1719
01:02:48,659 --> 01:02:48,739
Yeah,

1720
01:02:48,820 --> 01:02:49,060
I haven't,

1721
01:02:49,070 --> 01:02:49,179
well,

1722
01:02:49,260 --> 01:02:50,810
I haven't linked the option to anything.

1723
01:02:50,840 --> 01:02:52,580
I think the form has been linked,

1724
01:02:52,780 --> 01:02:53,219
whoops,

1725
01:02:53,300 --> 01:02:56,699
the form is telling the browser to go to slash register,

1726
01:02:56,739 --> 01:02:57,790
so this is correct behavior.

1727
01:02:58,020 --> 01:02:58,330
But

1728
01:02:58,780 --> 01:03:00,010
if we go to app.ie,

1729
01:03:00,139 --> 01:03:02,540
like there's no route defined for slash register.

1730
01:03:02,560 --> 01:03:05,060
So of course it's not found because there's an infinite number

1731
01:03:05,060 --> 01:03:08,090
of routes that don't exist and register is currently among those.

1732
01:03:08,379 --> 01:03:09,810
So I can define that myself.

1733
01:03:09,860 --> 01:03:10,739
I can say app.

1734
01:03:11,020 --> 01:03:11,570
route.

1735
01:03:12,820 --> 01:03:13,649
register.

1736
01:03:14,179 --> 01:03:15,300
I do want to use post,

1737
01:03:15,379 --> 01:03:17,729
so I need to proactively say that the methods this

1738
01:03:18,260 --> 01:03:22,070
function will support will be indeed post instead of the default of get.

1739
01:03:22,300 --> 01:03:24,879
I'm going to define an actual function to call when this route is used,

1740
01:03:24,899 --> 01:03:27,020
and by convention I'm going to call it just register,

1741
01:03:27,060 --> 01:03:28,770
even though I could call it anything I want.

1742
01:03:29,020 --> 01:03:31,229
And inside of my register function,

1743
01:03:31,260 --> 01:03:31,409
well,

1744
01:03:31,419 --> 01:03:33,469
for now I'm going to cheat a little bit.

1745
01:03:33,540 --> 01:03:35,530
I'm going to at least just say.

1746
01:03:36,010 --> 01:03:36,629
Uh,

1747
01:03:36,780 --> 01:03:40,379
I'm going to at least check that the user has given me a name and a sport.

1748
01:03:40,500 --> 01:03:41,810
So how can I express this?

1749
01:03:41,939 --> 01:03:42,020
Well,

1750
01:03:42,260 --> 01:03:45,919
because I've already imported the request global variable that comes with flask,

1751
01:03:45,979 --> 01:03:47,090
I can ask questions of it

1752
01:03:47,300 --> 01:03:49,379
and I can say something like if it is

1753
01:03:49,379 --> 01:03:54,169
not the case that request.form.get name has a value,

1754
01:03:54,469 --> 01:03:58,340
or if it's the case that or if it's not the case that request.

1755
01:03:58,665 --> 01:04:01,324
Forget sport has a value,

1756
01:04:01,574 --> 01:04:04,495
then let's go ahead and give the user uh a warning

1757
01:04:04,495 --> 01:04:08,685
of sorts or return render template of a file called failure.

1758
01:04:08,895 --> 01:04:09,544
HTML.

1759
01:04:09,774 --> 01:04:10,764
This doesn't exist yet,

1760
01:04:10,935 --> 01:04:11,495
but no big deal.

1761
01:04:11,695 --> 01:04:13,044
Let me go back into my terminal.

1762
01:04:13,294 --> 01:04:17,205
Let me uh go into templates and create a file called failure.

1763
01:04:17,645 --> 01:04:18,475
HTML,

1764
01:04:18,655 --> 01:04:21,175
and in this file I'm gonna say that it extends.

1765
01:04:22,320 --> 01:04:23,189
Uh,

1766
01:04:23,199 --> 01:04:24,030
layout.

1767
01:04:24,570 --> 01:04:25,290
HTML.

1768
01:04:26,399 --> 01:04:27,159
HTML

1769
01:04:27,489 --> 01:04:30,330
and then it has a block body

1770
01:04:30,919 --> 01:04:34,629
inside of which is gonna be something like super trivial for now just

1771
01:04:34,629 --> 01:04:38,310
to get us going and this failure page is simply going to say

1772
01:04:38,760 --> 01:04:39,479
you.

1773
01:04:40,020 --> 01:04:43,929
Are not registered and then and blocked.

1774
01:04:44,100 --> 01:04:46,439
So that's it just sort of an error page that now exists.

1775
01:04:46,449 --> 01:04:47,770
I'm gonna close it out of sight,

1776
01:04:47,810 --> 01:04:48,409
out of mind,

1777
01:04:48,620 --> 01:04:50,010
but I think this now will work.

1778
01:04:50,260 --> 01:04:52,729
If it is not the case that the user gave us a name

1779
01:04:52,729 --> 01:04:54,979
or it's not the case that the user gave us a sport,

1780
01:04:55,080 --> 01:04:57,300
we will show this error message otherwise.

1781
01:04:57,389 --> 01:04:59,669
If all seems to be well for now we're

1782
01:04:59,669 --> 01:05:01,300
not going to do anything useful with the information,

1783
01:05:01,370 --> 01:05:04,169
but I'm going to go ahead and return render template

1784
01:05:04,580 --> 01:05:05,580
of success.

1785
01:05:05,780 --> 01:05:06,489
HTML,

1786
01:05:06,860 --> 01:05:09,600
which is simply going to assume that the user was successfully registered.

1787
01:05:09,739 --> 01:05:10,939
So let's whip that up quickly.

1788
01:05:11,340 --> 01:05:13,729
I'm going to go ahead and code up success.

1789
01:05:13,979 --> 01:05:14,570
HTML.

1790
01:05:15,209 --> 01:05:16,340
Inside of this file,

1791
01:05:16,479 --> 01:05:18,389
which will similarly extend

1792
01:05:18,959 --> 01:05:19,399
layout.

1793
01:05:19,560 --> 01:05:20,389
HTML

1794
01:05:20,919 --> 01:05:24,800
inside of which there's a body block that quite simply says how

1795
01:05:24,800 --> 01:05:27,830
about you are registered and we'll just pretend that it is so

1796
01:05:28,159 --> 01:05:28,729
and block.

1797
01:05:28,919 --> 01:05:29,439
So that's it.

1798
01:05:29,540 --> 01:05:29,760
In short,

1799
01:05:29,800 --> 01:05:33,560
I wanted two templates that show failure or success respectively.

1800
01:05:33,800 --> 01:05:36,750
So I think now in app.ie we're in better shape.

1801
01:05:36,830 --> 01:05:41,500
I now have a register route that will get called if post is used to visit it,

1802
01:05:41,709 --> 01:05:43,310
and I'm going to check request.form,

1803
01:05:43,389 --> 01:05:45,350
which is where you get the post variables from,

1804
01:05:45,550 --> 01:05:47,699
check whether name or sport is provided,

1805
01:05:47,709 --> 01:05:49,739
and I'm going to render a template accordingly.

1806
01:05:49,909 --> 01:05:50,550
So let's try this.

1807
01:05:50,629 --> 01:05:52,479
Let me go back to my other tab

1808
01:05:52,669 --> 01:05:53,889
and go back to the form.

1809
01:05:54,189 --> 01:05:55,270
Let me type in my name,

1810
01:05:55,429 --> 01:05:55,840
David,

1811
01:05:55,909 --> 01:05:57,179
but no sport.

1812
01:05:57,389 --> 01:05:58,350
Click register.

1813
01:05:58,840 --> 01:06:01,500
And I have an internal server error which was not intended,

1814
01:06:01,739 --> 01:06:03,300
so let's figure out how to diagnose this.

1815
01:06:03,419 --> 01:06:04,770
So it seems to be the case

1816
01:06:04,939 --> 01:06:07,129
that I'm at slash register that was intended,

1817
01:06:07,260 --> 01:06:08,409
but something clearly went wrong,

1818
01:06:08,500 --> 01:06:09,370
so let's go back.

1819
01:06:09,580 --> 01:06:11,379
Now I could just kind of stare at my code endlessly,

1820
01:06:11,419 --> 01:06:13,020
but recall that there should be some hints

1821
01:06:13,020 --> 01:06:14,879
in my terminal window that's running flat.

1822
01:06:15,429 --> 01:06:17,219
So let me go back to my other terminal,

1823
01:06:17,510 --> 01:06:18,379
and there it is,

1824
01:06:18,590 --> 01:06:22,000
unexpected char double quote at line 11.

1825
01:06:22,310 --> 01:06:22,469
Well,

1826
01:06:22,669 --> 01:06:24,100
so sounds like user error,

1827
01:06:24,110 --> 01:06:25,879
so that is in failure.

1828
01:06:26,310 --> 01:06:29,929
HTML and you can kind of see it because Flask is like underlining it literally for me.

1829
01:06:30,030 --> 01:06:31,149
What did I do that was stupid?

1830
01:06:33,159 --> 01:06:33,320
Yeah,

1831
01:06:33,389 --> 01:06:34,459
I just didn't close my quote.

1832
01:06:34,560 --> 01:06:35,899
So amateur hour here,

1833
01:06:35,959 --> 01:06:37,310
so let me go into,

1834
01:06:37,389 --> 01:06:38,570
I do need to open it after all,

1835
01:06:38,669 --> 01:06:39,229
ironically,

1836
01:06:39,350 --> 01:06:41,580
so let's go ahead in my other terminal,

1837
01:06:42,070 --> 01:06:42,979
open up failure.

1838
01:06:43,149 --> 01:06:45,260
HTML and there it is,

1839
01:06:45,270 --> 01:06:47,659
one stupid character away from correctness.

1840
01:06:47,820 --> 01:06:47,949
All right,

1841
01:06:48,030 --> 01:06:49,139
let's close this again.

1842
01:06:49,469 --> 01:06:51,110
Go back to the other tab.

1843
01:06:51,790 --> 01:06:52,659
Let's try this again.

1844
01:06:52,790 --> 01:06:53,580
David is my name,

1845
01:06:53,629 --> 01:06:55,540
but no sport register.

1846
01:06:55,909 --> 01:06:56,229
OK,

1847
01:06:56,350 --> 01:06:57,350
you are not registered.

1848
01:06:57,469 --> 01:06:58,260
I don't know why,

1849
01:06:58,350 --> 01:06:59,429
but I know I'm not registered.

1850
01:06:59,510 --> 01:07:00,620
Let's try it again with

1851
01:07:00,830 --> 01:07:02,379
a uh with no name,

1852
01:07:02,629 --> 01:07:03,060
but yes,

1853
01:07:03,070 --> 01:07:03,860
a sport,

1854
01:07:04,110 --> 01:07:05,060
click register,

1855
01:07:05,310 --> 01:07:06,189
you are not registered.

1856
01:07:06,310 --> 01:07:06,429
All right,

1857
01:07:06,469 --> 01:07:07,070
just for good measure,

1858
01:07:07,149 --> 01:07:08,739
let's give no name and no sport.

1859
01:07:08,949 --> 01:07:09,790
You are not registered.

1860
01:07:09,830 --> 01:07:11,000
So that seems to be working.

1861
01:07:11,189 --> 01:07:12,110
Let's now cooperate.

1862
01:07:12,189 --> 01:07:15,179
Let's go ahead and register as David for basketball.

1863
01:07:15,429 --> 01:07:16,459
Cross my fingers,

1864
01:07:17,280 --> 01:07:17,709
damn it.

1865
01:07:17,979 --> 01:07:19,409
And internal server error.

1866
01:07:19,530 --> 01:07:21,250
Let's try to learn from my past mistakes.

1867
01:07:21,370 --> 01:07:23,100
Let's open up this eyeball it.

1868
01:07:23,129 --> 01:07:23,889
I did it twice,

1869
01:07:23,969 --> 01:07:25,270
even though that was not copy paste,

1870
01:07:25,330 --> 01:07:26,459
so 0 for 2.

1871
01:07:26,760 --> 01:07:26,889
All right,

1872
01:07:26,969 --> 01:07:27,919
let's go back here.

1873
01:07:28,169 --> 01:07:31,290
Notice now I can actually just click reload because the browser's

1874
01:07:31,290 --> 01:07:34,199
smart enough to remember what I just posted to the server.

1875
01:07:34,370 --> 01:07:35,489
So if I click reload,

1876
01:07:35,649 --> 01:07:39,969
you'll be prompted to confirm the form submission lest you be doing this on a

1877
01:07:39,969 --> 01:07:43,040
website with your credit card or something where you don't want to send it twice.

1878
01:07:43,250 --> 01:07:45,889
But in this case I'm fine with sending my name in basketball twice,

1879
01:07:45,929 --> 01:07:47,010
so I'm going to click continue.

1880
01:07:47,570 --> 01:07:49,030
And this time it worked,

1881
01:07:49,280 --> 01:07:49,949
telling me

1882
01:07:50,199 --> 01:07:54,389
that I'm actually registered so I'm not doing anything with the students' data,

1883
01:07:54,449 --> 01:07:59,040
but at least I am validating that they gave me some inputs.

1884
01:07:59,639 --> 01:08:00,870
Now there's a catch here.

1885
01:08:01,080 --> 01:08:01,520
The catch,

1886
01:08:01,550 --> 01:08:01,909
of course,

1887
01:08:01,959 --> 01:08:06,310
with HTML is that it's all executed client side.

1888
01:08:06,520 --> 01:08:07,949
And so for instance,

1889
01:08:08,000 --> 01:08:11,560
suppose that a student is really upset that we only offer basketball,

1890
01:08:11,800 --> 01:08:12,120
soccer,

1891
01:08:12,199 --> 01:08:13,239
and ultimate frisbee,

1892
01:08:13,250 --> 01:08:14,520
and maybe they really want to register for

1893
01:08:14,520 --> 01:08:16,620
volleyball even though we're not offering volleyball.

1894
01:08:16,759 --> 01:08:16,799
Well,

1895
01:08:16,839 --> 01:08:19,720
there's arguably like a security vulnerability here

1896
01:08:19,720 --> 01:08:22,229
where technically my code right now will tolerate

1897
01:08:22,229 --> 01:08:26,080
any user input even if it's not in that drop down because after all,

1898
01:08:26,279 --> 01:08:27,640
let me go ahead and right click.

1899
01:08:28,259 --> 01:08:31,879
Or control click on my web page and open up the developer tools.

1900
01:08:32,060 --> 01:08:35,129
Let me go into the form as sort of a hacker type student.

1901
01:08:35,299 --> 01:08:37,049
Let me go into the select menu

1902
01:08:37,299 --> 01:08:37,709
and OK,

1903
01:08:37,910 --> 01:08:38,490
no big deal.

1904
01:08:38,660 --> 01:08:41,370
If I want ultimate Frisbee to exist,

1905
01:08:41,620 --> 01:08:41,779
well,

1906
01:08:41,859 --> 01:08:43,470
I just need to know a little HTML.

1907
01:08:43,700 --> 01:08:47,149
I'm going to right click on that element and click edit as HTML.

1908
01:08:47,459 --> 01:08:49,660
This literally lets me start editing the HTML.

1909
01:08:49,763 --> 01:08:52,542
of the page I'm going to give myself my own option.

1910
01:08:52,631 --> 01:08:55,482
Option value equals volleyball

1911
01:08:55,912 --> 01:08:58,381
close brackets volleyball

1912
01:08:58,962 --> 01:08:59,643
enter

1913
01:08:59,912 --> 01:09:02,062
and now when I close developer tools,

1914
01:09:02,112 --> 01:09:02,582
woo hoo,

1915
01:09:02,683 --> 01:09:04,433
I can register for volleyball if I want.

1916
01:09:04,553 --> 01:09:04,921
So

1917
01:09:05,232 --> 01:09:06,622
let's select volleyball,

1918
01:09:06,872 --> 01:09:09,743
type in maybe Kelly is hacking the site register,

1919
01:09:09,953 --> 01:09:11,312
and she is registered for volleyball.

1920
01:09:11,415 --> 01:09:12,035
Apparently,

1921
01:09:12,475 --> 01:09:12,564
all right,

1922
01:09:12,645 --> 01:09:14,484
so the short answer is the short,

1923
01:09:14,685 --> 01:09:17,615
the takeaway here is do not trust user input

1924
01:09:17,884 --> 01:09:20,685
ever for reasons we've already seen when we discuss SQL

1925
01:09:20,685 --> 01:09:22,604
ever more so now that we're dealing with the web,

1926
01:09:22,725 --> 01:09:25,615
because who knows what users are going to do accidentally,

1927
01:09:25,805 --> 01:09:26,484
foolishly,

1928
01:09:26,524 --> 01:09:30,734
or even in Kelly's case here maliciously trying to pass data that we did not expect.

1929
01:09:30,845 --> 01:09:31,075
So

1930
01:09:31,365 --> 01:09:33,125
what would be the defense against this?

1931
01:09:33,365 --> 01:09:35,285
Like this is just how HTML works.

1932
01:09:35,759 --> 01:09:38,830
And assume that I'm actually registering Kelly for sports now and

1933
01:09:38,830 --> 01:09:41,080
somehow she's now signed up for volleyball on our database.

1934
01:09:41,370 --> 01:09:43,220
What would a solution be logically here?

1935
01:09:44,410 --> 01:09:44,720
Yeah.

1936
01:09:46,399 --> 01:09:46,560
Yeah,

1937
01:09:46,680 --> 01:09:49,549
so maybe do some server side validation.

1938
01:09:49,600 --> 01:09:52,870
So don't just blindly check that we have a value from the user.

1939
01:09:53,080 --> 01:09:55,080
Actually check that it's one of those sports.

1940
01:09:55,180 --> 01:09:57,270
So if I go back to app.ie,

1941
01:09:57,600 --> 01:09:59,109
I could do this in a few ways,

1942
01:09:59,120 --> 01:10:01,350
and maybe my first instinct would be this.

1943
01:10:01,439 --> 01:10:03,319
Let's check for the name and do this,

1944
01:10:03,439 --> 01:10:04,569
but let's also do this.

1945
01:10:04,600 --> 01:10:05,799
Like if request.

1946
01:10:06,359 --> 01:10:08,379
Dot form do get quote unquote

1947
01:10:09,359 --> 01:10:13,000
uh sport and actually let's put this in a variable just

1948
01:10:13,000 --> 01:10:16,310
to make it even easier to type so sport equals this

1949
01:10:16,720 --> 01:10:18,109
if sport,

1950
01:10:18,520 --> 01:10:18,870
uh,

1951
01:10:18,879 --> 01:10:21,189
how about does not equal,

1952
01:10:21,439 --> 01:10:21,859
uh,

1953
01:10:21,870 --> 01:10:23,560
what was it basket

1954
01:10:23,839 --> 01:10:24,459
ball

1955
01:10:24,879 --> 01:10:25,240
and.

1956
01:10:25,339 --> 01:10:29,520
Sport does not equal uh soccer

1957
01:10:29,850 --> 01:10:34,560
and sport does not equal quote unquote ultimate frisbee,

1958
01:10:34,930 --> 01:10:36,779
then render an error.

1959
01:10:36,850 --> 01:10:37,229
So,

1960
01:10:37,250 --> 01:10:37,870
uh,

1961
01:10:38,009 --> 01:10:38,439
return,

1962
01:10:38,509 --> 01:10:41,240
render template quote unquote failure.

1963
01:10:41,569 --> 01:10:42,189
HTML.

1964
01:10:42,569 --> 01:10:44,560
So now if I go back to this form

1965
01:10:45,089 --> 01:10:47,120
and try to register as Kelly again.

1966
01:10:47,410 --> 01:10:48,359
You are not registered,

1967
01:10:48,399 --> 01:10:50,660
so I somehow caught her because volleyball,

1968
01:10:50,680 --> 01:10:50,919
of course,

1969
01:10:50,959 --> 01:10:53,069
is not in the list of sports that I put there.

1970
01:10:53,270 --> 01:10:56,029
But what might you not like about this approach?

1971
01:10:57,379 --> 01:10:58,859
Even if you've never done web stuff before,

1972
01:10:58,939 --> 01:10:59,850
what's bad about this?

1973
01:11:01,919 --> 01:11:02,149
Yeah,

1974
01:11:02,229 --> 01:11:06,149
I have to hard code every single sport now in not only A.ie to

1975
01:11:06,149 --> 01:11:09,379
check for the validity on the server of what the human is typed in,

1976
01:11:09,549 --> 01:11:12,189
but recall that the drop down itself came from index.

1977
01:11:12,500 --> 01:11:12,970
HTML.

1978
01:11:13,069 --> 01:11:16,189
So I now in duplicate have to put like all of the sports there too.

1979
01:11:16,270 --> 01:11:20,189
So like this just seems bad to have duplication and so better might

1980
01:11:20,189 --> 01:11:22,870
be to do something more like this at the top of my file.

1981
01:11:22,955 --> 01:11:23,145
Here,

1982
01:11:23,345 --> 01:11:25,944
why don't I go ahead and just give myself a global variable which in the

1983
01:11:25,944 --> 01:11:29,615
context of this web app is perfectly reasonable so I can access it anywhere.

1984
01:11:29,825 --> 01:11:32,064
Let's call it sports in all caps just to

1985
01:11:32,064 --> 01:11:34,654
connote that this is a global variable and constant,

1986
01:11:34,865 --> 01:11:38,214
even though Python does not have consts in the sense that C does,

1987
01:11:38,225 --> 01:11:39,825
but this is sort of on the honor system.

1988
01:11:39,865 --> 01:11:41,464
If you see a variable in all caps like this,

1989
01:11:41,584 --> 01:11:42,495
just don't mess with it,

1990
01:11:42,665 --> 01:11:42,984
use it,

1991
01:11:43,024 --> 01:11:43,865
but don't mess with it.

1992
01:11:44,350 --> 01:11:44,660
So,

1993
01:11:44,830 --> 01:11:45,100
uh,

1994
01:11:45,430 --> 01:11:47,589
inside of the square brackets this is gonna be a

1995
01:11:47,589 --> 01:11:49,470
list of the sports that I do want to support,

1996
01:11:49,479 --> 01:11:50,859
so basketball,

1997
01:11:51,180 --> 01:11:51,740
comma,

1998
01:11:52,069 --> 01:11:52,310
uh,

1999
01:11:52,390 --> 01:11:52,939
soccer,

2000
01:11:53,029 --> 01:11:53,600
comma,

2001
01:11:53,990 --> 01:11:55,540
ultimate frisbee,

2002
01:11:55,709 --> 01:11:56,500
and that's it.

2003
01:11:56,850 --> 01:11:59,459
Now instead of doing all of this,

2004
01:11:59,589 --> 01:12:01,069
what I can instead ask is a.

2005
01:12:01,214 --> 01:12:05,805
Simpler question like this if sport not in sports,

2006
01:12:05,924 --> 01:12:08,915
then go ahead and return render template

2007
01:12:09,205 --> 01:12:10,395
quote unquote failure.

2008
01:12:10,805 --> 01:12:13,245
HTML and I can actually tighten this up a little bit.

2009
01:12:13,325 --> 01:12:15,794
I don't need two calls to failure.

2010
01:12:15,964 --> 01:12:16,484
HTML.

2011
01:12:16,604 --> 01:12:18,194
Why don't I just borrow this code

2012
01:12:18,564 --> 01:12:19,365
and say.

2013
01:12:20,149 --> 01:12:20,819
Or,

2014
01:12:21,259 --> 01:12:21,939
uh,

2015
01:12:22,270 --> 01:12:22,740
sport,

2016
01:12:22,790 --> 01:12:24,870
not in sports render a failure,

2017
01:12:24,910 --> 01:12:27,120
and now I've tightened this up quite a bit more,

2018
01:12:27,589 --> 01:12:27,939
but

2019
01:12:28,149 --> 01:12:29,830
I'm essentially using Python to just ask,

2020
01:12:29,870 --> 01:12:33,600
is the sport that oops sorry I deleted too much sport equals

2021
01:12:33,990 --> 01:12:35,310
actually let's just tighten it up further.

2022
01:12:35,390 --> 01:12:36,259
Sport does not exist,

2023
01:12:36,310 --> 01:12:39,689
so let's do request.form.get quote unquote sport.

2024
01:12:39,990 --> 01:12:43,350
So if the sport that the human typed in or selected from the

2025
01:12:43,350 --> 01:12:47,709
drop down somehow is not in this global list of possible sports,

2026
01:12:47,830 --> 01:12:48,709
well then it's a failure.

2027
01:12:48,901 --> 01:12:51,251
Don't let Kelly or whoever register instead,

2028
01:12:51,521 --> 01:12:53,361
but if I now have this global variable,

2029
01:12:53,401 --> 01:12:55,171
I can be a bit smarter in my template.

2030
01:12:55,321 --> 01:12:59,111
I don't need to manually write out all three of these sports here.

2031
01:12:59,361 --> 01:12:59,892
Instead,

2032
01:12:59,961 --> 01:13:01,282
I think I can be smart about this,

2033
01:13:01,301 --> 01:13:02,521
and when I render index.

2034
01:13:02,682 --> 01:13:03,791
HTML itself,

2035
01:13:04,041 --> 01:13:05,392
why don't I just pass in

2036
01:13:05,562 --> 01:13:07,111
a variable called sports,

2037
01:13:07,122 --> 01:13:07,832
for instance,

2038
01:13:08,041 --> 01:13:10,551
set it equal to the value of that global array,

2039
01:13:10,881 --> 01:13:12,111
and then in my template,

2040
01:13:12,202 --> 01:13:15,751
and here's where templating again gets interesting and starts to save you time,

2041
01:13:15,921 --> 01:13:16,881
let me go into index.

2042
01:13:17,041 --> 01:13:17,551
HTML.

2043
01:13:17,863 --> 01:13:20,773
Delete all but the default value,

2044
01:13:20,813 --> 01:13:21,604
the blank one,

2045
01:13:21,693 --> 01:13:22,844
and do something like this.

2046
01:13:23,124 --> 01:13:23,494
Ginja,

2047
01:13:23,534 --> 01:13:24,014
it turns out,

2048
01:13:24,054 --> 01:13:28,613
also supports loops like Python for sports in sports

2049
01:13:28,613 --> 01:13:31,133
using the curly braces and the percent signs,

2050
01:13:31,173 --> 01:13:34,844
I can now dynamically generate options as many as I want.

2051
01:13:35,054 --> 01:13:37,173
So option value equals quote unquote

2052
01:13:37,414 --> 01:13:40,083
the current sport close uh there,

2053
01:13:40,293 --> 01:13:41,324
close brackets

2054
01:13:41,874 --> 01:13:42,403
sport.

2055
01:13:42,494 --> 01:13:43,414
So it's a little redundant,

2056
01:13:43,454 --> 01:13:45,164
but again this is just how HTML is.

2057
01:13:45,293 --> 01:13:46,494
This is what the human sees.

2058
01:13:46,866 --> 01:13:49,056
This is the value that gets submitted to the server

2059
01:13:49,056 --> 01:13:51,255
in case you want one to differ from the other,

2060
01:13:51,545 --> 01:13:54,576
and then below that option line I can say end 4,

2061
01:13:54,786 --> 01:13:55,536
which is a bit weird,

2062
01:13:55,625 --> 01:13:57,215
but that's how it works in Jinja

2063
01:13:57,505 --> 01:13:58,536
to stop that loop.

2064
01:13:58,706 --> 01:14:00,025
So this is kind of powerful.

2065
01:14:00,105 --> 01:14:01,465
Now if I have 3 sports,

2066
01:14:01,666 --> 01:14:02,775
30 sports,

2067
01:14:02,826 --> 01:14:06,306
all of the options will be dynamically generated by this template.

2068
01:14:06,386 --> 01:14:09,866
And so now we're starting to save ourselves time and I can centrally

2069
01:14:09,866 --> 01:14:13,766
manage all the sports by just updating this global list here in App.ie.

2070
01:14:14,065 --> 01:14:15,295
So let's go back to the browser.

2071
01:14:15,879 --> 01:14:16,089
Uh,

2072
01:14:16,100 --> 01:14:17,509
back to the form reload,

2073
01:14:17,680 --> 01:14:20,950
and you'll see that the drop down thankfully still works the same way,

2074
01:14:21,200 --> 01:14:23,640
but all of those options were dynamically generated.

2075
01:14:23,680 --> 01:14:23,939
Indeed,

2076
01:14:23,959 --> 01:14:25,990
if I view page source from my browser,

2077
01:14:26,200 --> 01:14:28,839
you'll see and there's some extra white space there because

2078
01:14:28,839 --> 01:14:31,390
the loop was adding some white space on each iteration.

2079
01:14:31,560 --> 01:14:33,950
I still have the 3 sports but not volleyball,

2080
01:14:34,200 --> 01:14:34,680
as was my.

2081
01:14:34,759 --> 01:14:35,339
Intention.

2082
01:14:35,470 --> 01:14:36,419
So now if

2083
01:14:36,669 --> 01:14:39,709
uh if Kelly even tries hacking this version of the site by

2084
01:14:39,709 --> 01:14:42,939
going in here and select and typing in volleyball manually registering,

2085
01:14:43,069 --> 01:14:47,390
the logic will still catch it because only those three sports are in that array.

2086
01:14:47,470 --> 01:14:50,419
So it's perfectly fine for me now to register for basketball

2087
01:14:50,750 --> 01:14:51,560
because it's among

2088
01:14:51,779 --> 01:14:52,509
the sports,

2089
01:14:52,649 --> 01:14:52,790
sorry,

2090
01:14:52,830 --> 01:14:53,779
in that list,

2091
01:14:54,180 --> 01:14:55,180
not array.

2092
01:14:55,669 --> 01:14:57,430
Questions on any of these here.

2093
01:14:58,729 --> 01:14:59,890
Techniques.

2094
01:15:01,600 --> 01:15:01,799
All right,

2095
01:15:01,870 --> 01:15:03,229
how about another type of form?

2096
01:15:03,270 --> 01:15:04,669
So select menus are nice,

2097
01:15:04,750 --> 01:15:07,509
but you also might see radio buttons on websites which are the mutually

2098
01:15:07,509 --> 01:15:11,100
exclusive little circles that you can select to choose one or another option.

2099
01:15:11,450 --> 01:15:11,459
Uh,

2100
01:15:11,470 --> 01:15:13,310
let me go back to index.

2101
01:15:13,470 --> 01:15:15,899
HTML and just show you how those can be created as well.

2102
01:15:16,109 --> 01:15:17,979
Instead of using a select menu,

2103
01:15:18,270 --> 01:15:22,620
turns out we can create a whole bunch of inputs of radio type

2104
01:15:22,830 --> 01:15:23,790
type as follows,

2105
01:15:24,310 --> 01:15:26,870
of radio button type as follows for each sport,

2106
01:15:26,950 --> 01:15:28,959
so for sport in sports,

2107
01:15:29,149 --> 01:15:30,629
let's go ahead and output.

2108
01:15:31,540 --> 01:15:34,160
In between this tag and the end for

2109
01:15:34,640 --> 01:15:36,390
the following input

2110
01:15:36,720 --> 01:15:39,310
type equals radio.

2111
01:15:39,720 --> 01:15:39,729
Uh,

2112
01:15:40,790 --> 01:15:41,720
and let's give it a name.

2113
01:15:41,910 --> 01:15:46,549
The name of this radio box is going radio button is going to be sports,

2114
01:15:46,770 --> 01:15:50,750
and the value of the current input is going to be quote unquote

2115
01:15:51,060 --> 01:15:52,020
sports,

2116
01:15:52,310 --> 01:15:55,700
and the word that the human's going to see is as before sport.

2117
01:15:55,950 --> 01:15:58,270
So notice it's just another type of input.

2118
01:15:58,459 --> 01:16:00,259
Previously we've seen text,

2119
01:16:00,470 --> 01:16:00,750
for instance,

2120
01:16:00,870 --> 01:16:01,620
two lines above.

2121
01:16:01,750 --> 01:16:03,379
We also saw last time search.

2122
01:16:03,470 --> 01:16:04,310
We saw email.

2123
01:16:04,390 --> 01:16:06,660
There's a bunch of text input types.

2124
01:16:06,910 --> 01:16:08,709
This one though is going to display as a.

2125
01:16:08,792 --> 01:16:11,933
Radio button instead and the human is going to see this label here.

2126
01:16:12,143 --> 01:16:14,853
If I now go back to my other browser tab and click back,

2127
01:16:15,062 --> 01:16:16,732
click reload on the form,

2128
01:16:16,942 --> 01:16:18,373
I should see it's not pretty,

2129
01:16:18,663 --> 01:16:19,073
but

2130
01:16:19,303 --> 01:16:22,502
it's a radio button in the sense that these are mutually exclusive.

2131
01:16:22,583 --> 01:16:25,533
How does the browser know that I should only be allowed to select one of them?

2132
01:16:25,623 --> 01:16:26,013
Well,

2133
01:16:26,462 --> 01:16:29,812
because I use the same name for each of those radio buttons.

2134
01:16:29,823 --> 01:16:32,453
It knows that means mutual exclusivity.

2135
01:16:32,583 --> 01:16:32,902
In fact,

2136
01:16:32,962 --> 01:16:35,053
if I view page source in the browser,

2137
01:16:35,223 --> 01:16:37,703
you'll see that all three of the inputs that were dynamically.

2138
01:16:38,335 --> 01:16:39,056
type equals radio.

2139
01:16:39,125 --> 01:16:39,775
Type equals radio,

2140
01:16:39,855 --> 01:16:43,016
type equals radio also have identical names.

2141
01:16:43,116 --> 01:16:44,215
And so that's just how

2142
01:16:44,536 --> 01:16:45,375
that works.

2143
01:16:45,416 --> 01:16:46,695
And that's the only change necessary.

2144
01:16:46,735 --> 01:16:48,175
If I now go ahead and type in my name,

2145
01:16:48,255 --> 01:16:49,195
David basketball,

2146
01:16:49,255 --> 01:16:50,125
click register,

2147
01:16:50,295 --> 01:16:55,405
we're still up and running because what the server gets is still exactly the same

2148
01:16:55,936 --> 01:16:57,056
inside of request.

2149
01:16:57,735 --> 01:16:58,246
form

2150
01:16:58,616 --> 01:16:59,545
they can access,

2151
01:16:59,576 --> 01:17:04,005
you can still access name or sport no matter what type it was

2152
01:17:04,335 --> 01:17:06,815
in the user's own browser.

2153
01:17:08,729 --> 01:17:10,770
Questions on these techniques.

2154
01:17:12,350 --> 01:17:12,540
All right,

2155
01:17:12,629 --> 01:17:12,709
well,

2156
01:17:12,750 --> 01:17:16,029
it's kind of obnoxious that when you don't do something right in

2157
01:17:16,029 --> 01:17:18,660
this website like forget your name but you select a sport,

2158
01:17:18,830 --> 01:17:21,149
all you are told is generically you are not registered.

2159
01:17:21,189 --> 01:17:23,149
Like it'd be nice and much more user friendly,

2160
01:17:23,209 --> 01:17:24,990
better UX user experience,

2161
01:17:25,040 --> 01:17:25,509
so to speak,

2162
01:17:25,750 --> 01:17:28,509
to actually tell the user what's wrong so they can actually fix the problem.

2163
01:17:28,549 --> 01:17:29,109
Now there's a bunch of.

2164
01:17:29,205 --> 01:17:30,064
We can do this,

2165
01:17:30,154 --> 01:17:32,345
but I'm going to propose that we go ahead and do this.

2166
01:17:32,595 --> 01:17:34,955
Let's create a template called error.

2167
01:17:35,145 --> 01:17:35,794
HTML,

2168
01:17:35,834 --> 01:17:38,035
whose purpose in life is just to tell the user

2169
01:17:38,035 --> 01:17:39,865
a little something more about what they did wrong.

2170
01:17:40,035 --> 01:17:42,625
So I'm going to go back into my terminal window here.

2171
01:17:42,754 --> 01:17:44,484
I'm going to code up a file called error.

2172
01:17:45,234 --> 01:17:45,794
HTML.

2173
01:17:46,479 --> 01:17:47,060
Enter

2174
01:17:47,339 --> 01:17:49,169
and I'm going to go ahead and before,

2175
01:17:49,299 --> 01:17:49,779
as before,

2176
01:17:49,899 --> 01:17:52,049
extend layout.

2177
01:17:52,609 --> 01:17:53,410
HTML,

2178
01:17:53,580 --> 01:17:55,890
learning from my past mistakes and closing that quote.

2179
01:17:56,180 --> 01:18:00,729
Then I'm going to go ahead and do body block down here and then inside of this

2180
01:18:01,379 --> 01:18:04,500
block body I'm going to go ahead and have just some simple

2181
01:18:04,500 --> 01:18:07,540
text like an H1 tag that just says error to the user.

2182
01:18:07,672 --> 01:18:11,192
Then a paragraph tag that's going to contain some error message

2183
01:18:11,533 --> 01:18:12,603
to be determined

2184
01:18:13,172 --> 01:18:13,962
and then

2185
01:18:14,292 --> 01:18:15,292
uh that's it for now.

2186
01:18:15,453 --> 01:18:17,683
So I've got the template for an error message screen.

2187
01:18:17,913 --> 01:18:20,212
Let me go back into app.ie now and let me

2188
01:18:20,212 --> 01:18:23,402
add some logic because A.ie does know what's wrong.

2189
01:18:23,533 --> 01:18:27,243
It's just at the moment we're very generically returning a failure template

2190
01:18:27,603 --> 01:18:28,772
instead of something more precise.

2191
01:18:29,085 --> 01:18:31,596
But if I know that the user hasn't given me their name,

2192
01:18:31,726 --> 01:18:31,806
well,

2193
01:18:31,846 --> 01:18:33,485
let me say that error message.

2194
01:18:33,565 --> 01:18:34,076
So let's

2195
01:18:34,286 --> 01:18:37,875
actually get rid of these two lines and be a little more specific like this.

2196
01:18:38,166 --> 01:18:38,956
So if,

2197
01:18:39,125 --> 01:18:40,956
or how about let's do it like this,

2198
01:18:40,965 --> 01:18:43,916
how about validate the user's name first?

2199
01:18:44,005 --> 01:18:45,425
So name equals request.

2200
01:18:45,726 --> 01:18:47,286
form.get quote unquote name.

2201
01:18:47,485 --> 01:18:49,886
That just gives me a variable containing the user's name.

2202
01:18:50,410 --> 01:18:52,089
If they didn't give me a name,

2203
01:18:52,209 --> 01:18:56,040
which I can express with just if not name like if name is blank or none,

2204
01:18:56,330 --> 01:19:00,669
then let me go ahead and return render template of that error template,

2205
01:19:00,729 --> 01:19:03,040
but let's pass in a specific message like

2206
01:19:03,529 --> 01:19:04,919
missing name.

2207
01:19:05,169 --> 01:19:09,560
And so by passing in another argument to this template called messages,

2208
01:19:09,729 --> 01:19:13,370
I can trust that flask will dynamically output that message

2209
01:19:13,370 --> 01:19:16,279
where I tell it to using the old curly braces.

2210
01:19:16,490 --> 01:19:16,890
Meanwhile,

2211
01:19:17,009 --> 01:19:19,770
let's go ahead and validate not just the name but validate.

2212
01:19:20,319 --> 01:19:20,680
Uh,

2213
01:19:20,720 --> 01:19:21,430
sport.

2214
01:19:21,600 --> 01:19:23,120
I can do this in a couple of ways.

2215
01:19:23,160 --> 01:19:23,640
Let's do this.

2216
01:19:23,759 --> 01:19:25,359
So sport equals request.

2217
01:19:25,640 --> 01:19:27,549
form.ge quote unquote sport.

2218
01:19:27,839 --> 01:19:28,669
Then in here,

2219
01:19:28,720 --> 01:19:30,629
let's say if there's no sport,

2220
01:19:31,169 --> 01:19:34,790
go ahead and return render template quote unquote error.

2221
01:19:36,890 --> 01:19:38,069
HTML message equals

2222
01:19:38,520 --> 01:19:39,459
missing sport,

2223
01:19:39,560 --> 01:19:42,220
so quite like name but we can be more specific now too.

2224
01:19:42,479 --> 01:19:44,330
If the sport they did give me

2225
01:19:44,600 --> 01:19:47,390
is not in the global sports list,

2226
01:19:47,520 --> 01:19:49,560
well then it's Kelly trying to register for.

2227
01:19:49,689 --> 01:19:50,279
Volleyball again,

2228
01:19:50,359 --> 01:19:53,020
so let's return render template of error.

2229
01:19:53,310 --> 01:19:53,919
HTML,

2230
01:19:54,000 --> 01:19:55,640
but this time the message shall be

2231
01:19:56,040 --> 01:19:58,629
invalid sport or something like that.

2232
01:19:58,759 --> 01:20:00,020
So we're being ever more clear,

2233
01:20:00,029 --> 01:20:03,120
otherwise they are presumably confirmed

2234
01:20:03,450 --> 01:20:05,149
because we got this far logically.

2235
01:20:05,399 --> 01:20:07,069
So if I go back to the other browser tab,

2236
01:20:07,240 --> 01:20:08,390
go back to the form,

2237
01:20:08,879 --> 01:20:11,720
and let's go ahead and type in no name and just click register.

2238
01:20:13,319 --> 01:20:13,970
OK,

2239
01:20:14,290 --> 01:20:15,890
what did I do wrong accidentally?

2240
01:20:15,970 --> 01:20:18,319
So let's go back to VS code.

2241
01:20:18,529 --> 01:20:19,520
Open my terminal,

2242
01:20:19,609 --> 01:20:22,279
open the first terminal window where flaskun is running,

2243
01:20:22,770 --> 01:20:24,899
encountered unknown tag body.

2244
01:20:25,169 --> 01:20:27,370
So I did something stupid in error.

2245
01:20:27,569 --> 01:20:28,240
HTML.

2246
01:20:28,810 --> 01:20:30,020
So let's go into error.

2247
01:20:30,169 --> 01:20:30,959
HTML

2248
01:20:31,470 --> 01:20:32,470
and

2249
01:20:35,620 --> 01:20:35,640
uh black.

2250
01:20:35,649 --> 01:20:36,080
Oh,

2251
01:20:36,330 --> 01:20:37,080
it's subtle.

2252
01:20:39,060 --> 01:20:40,279
I just transposed the words.

2253
01:20:40,370 --> 01:20:42,000
It's supposed to be block body.

2254
01:20:42,250 --> 01:20:42,689
That was dumb.

2255
01:20:42,890 --> 01:20:43,279
All right,

2256
01:20:43,609 --> 01:20:44,479
block body.

2257
01:20:44,689 --> 01:20:45,529
I think that's correct.

2258
01:20:45,689 --> 01:20:47,000
So let's go back to the browser.

2259
01:20:47,169 --> 01:20:47,950
Let's reload.

2260
01:20:48,129 --> 01:20:51,689
It's prompting me to reconfirm that I want to submit the exact same form,

2261
01:20:51,770 --> 01:20:53,680
which recall had no name and no spore,

2262
01:20:53,899 --> 01:20:56,120
but now I see an error in a good way.

2263
01:20:56,209 --> 01:20:56,879
This is not

2264
01:20:57,250 --> 01:20:58,410
a server error.

2265
01:20:58,450 --> 01:21:00,049
This is my error missing name.

2266
01:21:00,129 --> 01:21:01,569
Now it's not super user friendly,

2267
01:21:01,649 --> 01:21:02,569
but it's at least more explained.

2268
01:21:03,009 --> 01:21:04,359
then you are not registered.

2269
01:21:04,529 --> 01:21:04,689
All right,

2270
01:21:04,700 --> 01:21:05,240
let's go back.

2271
01:21:05,330 --> 01:21:06,040
Let's give it a name,

2272
01:21:06,089 --> 01:21:07,870
but no sport register

2273
01:21:08,759 --> 01:21:09,450
ah missing sport.

2274
01:21:09,569 --> 01:21:10,319
Let's go back.

2275
01:21:10,580 --> 01:21:10,660
Uh,

2276
01:21:10,810 --> 01:21:14,490
let's go ahead and give it a sport but uh

2277
01:21:14,899 --> 01:21:17,509
a sport but no name missing name as before.

2278
01:21:17,569 --> 01:21:19,209
And if I took the time to actually hack the

2279
01:21:19,209 --> 01:21:21,609
HTML and do what Kelly did before and add volleyball,

2280
01:21:21,770 --> 01:21:23,959
it would similarly say invalid sports

2281
01:21:24,209 --> 01:21:26,220
in this case too because it's not in

2282
01:21:26,529 --> 01:21:27,490
that same list.

2283
01:21:28,750 --> 01:21:29,259
All right.

2284
01:21:30,140 --> 01:21:31,529
Questions on

2285
01:21:31,779 --> 01:21:32,810
this technique.

2286
01:21:34,419 --> 01:21:34,660
All right,

2287
01:21:34,740 --> 01:21:34,819
well,

2288
01:21:34,859 --> 01:21:36,859
it's all fun and good to have a registration site that does this,

2289
01:21:36,870 --> 01:21:38,850
but it's literally just throwing out the information.

2290
01:21:38,939 --> 01:21:41,540
And what I did like years ago was actually even cut

2291
01:21:41,540 --> 01:21:43,700
a corner initially where I think I wrote code that just

2292
01:21:43,700 --> 01:21:47,220
sent an automatic email to the proctor running fro IMs containing

2293
01:21:47,220 --> 01:21:49,490
the person's name and the sport for which they registered,

2294
01:21:49,620 --> 01:21:54,459
but that was very quickly replaced by a better feature which is actually store the.

2295
01:21:54,540 --> 01:21:58,560
Data in the server itself and keep track of it rather than just send it off via email.

2296
01:21:58,729 --> 01:22:01,290
So let's do a first pass at actually storing

2297
01:22:01,290 --> 01:22:04,009
information on everyone who is registered for sports.

2298
01:22:04,169 --> 01:22:04,229
Well,

2299
01:22:04,490 --> 01:22:06,890
let me go up here and let me create another global variable

2300
01:22:06,890 --> 01:22:10,879
to make my life easier here called registrants and set this equal to

2301
01:22:11,040 --> 01:22:12,839
curly brace close curly brace.

2302
01:22:13,049 --> 01:22:14,979
What do these two characters represent

2303
01:22:15,370 --> 01:22:16,069
if empty,

2304
01:22:16,290 --> 01:22:16,810
especially?

2305
01:22:18,229 --> 01:22:19,720
What data type is this?

2306
01:22:20,649 --> 01:22:21,290
It's a dictionary,

2307
01:22:21,359 --> 01:22:22,669
so it's a Python dict,

2308
01:22:22,839 --> 01:22:26,399
so you could similarly say dict explicitly open closed,

2309
01:22:26,439 --> 01:22:29,120
but it's more pythonic generally to just use two curly braces.

2310
01:22:29,279 --> 01:22:30,879
This is just giving me an empty dictionary.

2311
01:22:30,959 --> 01:22:31,310
Why?

2312
01:22:31,479 --> 01:22:31,520
Well,

2313
01:22:31,600 --> 01:22:34,279
I want to store the two things I'm still collecting about all

2314
01:22:34,279 --> 01:22:37,160
of the students their name and the sport for which they registered.

2315
01:22:37,240 --> 01:22:37,419
So.

2316
01:22:38,080 --> 01:22:39,669
value name sport.

2317
01:22:39,799 --> 01:22:41,200
So how can I go about doing this?

2318
01:22:41,240 --> 01:22:41,549
Well,

2319
01:22:41,799 --> 01:22:44,629
it's pretty trivial down here in my register function,

2320
01:22:44,660 --> 01:22:48,479
recall that I'm just kind of naively saying you're registered even

2321
01:22:48,479 --> 01:22:50,669
though I'm not doing anything with their name or sport,

2322
01:22:50,720 --> 01:22:51,709
but that's easy.

2323
01:22:51,970 --> 01:22:54,399
Let's remember the student for real now.

2324
01:22:55,000 --> 01:22:56,839
So in that registrants

2325
01:22:57,020 --> 01:22:58,689
uh uh dictionary,

2326
01:22:58,899 --> 01:23:02,950
let's go ahead and index into it using the student's name David or Kelly

2327
01:23:02,950 --> 01:23:06,970
or whoever and set that equal to the sport for which they registered.

2328
01:23:07,100 --> 01:23:10,830
And now notice the name is coming as before from request.form.get.

2329
01:23:11,390 --> 01:23:15,040
For is similarly coming from that function and so this is just remembering

2330
01:23:15,209 --> 01:23:16,629
that key value pair

2331
01:23:17,169 --> 01:23:21,319
so that's all fine and good it's in the computer's memory how do we actually see it?

2332
01:23:21,450 --> 01:23:21,500
Well,

2333
01:23:21,569 --> 01:23:23,560
wouldn't it be nice after you register

2334
01:23:23,810 --> 01:23:27,359
if you could see the actual registrants of the website,

2335
01:23:27,490 --> 01:23:27,770
um.

2336
01:23:28,259 --> 01:23:28,459
Uh,

2337
01:23:28,589 --> 01:23:30,459
certainly if you're the proctor trying to run the sports,

2338
01:23:30,540 --> 01:23:30,770
well,

2339
01:23:30,779 --> 01:23:31,189
yes,

2340
01:23:31,339 --> 01:23:36,620
so let's go down here and let's create another route like slash registrants,

2341
01:23:36,740 --> 01:23:39,129
which is just gonna give me a list of everyone who's registered.

2342
01:23:39,259 --> 01:23:41,100
Let's define a function called registrants,

2343
01:23:41,180 --> 01:23:42,529
so I could call it anything I want,

2344
01:23:42,669 --> 01:23:44,149
and this one's gonna be relatively simple.

2345
01:23:44,430 --> 01:23:46,100
Render a template

2346
01:23:46,450 --> 01:23:47,779
called registrants,

2347
01:23:47,790 --> 01:23:48,979
which will soon exist

2348
01:23:49,189 --> 01:23:51,540
and pass in all of the registrants

2349
01:23:51,790 --> 01:23:52,549
that are in

2350
01:23:52,870 --> 01:23:54,379
that global dictionary

2351
01:23:54,509 --> 01:23:57,299
and again I can call this placeholder anything I want,

2352
01:23:57,350 --> 01:23:59,029
but insofar as it contains the registrants,

2353
01:23:59,069 --> 01:24:00,509
I'm setting registrants equal to.

2354
01:24:01,020 --> 01:24:03,160
The registrants Global dictionary.

2355
01:24:03,649 --> 01:24:07,629
So let's go now into my terminal window and create registrants.

2356
01:24:07,810 --> 01:24:08,600
HTML

2357
01:24:08,770 --> 01:24:11,850
and create really the beginnings of an actual Frosh IM's

2358
01:24:11,850 --> 01:24:14,899
website that's gonna show the proctor who has now registered.

2359
01:24:15,009 --> 01:24:15,890
So let me go.

2360
01:24:16,319 --> 01:24:19,080
Into this terminal and do code of registrants.

2361
01:24:19,189 --> 01:24:21,109
HTML and close the terminal.

2362
01:24:21,310 --> 01:24:23,770
Let's try to get this right finally extends

2363
01:24:24,109 --> 01:24:24,919
layout.

2364
01:24:25,270 --> 01:24:26,729
HTML close quote,

2365
01:24:26,990 --> 01:24:27,339
uh,

2366
01:24:27,350 --> 01:24:28,580
close bracket there.

2367
01:24:28,910 --> 01:24:32,580
Then let's do block body in the right order,

2368
01:24:32,870 --> 01:24:34,109
then end block.

2369
01:24:34,270 --> 01:24:38,279
Down here and then inside of the block here this is gonna be a bit more of a mouthful,

2370
01:24:38,299 --> 01:24:40,290
but let's use some of our HTML from last week.

2371
01:24:40,419 --> 01:24:42,390
We'll give an H1 tag that says registrants

2372
01:24:42,390 --> 01:24:44,049
so the proctor knows what they're looking at.

2373
01:24:44,220 --> 01:24:45,470
Then let's put this in a table,

2374
01:24:45,500 --> 01:24:45,899
for instance,

2375
01:24:45,979 --> 01:24:46,810
with two columns,

2376
01:24:46,819 --> 01:24:48,009
names and sports.

2377
01:24:48,180 --> 01:24:52,160
So tabletag followed by a T head tag for the table heading,

2378
01:24:52,500 --> 01:24:52,729
uh,

2379
01:24:52,779 --> 01:24:55,819
then that heading is gonna contain just a single row for TR

2380
01:24:56,100 --> 01:24:58,379
and each of those has a TH table heading.

2381
01:24:58,819 --> 01:24:59,029
Uh,

2382
01:24:59,180 --> 01:24:59,629
one of which,

2383
01:24:59,770 --> 01:25:00,810
and actually I'll make it tighter,

2384
01:25:00,899 --> 01:25:01,529
is name,

2385
01:25:01,779 --> 01:25:03,379
the other of which is going to be sport.

2386
01:25:03,459 --> 01:25:04,939
So these are the column headings,

2387
01:25:05,060 --> 01:25:06,100
the table headings,

2388
01:25:06,220 --> 01:25:07,569
TH tags for short.

2389
01:25:07,939 --> 01:25:09,299
After the head of the table,

2390
01:25:09,379 --> 01:25:12,169
let's go ahead and do a T body for table body

2391
01:25:12,379 --> 01:25:15,810
and inside of here this is where ginja comes in use.

2392
01:25:16,020 --> 01:25:20,660
I can say for each name in the registrant's placeholder that was plugged in.

2393
01:25:21,120 --> 01:25:22,629
And for proactively,

2394
01:25:22,669 --> 01:25:24,299
what do I want to do on each iteration?

2395
01:25:24,470 --> 01:25:24,509
Well,

2396
01:25:24,560 --> 01:25:26,000
I think I want to output table row,

2397
01:25:26,149 --> 01:25:27,339
table row table row,

2398
01:25:27,629 --> 01:25:29,189
and in here I can do TR

2399
01:25:29,669 --> 01:25:32,620
and then inside of that a table data for the cell on the left,

2400
01:25:32,870 --> 01:25:35,620
putting in the student's name which is coming from

2401
01:25:35,910 --> 01:25:37,660
this for loop just like in Python,

2402
01:25:37,779 --> 01:25:39,220
and then one more table data,

2403
01:25:39,459 --> 01:25:40,939
namely the registrants,

2404
01:25:41,029 --> 01:25:41,669
uh,

2405
01:25:41,870 --> 01:25:45,310
placeholder indexed into at that name which because it's a

2406
01:25:45,310 --> 01:25:48,709
dictionary will give me the sport for that student's name.

2407
01:25:49,250 --> 01:25:51,109
And then I think we're good to go.

2408
01:25:51,240 --> 01:25:51,600
And in fact,

2409
01:25:51,640 --> 01:25:54,950
just to hark back to something I said last week when we were imagining,

2410
01:25:55,080 --> 01:25:57,439
actually this isn't week 5 when we were talking about stacks and like

2411
01:25:57,439 --> 01:26:00,600
your Gmail or Outlook inbox is essentially a stack with the newest emails

2412
01:26:00,600 --> 01:26:03,560
on top and I hypothesized at the time that it's just row after

2413
01:26:03,560 --> 01:26:06,950
row after row after row when we started talking last week about HTML.

2414
01:26:07,399 --> 01:26:10,600
Here is what Google and Microsoft and others are probably doing anytime.

2415
01:26:10,792 --> 01:26:12,953
You have tabular information in a page.

2416
01:26:13,103 --> 01:26:15,812
They've got some data in memory like the registrants,

2417
01:26:15,842 --> 01:26:19,263
and they're just using code like this in Jinja to output table row,

2418
01:26:19,422 --> 01:26:19,823
table row,

2419
01:26:19,982 --> 01:26:20,513
table row.

2420
01:26:20,632 --> 01:26:22,252
Imagine this is your email instead,

2421
01:26:22,542 --> 01:26:23,333
same exact

2422
01:26:23,583 --> 01:26:23,933
idea.

2423
01:26:23,942 --> 01:26:25,453
And now we have the ability

2424
01:26:25,623 --> 01:26:27,212
to express that kind of logic.

2425
01:26:27,422 --> 01:26:30,853
So let's go back now into the browser,

2426
01:26:31,303 --> 01:26:32,283
click reload on the

2427
01:26:32,465 --> 01:26:35,956
Let's register for instance David for basketball.

2428
01:26:36,386 --> 01:26:37,315
Click register.

2429
01:26:37,605 --> 01:26:38,795
It claims I'm registered,

2430
01:26:38,925 --> 01:26:41,476
but hopefully now I'm legitimately registered

2431
01:26:41,925 --> 01:26:44,235
because that variable is storing it in memory.

2432
01:26:44,366 --> 01:26:44,806
And in fact,

2433
01:26:44,925 --> 01:26:48,076
let's go ahead and go now to not slash register,

2434
01:26:48,445 --> 01:26:51,275
but I'll zoom in at the top registrants

2435
01:26:51,605 --> 01:26:52,516
and hit enter,

2436
01:26:52,706 --> 01:26:53,726
and we will see a very.

2437
01:26:54,240 --> 01:26:54,879
Ugly

2438
01:26:55,160 --> 01:26:59,040
but functional HTML table containing two columns name and sport,

2439
01:26:59,080 --> 01:27:02,589
the so-called T head in which David and basketball are present.

2440
01:27:02,799 --> 01:27:03,359
Moreover,

2441
01:27:03,479 --> 01:27:06,830
if we now go back to that form and let's try registering Kelly,

2442
01:27:06,839 --> 01:27:07,350
for instance,

2443
01:27:07,359 --> 01:27:08,149
for soccer,

2444
01:27:08,279 --> 01:27:09,390
click register.

2445
01:27:09,720 --> 01:27:12,270
Now let's manually go to registrants again.

2446
01:27:12,520 --> 01:27:14,830
Now Kelly and David are in

2447
01:27:15,339 --> 01:27:17,270
the server's memory as well.

2448
01:27:18,930 --> 01:27:20,250
Questions then

2449
01:27:20,609 --> 01:27:22,160
on what this example

2450
01:27:22,810 --> 01:27:24,200
is now doing or how

2451
01:27:24,729 --> 01:27:26,479
it's achieving these results,

2452
01:27:26,729 --> 01:27:27,009
yeah.

2453
01:27:30,089 --> 01:27:30,689
Really good question.

2454
01:27:30,729 --> 01:27:33,850
If you wanted to restrict the registrants page to only certain people,

2455
01:27:33,899 --> 01:27:35,439
ideally you would have a password on it.

2456
01:27:35,770 --> 01:27:37,490
And in fact one of the next examples we'll do in

2457
01:27:37,490 --> 01:27:40,609
a few minutes is a login page for exactly that reason.

2458
01:27:40,689 --> 01:27:42,609
Right now just sort of on the honor system that

2459
01:27:42,609 --> 01:27:45,200
only the proctor in question goes to this URL.

2460
01:27:45,490 --> 01:27:48,160
But just for the sake of discussion actually,

2461
01:27:48,549 --> 01:27:50,810
suppose that you did want the registration list to be public,

2462
01:27:50,890 --> 01:27:53,319
if only to like hype up who has already registered.

2463
01:27:53,529 --> 01:27:53,779
Well,

2464
01:27:53,930 --> 01:27:57,069
it's not good to just tell people go to the slash reg.

2465
01:27:57,495 --> 01:27:58,104
URL,

2466
01:27:58,214 --> 01:28:00,415
we can actually link them to that in a few different ways.

2467
01:28:00,455 --> 01:28:01,325
So for instance,

2468
01:28:01,575 --> 01:28:06,964
I can go down to uh how about uh let's say success.

2469
01:28:07,305 --> 01:28:07,765
HTML.

2470
01:28:07,854 --> 01:28:09,265
So let me open up success.

2471
01:28:09,544 --> 01:28:10,185
HTML.

2472
01:28:10,575 --> 01:28:11,854
It just says you are registered.

2473
01:28:11,895 --> 01:28:13,165
I can do something like this

2474
01:28:13,535 --> 01:28:17,915
um A HF equals slash registrants.

2475
01:28:18,015 --> 01:28:20,515
So I have control now over my HTML and the routes,

2476
01:28:20,535 --> 01:28:22,205
so slash registrants will exist.

2477
01:28:23,325 --> 01:28:24,325
uh see who.

2478
01:28:25,410 --> 01:28:26,879
ET registered,

2479
01:28:27,209 --> 01:28:27,569
period.

2480
01:28:27,850 --> 01:28:31,209
So this will create a nice little HTML link that links me to that route.

2481
01:28:31,330 --> 01:28:32,200
So let's try this.

2482
01:28:32,450 --> 01:28:33,799
So let's go back to the form

2483
01:28:34,410 --> 01:28:35,080
over here.

2484
01:28:35,410 --> 01:28:35,680
Uh,

2485
01:28:35,689 --> 01:28:38,979
let's go ahead and register John for Ultimate Frisbee.

2486
01:28:39,330 --> 01:28:40,709
And register.

2487
01:28:41,120 --> 01:28:41,319
All right.

2488
01:28:41,359 --> 01:28:42,560
And now we see you are registered.

2489
01:28:42,640 --> 01:28:43,549
See who else registered.

2490
01:28:43,560 --> 01:28:44,490
And if I hover over this,

2491
01:28:44,520 --> 01:28:45,229
it's super small,

2492
01:28:45,319 --> 01:28:47,509
but it would have showed me in the bottom left corner at the link.

2493
01:28:47,759 --> 01:28:50,669
And indeed here now is John at the bottom of this table.

2494
01:28:50,720 --> 01:28:51,359
And just to be clear,

2495
01:28:51,399 --> 01:28:53,189
if I view page source on the browser,

2496
01:28:53,359 --> 01:28:58,270
you see all of the TRs that we dynamically generated on the server side

2497
01:28:58,759 --> 01:29:00,069
before they were sent as such

2498
01:29:00,479 --> 01:29:00,910
to

2499
01:29:01,080 --> 01:29:01,799
the browser.

2500
01:29:02,560 --> 01:29:02,870
All right,

2501
01:29:03,109 --> 01:29:05,950
what if we wanted to do something slightly more elegant here?

2502
01:29:06,069 --> 01:29:06,189
Well,

2503
01:29:06,430 --> 01:29:08,279
I don't have to just use this HTML hack.

2504
01:29:08,310 --> 01:29:08,540
Like,

2505
01:29:08,790 --> 01:29:11,540
why don't I just show the user who has registered automatically,

2506
01:29:11,549 --> 01:29:12,859
and this is kind of a cool feature

2507
01:29:13,229 --> 01:29:14,899
of web apps as well.

2508
01:29:15,109 --> 01:29:17,069
In addition to importing Flask,

2509
01:29:17,080 --> 01:29:17,740
render template,

2510
01:29:17,750 --> 01:29:18,419
and request,

2511
01:29:18,589 --> 01:29:20,390
I'm going to also import a function called

2512
01:29:20,390 --> 01:29:23,279
Redirect that comes with Flask and indeed.

2513
01:29:23,596 --> 01:29:25,675
Rather than just show success.

2514
01:29:25,875 --> 01:29:26,585
HTML,

2515
01:29:26,875 --> 01:29:28,916
I'm going to go ahead and return the

2516
01:29:28,916 --> 01:29:32,715
result of redirecting the user to slash registrants.

2517
01:29:32,755 --> 01:29:33,315
So to be clear,

2518
01:29:33,425 --> 01:29:37,556
I'm in my register route and instead of showing them the success page anymore,

2519
01:29:37,636 --> 01:29:39,065
which I might as well delete at this point,

2520
01:29:39,195 --> 01:29:42,346
I'm just going to redirect them to this list of everyone who is registered,

2521
01:29:42,675 --> 01:29:43,585
including themselves.

2522
01:29:43,715 --> 01:29:44,476
So if I go back over.

2523
01:29:44,571 --> 01:29:46,762
Here and type in someone like Doug who maybe

2524
01:29:46,762 --> 01:29:49,432
will play basketball with me and click register.

2525
01:29:49,642 --> 01:29:52,751
Watch what happens to the URL at the very top of the screen.

2526
01:29:53,041 --> 01:29:57,551
I'm automatically whisked away to registrants in this case.

2527
01:29:58,041 --> 01:29:59,242
I made a change to the code though,

2528
01:29:59,341 --> 01:30:01,562
and so the server actually was smart enough to reload.

2529
01:30:01,642 --> 01:30:04,361
So Doug is now the only one in the database,

2530
01:30:04,372 --> 01:30:05,401
and this actually hints at.

2531
01:30:05,990 --> 01:30:07,310
A problem we should really solve.

2532
01:30:07,430 --> 01:30:07,549
Like,

2533
01:30:07,560 --> 01:30:07,819
in fact,

2534
01:30:07,910 --> 01:30:09,029
let's do this real fast.

2535
01:30:09,109 --> 01:30:10,629
Let me go ahead and register myself again

2536
01:30:10,629 --> 01:30:12,830
for basketball register now it's Doug and David.

2537
01:30:13,069 --> 01:30:16,259
The catch though is if this server ever goes offline,

2538
01:30:16,310 --> 01:30:19,750
maybe because it needs to be updated or it crashes or.

2539
01:30:20,069 --> 01:30:21,100
It reboots

2540
01:30:21,500 --> 01:30:24,009
when you hit control C and get back to your terminal.

2541
01:30:24,089 --> 01:30:25,970
Flask server is no longer running,

2542
01:30:26,060 --> 01:30:30,100
which means that global variable called registrants in all caps is gone.

2543
01:30:30,180 --> 01:30:32,259
It's like free the memory has been freed.

2544
01:30:32,339 --> 01:30:34,609
So if I were to rerun flask now,

2545
01:30:34,740 --> 01:30:37,419
as would happen automatically if the server itself rebooted.

2546
01:30:37,720 --> 01:30:37,779
Well,

2547
01:30:37,839 --> 01:30:40,029
this is not great because if I go back to

2548
01:30:40,189 --> 01:30:42,029
the registrant's page and click reload,

2549
01:30:42,319 --> 01:30:44,560
no one has registered and in fact that's what happened with

2550
01:30:44,560 --> 01:30:47,240
Doug a moment ago because I changed my actual app.ie.

2551
01:30:47,479 --> 01:30:48,839
Flask was smart enough to realize,

2552
01:30:48,939 --> 01:30:49,200
oh wait,

2553
01:30:49,240 --> 01:30:49,879
the code has changed.

2554
01:30:49,919 --> 01:30:51,350
I better reload the program

2555
01:30:51,600 --> 01:30:54,810
which gave me a brand new version of that global.

2556
01:30:56,290 --> 01:30:57,189
Dictionary.

2557
01:30:57,529 --> 01:31:01,129
So what would be better clearly than storing registrants in

2558
01:31:01,609 --> 01:31:03,149
memory in RAM

2559
01:31:03,890 --> 01:31:05,279
in a variable in the server.

2560
01:31:06,770 --> 01:31:07,089
Yeah.

2561
01:31:08,229 --> 01:31:08,419
Yeah,

2562
01:31:08,580 --> 01:31:11,299
so in an actual database and so here's to where

2563
01:31:11,299 --> 01:31:13,339
everything kind of comes full circle and connects again.

2564
01:31:13,459 --> 01:31:16,580
So let me go back into A.ie here.

2565
01:31:17,049 --> 01:31:19,430
And I like generally the logic of what I've done.

2566
01:31:19,600 --> 01:31:20,959
I don't like the fact that I'm just

2567
01:31:20,959 --> 01:31:24,450
storing my registrants inside of this global variable,

2568
01:31:24,470 --> 01:31:27,200
which is again just in the computer's volatile memory.

2569
01:31:27,379 --> 01:31:30,060
Let's actually put this in a database instead.

2570
01:31:30,279 --> 01:31:32,720
So let me go up here and get rid of this global

2571
01:31:32,720 --> 01:31:35,910
dictionary and let me do something a little smarter up here.

2572
01:31:36,000 --> 01:31:39,080
Let me import from CS 50's own library the SQL.

2573
01:31:39,189 --> 01:31:40,899
Function that we've used before and again,

2574
01:31:41,009 --> 01:31:44,020
even though we've been taking off all almost all of CS 50's training wheels,

2575
01:31:44,100 --> 01:31:47,569
the reality is using CS50's SQL library even through final

2576
01:31:47,569 --> 01:31:50,540
projects just makes using SQL and Python so much easier.

2577
01:31:50,589 --> 01:31:52,890
But there's certainly third party libraries you can use.

2578
01:31:53,500 --> 01:31:53,540
Um,

2579
01:31:53,700 --> 01:31:56,379
let me go down now and in addition to creating my app,

2580
01:31:56,540 --> 01:31:57,560
let's create a database,

2581
01:31:57,680 --> 01:31:58,609
DB for short,

2582
01:31:58,819 --> 01:32:01,140
setting that equal to SQL light and then SQL Light.

2583
01:32:01,439 --> 01:32:02,939
And slash,

2584
01:32:03,120 --> 01:32:04,129
which is not a typo,

2585
01:32:04,359 --> 01:32:07,589
and let's assume that the database shall be called froshimMs.db.

2586
01:32:07,879 --> 01:32:09,029
More on that in a moment.

2587
01:32:09,279 --> 01:32:10,589
And then down here,

2588
01:32:10,839 --> 01:32:13,020
now that I have a database variable,

2589
01:32:13,240 --> 01:32:16,350
let's not remember the student by storing them in this dictionary.

2590
01:32:16,439 --> 01:32:18,640
Let's actually execute a line of SQL.

2591
01:32:18,919 --> 01:32:21,229
So dB.execute,

2592
01:32:21,600 --> 01:32:22,390
insert

2593
01:32:22,620 --> 01:32:23,319
into.

2594
01:32:23,740 --> 01:32:23,930
Well,

2595
01:32:24,009 --> 01:32:24,330
wait a minute,

2596
01:32:24,370 --> 01:32:25,879
what am I going to insert them into?

2597
01:32:26,049 --> 01:32:26,450
Not to worry,

2598
01:32:26,560 --> 01:32:27,410
I came prepared for this,

2599
01:32:27,490 --> 01:32:29,799
so let me go ahead and maximize my terminal window

2600
01:32:29,799 --> 01:32:33,439
and then run SQLite 3 of a file called FroshIMs.db.

2601
01:32:33,770 --> 01:32:35,279
And this is a file I made in advance,

2602
01:32:35,290 --> 01:32:36,120
but it's super simple.

2603
01:32:36,209 --> 01:32:36,410
In fact,

2604
01:32:36,490 --> 01:32:37,009
if I type

2605
01:32:37,859 --> 01:32:40,399
schema just to see the design of this database,

2606
01:32:40,490 --> 01:32:42,720
you'll see that in advance I created a table

2607
01:32:42,930 --> 01:32:45,040
in this database called registrants.

2608
01:32:45,069 --> 01:32:46,770
It has a column called ID.

2609
01:32:46,959 --> 01:32:51,220
A column called name and a column called sport and the primary key of this table

2610
01:32:51,470 --> 01:32:52,970
is to use the ID value,

2611
01:32:52,979 --> 01:32:54,160
which is just an integer.

2612
01:32:54,229 --> 01:32:56,220
And now notice I have some constraints here.

2613
01:32:56,430 --> 01:32:59,310
I want the user to give me a name and a sport,

2614
01:32:59,350 --> 01:33:00,950
so I've specified that it's not just text,

2615
01:33:01,029 --> 01:33:01,990
it's not null.

2616
01:33:02,109 --> 01:33:05,270
That is null value should not be possible to put in here.

2617
01:33:05,589 --> 01:33:05,830
All right,

2618
01:33:05,870 --> 01:33:08,379
so let me go ahead and exit out of SQLite 3.

2619
01:33:08,589 --> 01:33:10,029
Let me go back into.

2620
01:33:10,649 --> 01:33:10,930
Uh,

2621
01:33:10,970 --> 01:33:13,919
my code editor here and now I know what to insert into.

2622
01:33:14,049 --> 01:33:16,279
Insert into the table called registrants.

2623
01:33:16,290 --> 01:33:16,680
What?

2624
01:33:16,850 --> 01:33:16,970
Well,

2625
01:33:17,089 --> 01:33:19,290
I want to insert how about a name of

2626
01:33:19,290 --> 01:33:21,759
the student and the sport for which they registered,

2627
01:33:21,890 --> 01:33:26,649
and the values therefore that I want to insert are going to be whatever they came

2628
01:33:26,970 --> 01:33:28,399
from the post request.

2629
01:33:28,649 --> 01:33:31,850
Here's where you do not want to make yourself vulnerable to SQL injection attacks.

2630
01:33:31,890 --> 01:33:33,120
No F strings in here,

2631
01:33:33,209 --> 01:33:33,850
no just plugging.

2632
01:33:33,953 --> 01:33:35,612
Students input in blindly.

2633
01:33:35,823 --> 01:33:38,833
This is where and why we use these placeholders in both

2634
01:33:38,833 --> 01:33:42,132
CS 50's library and in many libraries in the real world

2635
01:33:42,422 --> 01:33:43,823
to specify that I want

2636
01:33:44,172 --> 01:33:47,623
the library to properly sanitize the user's input and get rid

2637
01:33:47,623 --> 01:33:51,772
of any scary characters like apostrophes or semicolons or the like.

2638
01:33:52,062 --> 01:33:54,333
So I'm going to pass in name and sport,

2639
01:33:54,522 --> 01:33:56,732
and this one line has the effect of,

2640
01:33:56,783 --> 01:33:57,223
as you recommend.

2641
01:33:57,366 --> 01:34:01,625
It's storing the registration in an actual database on the server,

2642
01:34:01,875 --> 01:34:03,306
not just in volatile

2643
01:34:03,565 --> 01:34:04,585
temporary memory,

2644
01:34:04,715 --> 01:34:06,465
but we do have to change one thing.

2645
01:34:06,715 --> 01:34:09,516
This line here is no longer valid because there's no global

2646
01:34:09,516 --> 01:34:12,366
variable there via which we can get all of the registrants,

2647
01:34:12,445 --> 01:34:13,545
but that's no big deal.

2648
01:34:13,715 --> 01:34:15,386
Here's how most web apps would do this.

2649
01:34:15,476 --> 01:34:20,636
I'm going to define a variable called registrants and set it equal to DB execute.

2650
01:34:21,419 --> 01:34:24,459
Of select star from registrants.

2651
01:34:24,470 --> 01:34:26,939
It's as easy as that to just get all of the registrants from

2652
01:34:26,939 --> 01:34:30,779
my database and down here there's no longer an all capitalized variable,

2653
01:34:30,790 --> 01:34:33,419
but there is a lowercase one registrants.

2654
01:34:33,540 --> 01:34:34,290
So to be clear,

2655
01:34:34,379 --> 01:34:35,689
in my register route,

2656
01:34:35,979 --> 01:34:38,129
I am inserting the user into the database

2657
01:34:38,129 --> 01:34:41,020
and in my registrants route I am selecting the

2658
01:34:41,020 --> 01:34:44,569
users from the database and then the rest of the code I think can stay the same.

2659
01:34:44,620 --> 01:34:46,810
So let's go back to Fresh AMs here.

2660
01:34:47,419 --> 01:34:48,299
Go back to the form.

2661
01:34:48,419 --> 01:34:50,609
Let's register David for basketball,

2662
01:34:50,660 --> 01:34:51,520
register.

2663
01:34:52,180 --> 01:34:52,569
Ah,

2664
01:34:52,779 --> 01:34:53,660
I did screw up.

2665
01:34:54,390 --> 01:34:55,609
You're seeing some weirdness here.

2666
01:34:55,689 --> 01:34:56,890
What are you actually seeing?

2667
01:34:57,589 --> 01:34:58,939
There's one user registered.

2668
01:34:59,899 --> 01:35:00,890
Not intentional,

2669
01:35:01,140 --> 01:35:03,209
but what does this syntax suggest we're looking at?

2670
01:35:03,990 --> 01:35:04,859
This is a dictionary.

2671
01:35:04,899 --> 01:35:07,979
Recall that the dB.execute method that comes with CS 50

2672
01:35:07,979 --> 01:35:11,660
SQL library gives you a list of dictionary objects.

2673
01:35:11,700 --> 01:35:13,700
And so because there's only one registrant at the moment,

2674
01:35:13,740 --> 01:35:16,390
you're seeing my dictionary for my registration,

2675
01:35:16,459 --> 01:35:19,020
which is not what I want to show here and I forgot.

2676
01:35:19,060 --> 01:35:23,459
I need to also go back into the registrants templates

2677
01:35:23,859 --> 01:35:26,339
to tweak my syntax as follows.

2678
01:35:26,419 --> 01:35:28,379
Let me go back into VS code here.

2679
01:35:28,950 --> 01:35:30,180
Let me go into registrants.

2680
01:35:30,339 --> 01:35:31,160
HTML

2681
01:35:31,500 --> 01:35:32,129
and

2682
01:35:32,740 --> 01:35:37,779
because I am passing in now not a dictionary but a list of dictionaries,

2683
01:35:37,939 --> 01:35:40,459
I just need to think about the problem a little bit differently.

2684
01:35:40,540 --> 01:35:42,209
So my syntax here is gonna be

2685
01:35:42,500 --> 01:35:43,270
for each,

2686
01:35:43,339 --> 01:35:43,810
uh,

2687
01:35:43,819 --> 01:35:45,529
let's do this as follows.

2688
01:35:47,500 --> 01:35:49,439
For each registrant.

2689
01:35:50,569 --> 01:35:53,899
In that registrant's list of dictionaries,

2690
01:35:54,250 --> 01:35:55,689
go ahead and display

2691
01:35:55,970 --> 01:35:57,560
the current registrant's

2692
01:35:57,930 --> 01:35:58,640
name

2693
01:35:58,970 --> 01:36:04,049
and go ahead and display the current registrant's sports.

2694
01:36:04,169 --> 01:36:04,649
In other words,

2695
01:36:04,689 --> 01:36:05,930
I'm using Python syntax,

2696
01:36:05,970 --> 01:36:07,839
which works as well in Gina here.

2697
01:36:08,169 --> 01:36:10,250
This iterates over the list of registrants,

2698
01:36:10,330 --> 01:36:11,439
each of which is a dictionary,

2699
01:36:11,529 --> 01:36:13,990
so I'm using dictionary syndex now to index

2700
01:36:13,990 --> 01:36:17,220
into the name key of the registrant dict object

2701
01:36:17,370 --> 01:36:18,359
and the sport key

2702
01:36:18,649 --> 01:36:19,569
of the same.

2703
01:36:20,160 --> 01:36:20,939
So

2704
01:36:21,399 --> 01:36:23,669
now let me go back to my browser

2705
01:36:24,160 --> 01:36:26,029
and I'm just gonna go ahead and reload

2706
01:36:26,029 --> 01:36:28,390
the registrants page without resubmitting the form.

2707
01:36:28,720 --> 01:36:29,549
Now there it is,

2708
01:36:29,560 --> 01:36:30,589
David and basketball.

2709
01:36:30,680 --> 01:36:33,049
And now let's go back to the form and register a couple more people.

2710
01:36:33,319 --> 01:36:35,430
Kelly for soccer register.

2711
01:36:35,680 --> 01:36:37,109
Notice we're at the registrants link.

2712
01:36:37,290 --> 01:36:38,640
Kelly is indeed still registered.

2713
01:36:38,740 --> 01:36:42,270
Let me go back to this and let's register John Ultimate Frisbee,

2714
01:36:42,479 --> 01:36:43,060
register.

2715
01:36:43,160 --> 01:36:44,479
Let's go ahead and

2716
01:36:44,839 --> 01:36:48,069
kill the flask server by going to my first terminal window,

2717
01:36:48,459 --> 01:36:48,779
uh,

2718
01:36:48,879 --> 01:36:49,520
control C.

2719
01:36:49,939 --> 01:36:52,490
And now let me go ahead and rerun Flask,

2720
01:36:52,529 --> 01:36:53,680
which was bad before.

2721
01:36:53,890 --> 01:36:56,089
That's how Doug ended up the only registrant last time.

2722
01:36:56,169 --> 01:37:00,290
But this time if I go back to the registrants page and immediately click reload,

2723
01:37:00,330 --> 01:37:02,720
even though the servers running anew in memory,

2724
01:37:02,890 --> 01:37:04,390
the database is persistent,

2725
01:37:04,450 --> 01:37:08,580
which was the whole point of using SQL from week 7

2726
01:37:08,850 --> 01:37:09,589
onward.

2727
01:37:09,770 --> 01:37:11,250
And let's do one more for good measure.

2728
01:37:11,290 --> 01:37:12,490
If I go back to the form,

2729
01:37:12,569 --> 01:37:15,720
we'll register Doug so he can play basketball with me too,

2730
01:37:16,009 --> 01:37:17,890
and we even have Doug now in the database.

2731
01:37:17,910 --> 01:37:19,040
It's an ugly looking table,

2732
01:37:19,129 --> 01:37:19,520
but

2733
01:37:19,779 --> 01:37:20,950
The data is in fact

2734
01:37:21,120 --> 01:37:22,160
all there.

2735
01:37:23,740 --> 01:37:24,020
All right,

2736
01:37:24,189 --> 01:37:25,250
questions now

2737
01:37:25,859 --> 01:37:27,419
on this improvement,

2738
01:37:27,580 --> 01:37:31,729
which is getting closer and closer to what the actual Fros AM's database did,

2739
01:37:32,129 --> 01:37:32,839
uh,

2740
01:37:32,859 --> 01:37:33,500
website did

2741
01:37:33,939 --> 01:37:35,810
so many years ago.

2742
01:37:38,040 --> 01:37:38,350
All right,

2743
01:37:38,470 --> 01:37:38,600
well,

2744
01:37:38,629 --> 01:37:39,870
let me propose this now.

2745
01:37:39,950 --> 01:37:41,830
We have this table of registrants.

2746
01:37:41,950 --> 01:37:46,029
Suppose that um maybe uh Kelly was not a

2747
01:37:46,029 --> 01:37:48,830
very sportsman like when she played soccer last time,

2748
01:37:48,910 --> 01:37:51,470
so we want to deregister Kelly from soccer.

2749
01:37:51,509 --> 01:37:51,790
That is,

2750
01:37:51,830 --> 01:37:51,990
no,

2751
01:37:52,029 --> 01:37:53,580
we're going to reject your registration.

2752
01:37:53,709 --> 01:37:53,910
Let's.

2753
01:37:54,055 --> 01:37:55,595
For a moment about the design here,

2754
01:37:55,604 --> 01:37:59,234
like here's an HTML table containing names and sports,

2755
01:37:59,274 --> 01:38:00,805
and wouldn't it be nice if we could add a button

2756
01:38:00,805 --> 01:38:04,354
that would let me deregister Kelly or anyone for that matter.

2757
01:38:04,604 --> 01:38:06,165
When I click on that button,

2758
01:38:06,404 --> 01:38:10,015
what information should ideally be sent from the browser to the server

2759
01:38:10,604 --> 01:38:12,944
to remove someone like Kelly from the database?

2760
01:38:14,439 --> 01:38:14,669
Yeah,

2761
01:38:14,790 --> 01:38:17,779
the ID of the person and you're proposing ID instead of name.

2762
01:38:17,830 --> 01:38:18,459
Why?

2763
01:38:19,129 --> 01:38:20,479
I need to be identified.

2764
01:38:22,720 --> 01:38:22,729
Exactly,

2765
01:38:23,390 --> 01:38:26,540
the ID uniquely identifies the user in the SQL table.

2766
01:38:26,629 --> 01:38:26,910
So in fact,

2767
01:38:26,990 --> 01:38:27,879
let's see this real quick.

2768
01:38:27,990 --> 01:38:31,939
If I go back to VS code and we'll revisit essentially a week 7 issue here,

2769
01:38:32,109 --> 01:38:34,149
let me go back into my second terminal where I

2770
01:38:34,149 --> 01:38:37,540
can again run SQLite 3 after maximizing my terminal.

2771
01:38:37,830 --> 01:38:39,120
And before I just wrote.

2772
01:38:39,140 --> 01:38:41,379
schema to see what the table is,

2773
01:38:41,629 --> 01:38:46,140
now I'm going to literally run selectar from registrants in SQLite 3

2774
01:38:46,350 --> 01:38:50,500
and we'll see a little Askiar table of all 4 of us who registered,

2775
01:38:50,509 --> 01:38:51,399
but we also see.

2776
01:38:51,456 --> 01:38:53,806
Unique ID and the value of the unique ID recall

2777
01:38:53,806 --> 01:38:56,366
from week 7 is that it's the so-called primary key.

2778
01:38:56,405 --> 01:39:00,755
It is the value that uniquely identifies users as minimally as possible,

2779
01:39:00,766 --> 01:39:04,085
and that's a good thing because if we have another Kelly registering for Frosh IMs,

2780
01:39:04,206 --> 01:39:07,085
we don't want to deregister the wrong Kelly or both Kelly's.

2781
01:39:07,125 --> 01:39:10,675
We want only though Kelly with ID of 2.

2782
01:39:10,965 --> 01:39:13,076
So somehow the button we add

2783
01:39:13,405 --> 01:39:18,456
to the registrant's page should contain in it the ID of the person we want to delete,

2784
01:39:18,465 --> 01:39:20,136
because if you do pass the ID.

2785
01:39:20,301 --> 01:39:23,352
D of the person that you want to delete to the server,

2786
01:39:23,372 --> 01:39:26,301
the server can do some kind of select looking or some

2787
01:39:26,301 --> 01:39:30,162
kind of delete statement using that ID number and delete just

2788
01:39:30,492 --> 01:39:31,571
that row.

2789
01:39:31,941 --> 01:39:33,932
So there's a few ways we can do this,

2790
01:39:34,021 --> 01:39:35,892
but let me propose that we proceed

2791
01:39:36,202 --> 01:39:37,222
as follows.

2792
01:39:37,231 --> 01:39:38,861
In our registrants route,

2793
01:39:39,102 --> 01:39:41,731
which is where we can currently see all of these users,

2794
01:39:41,941 --> 01:39:46,211
let's go ahead and output an ugly but functional form for each of those users.

2795
01:39:46,421 --> 01:39:48,782
So let me go ahead and minimize this.

2796
01:39:49,259 --> 01:39:50,660
On hide my terminal window

2797
01:39:50,910 --> 01:39:51,939
and in registrants,

2798
01:39:51,950 --> 01:39:54,419
let's go ahead and just do this.

2799
01:39:54,790 --> 01:39:57,580
In addition to outputting every registrant's name in sport,

2800
01:39:57,750 --> 01:40:02,979
let's also output a third column whose purpose in life is to contain an HTML form.

2801
01:40:03,109 --> 01:40:06,299
The action of that form will be a route like de-register,

2802
01:40:06,589 --> 01:40:10,189
and the method we're gonna use is going to be post just so that we don't.

2803
01:40:10,290 --> 01:40:11,470
Accidentally store

2804
01:40:12,200 --> 01:40:14,669
personally identifying information in a URL or such.

2805
01:40:14,959 --> 01:40:17,310
This form is going to have a button,

2806
01:40:17,680 --> 01:40:19,509
the type of which is submit,

2807
01:40:19,640 --> 01:40:22,350
and the button is going to say deregister,

2808
01:40:22,560 --> 01:40:25,160
and I could now implement the ID in a couple of ways.

2809
01:40:25,200 --> 01:40:26,890
I could do input,

2810
01:40:27,290 --> 01:40:29,229
name equals ID,

2811
01:40:29,600 --> 01:40:31,430
type equals text,

2812
01:40:32,000 --> 01:40:35,080
and now if I go back to my other browser tab and reload,

2813
01:40:35,160 --> 01:40:38,200
I should see a button for every one of these registrants.

2814
01:40:38,669 --> 01:40:39,390
And I do,

2815
01:40:39,520 --> 01:40:42,080
but this is kind of like the honor system where I just let

2816
01:40:42,080 --> 01:40:44,799
the user type in the ID of who they want to delete,

2817
01:40:44,810 --> 01:40:47,229
and it's sort of weird that I have multiple forms in that case,

2818
01:40:47,439 --> 01:40:50,600
but here is where dynamically generating HTML can get pretty.

2819
01:40:51,060 --> 01:40:51,870
Uh,

2820
01:40:51,939 --> 01:40:52,609
useful.

2821
01:40:52,859 --> 01:40:55,660
Let's change the type of this input to hidden

2822
01:40:56,140 --> 01:40:56,609
and

2823
01:40:56,859 --> 01:40:58,450
set the value of this

2824
01:40:58,890 --> 01:40:59,649
uh input

2825
01:40:59,819 --> 01:41:00,569
to be

2826
01:41:00,819 --> 01:41:03,729
whatever the current registrant's ID

2827
01:41:04,100 --> 01:41:05,609
actually is,

2828
01:41:06,189 --> 01:41:06,250
uh,

2829
01:41:06,270 --> 01:41:09,970
storing this in here and let's go ahead and not confuse this,

2830
01:41:10,250 --> 01:41:12,740
so we'll use single quotes on the outside instead.

2831
01:41:13,169 --> 01:41:15,589
So inside of this value,

2832
01:41:15,629 --> 01:41:17,819
I'm putting the current user's ID.

2833
01:41:17,870 --> 01:41:19,140
So if I go back now,

2834
01:41:19,350 --> 01:41:21,069
notice that the text boxes are going to disappear,

2835
01:41:21,109 --> 01:41:22,379
but the buttons will not.

2836
01:41:22,870 --> 01:41:23,290
But

2837
01:41:23,470 --> 01:41:24,899
all of that information is still there.

2838
01:41:24,950 --> 01:41:27,669
If I right click or control click and open up my developer,

2839
01:41:27,830 --> 01:41:27,890
uh,

2840
01:41:27,990 --> 01:41:29,069
let's open up View page source.

2841
01:41:29,330 --> 01:41:30,470
It's just a bit bigger.

2842
01:41:30,759 --> 01:41:33,120
Notice that David and Kelly and John and everyone

2843
01:41:33,120 --> 01:41:35,919
else here has the same HTML as before,

2844
01:41:36,000 --> 01:41:38,629
plus another column containing a form

2845
01:41:38,799 --> 01:41:39,479
that contains,

2846
01:41:39,600 --> 01:41:39,790
oh,

2847
01:41:40,040 --> 01:41:41,709
I somehow messed up still.

2848
01:41:42,319 --> 01:41:43,689
Why is this blank?

2849
01:41:43,799 --> 01:41:45,399
So this is still not good.

2850
01:41:50,290 --> 01:41:51,490
Ah,

2851
01:41:51,589 --> 01:41:51,939
thank you.

2852
01:41:52,040 --> 01:41:53,609
I accidentally pluralized this,

2853
01:41:53,689 --> 01:41:56,609
but it should be registrant because I'm inside of this for

2854
01:41:56,609 --> 01:41:59,850
loop and each iteration gives me a variable called registrant.

2855
01:41:59,910 --> 01:42:01,259
So user error on my part.

2856
01:42:01,490 --> 01:42:03,200
So let's go ahead and dramatically do this again.

2857
01:42:03,450 --> 01:42:05,250
Let me view page source of the same page,

2858
01:42:05,290 --> 01:42:06,250
scroll down a bit.

2859
01:42:06,529 --> 01:42:11,859
Thankfully there is now for every one of these registrants a hidden ID.

2860
01:42:11,984 --> 01:42:12,955
1 for me,

2861
01:42:13,084 --> 01:42:13,915
2 for Kelly,

2862
01:42:13,924 --> 01:42:15,015
and I bet if we keep scrolling,

2863
01:42:15,044 --> 01:42:17,564
we'll see 3 for John and 4 for Doug.

2864
01:42:17,805 --> 01:42:21,615
So now this form has enough information even though there's no user input other

2865
01:42:21,615 --> 01:42:25,794
than the clicking of the button to tell the server whom to delete.

2866
01:42:25,995 --> 01:42:30,055
So how do we delete the user from that particular registration table?

2867
01:42:30,125 --> 01:42:30,515
Well,

2868
01:42:30,685 --> 01:42:32,004
I think we just need to add a route.

2869
01:42:32,205 --> 01:42:33,634
So let me go back into

2870
01:42:34,200 --> 01:42:35,189
VS code here

2871
01:42:35,479 --> 01:42:36,799
into app.ie

2872
01:42:37,240 --> 01:42:38,919
and let's go ahead and create another route,

2873
01:42:39,000 --> 01:42:39,589
for instance,

2874
01:42:39,640 --> 01:42:39,990
uh,

2875
01:42:40,000 --> 01:42:40,709
in here,

2876
01:42:41,200 --> 01:42:41,560
say,

2877
01:42:41,919 --> 01:42:42,390
uh,

2878
01:42:42,520 --> 01:42:43,870
we'll put it up here below

2879
01:42:44,200 --> 01:42:45,629
uh up here below index,

2880
01:42:45,770 --> 01:42:49,319
so app.route slash deregister,

2881
01:42:49,560 --> 01:42:49,919
whoops,

2882
01:42:50,000 --> 01:42:50,879
deregister.

2883
01:42:51,299 --> 01:42:52,319
And now de

2884
01:42:52,529 --> 01:42:53,479
de register,

2885
01:42:53,529 --> 01:42:54,959
but I could call it anything I want

2886
01:42:55,169 --> 01:42:55,930
and how do I do this?

2887
01:42:56,020 --> 01:42:56,100
Well,

2888
01:42:56,169 --> 01:43:01,959
let's first get the ID from the form ID equals request.form.ge quote unquote ID.

2889
01:43:02,129 --> 01:43:03,560
Let's do a bit of a sanity check here.

2890
01:43:03,649 --> 01:43:05,450
So if there is an ID,

2891
01:43:05,459 --> 01:43:07,509
and it's not blank for some reason,

2892
01:43:07,810 --> 01:43:10,439
go ahead and do dB.execute,

2893
01:43:10,810 --> 01:43:15,569
delete from registrants where ID equals.

2894
01:43:16,089 --> 01:43:16,310
Uh,

2895
01:43:16,370 --> 01:43:20,220
question mark and now let's pass in the user's actual ID

2896
01:43:20,490 --> 01:43:21,120
and then

2897
01:43:21,330 --> 01:43:21,930
no matter what,

2898
01:43:22,009 --> 01:43:24,520
let's go ahead and redirect the user back to the

2899
01:43:24,810 --> 01:43:28,120
registrant's page so that we can hopefully see the result

2900
01:43:28,529 --> 01:43:29,589
of that change.

2901
01:43:29,930 --> 01:43:30,209
So again,

2902
01:43:30,310 --> 01:43:32,600
I'm just using a bit of SQL per week 7.

2903
01:43:32,689 --> 01:43:34,850
I'm using a placeholder by using the question mark

2904
01:43:34,850 --> 01:43:36,450
passing in the actual ID from the form,

2905
01:43:36,459 --> 01:43:39,009
and I'm only doing this if there is an ID that was

2906
01:43:39,009 --> 01:43:42,649
passed in and I'm letting the database actually do the deletion.

2907
01:43:43,169 --> 01:43:43,290
All right,

2908
01:43:43,410 --> 01:43:44,250
so let's try to do this.

2909
01:43:44,330 --> 01:43:46,160
Let's go back to the browser here,

2910
01:43:46,450 --> 01:43:48,640
reload the slash registrants page for good measure.

2911
01:43:48,850 --> 01:43:52,319
Let's decree that Kelly is now deregistered by clicking this button,

2912
01:43:52,850 --> 01:43:53,479
and oh,

2913
01:43:53,490 --> 01:43:54,129
so close.

2914
01:43:55,169 --> 01:43:56,299
Method not

2915
01:43:56,629 --> 01:43:57,339
allowed

2916
01:43:58,029 --> 01:44:00,370
at the deregister route.

2917
01:44:00,759 --> 01:44:01,740
What did I do wrong?

2918
01:44:04,629 --> 01:44:05,879
Let me go back to the code.

2919
01:44:06,189 --> 01:44:08,259
What's wrong with my deregister route?

2920
01:44:11,160 --> 01:44:11,350
Well,

2921
01:44:11,390 --> 01:44:12,660
what method is the form using?

2922
01:44:12,750 --> 01:44:13,919
If I go back to registrants.

2923
01:44:14,069 --> 01:44:14,700
HTML,

2924
01:44:14,870 --> 01:44:17,259
the the form is using post.

2925
01:44:18,189 --> 01:44:18,500
Yeah,

2926
01:44:18,620 --> 01:44:20,069
so I need to override the default,

2927
01:44:20,100 --> 01:44:20,669
which is get,

2928
01:44:20,700 --> 01:44:23,660
so I need to go up here again and just change an argument to be

2929
01:44:23,660 --> 01:44:28,979
methods equals and then in a list containing only post now instead of get.

2930
01:44:29,089 --> 01:44:29,180
All right,

2931
01:44:29,259 --> 01:44:33,169
let's go back to the form and go back and now let's try to deregister Kelly.

2932
01:44:33,479 --> 01:44:33,990
She's gone.

2933
01:44:34,259 --> 01:44:35,450
Let's get rid of me now.

2934
01:44:35,660 --> 01:44:36,270
I'm gone.

2935
01:44:36,459 --> 01:44:38,410
And indeed if I go back to VS code,

2936
01:44:38,580 --> 01:44:39,689
open my terminal,

2937
01:44:39,939 --> 01:44:40,850
maximize it,

2938
01:44:41,020 --> 01:44:43,609
and select star from registrants again,

2939
01:44:43,779 --> 01:44:46,259
you'll see that the two of us are indeed.

2940
01:44:46,839 --> 01:44:48,250
Gone in this case.

2941
01:44:49,500 --> 01:44:50,410
Questions now

2942
01:44:51,160 --> 01:44:53,509
On this technique because now we have most of the

2943
01:44:53,509 --> 01:44:56,069
plumbing in place for adding people to a database,

2944
01:44:56,109 --> 01:44:58,470
deleting people from a database it's very similar in spirit

2945
01:44:58,470 --> 01:45:00,459
now to most any website that has this kind of

2946
01:45:01,029 --> 01:45:02,390
interactivity.

2947
01:45:04,709 --> 01:45:04,870
All right,

2948
01:45:05,069 --> 01:45:05,979
subtle question.

2949
01:45:06,270 --> 01:45:09,640
I deliberately in my

2950
01:45:09,870 --> 01:45:10,359
registrants.

2951
01:45:10,509 --> 01:45:11,540
HTML file

2952
01:45:11,910 --> 01:45:12,859
uh used

2953
01:45:13,270 --> 01:45:13,669
post,

2954
01:45:13,870 --> 01:45:17,540
as we just discovered instead of get why though?

2955
01:45:17,830 --> 01:45:20,950
Because it wasn't that strong an argument that I hinted at

2956
01:45:20,950 --> 01:45:23,229
earlier of like oh I don't want like Kelly's ID to

2957
01:45:23,229 --> 01:45:26,270
end up in my URL bar or mine like IDs are

2958
01:45:26,270 --> 01:45:30,180
not really personally identifiable they're just opaque integers at the moment.

2959
01:45:31,140 --> 01:45:35,990
But why would it be bad if you could delete people by using the get method?

2960
01:45:37,859 --> 01:45:39,479
So this is kind of subtle,

2961
01:45:39,689 --> 01:45:44,850
but the catch with using get is that by definition you can visit that resource,

2962
01:45:44,930 --> 01:45:48,790
that route by just typing in a URL or following a hyperlink.

2963
01:45:48,890 --> 01:45:50,000
So for instance,

2964
01:45:50,250 --> 01:45:50,740
if

2965
01:45:50,970 --> 01:45:57,140
an adversary were to type a URL like slash registrants question mark ID equals oh,

2966
01:45:57,209 --> 01:45:57,919
I don't know.

2967
01:45:58,390 --> 01:45:58,620
Uh,

2968
01:45:58,830 --> 01:46:03,410
4 and then send me this URL in an email or send this

2969
01:46:03,410 --> 01:46:06,819
URL in an email to the proctor who's running the Frosh IMs program.

2970
01:46:06,990 --> 01:46:11,819
If that Proctor simply clicks naively on this link as my code is implemented now

2971
01:46:12,069 --> 01:46:13,750
and I've used get instead of post,

2972
01:46:13,830 --> 01:46:14,660
what's going to happen?

2973
01:46:17,209 --> 01:46:21,680
Doug gets deregistered just because the proctor followed a link in their email,

2974
01:46:21,729 --> 01:46:24,759
and this is hinting at the kinds of phishing attacks that are possible too.

2975
01:46:25,089 --> 01:46:25,959
Bad design,

2976
01:46:25,970 --> 01:46:28,850
like generally when you are using get requests,

2977
01:46:28,970 --> 01:46:32,439
that is just simple URLs that are clickable or typable,

2978
01:46:32,569 --> 01:46:36,160
they should not have the effect of changing data on the server.

2979
01:46:36,410 --> 01:46:38,799
Post is much better if only because

2980
01:46:39,009 --> 01:46:43,089
you can't just click a link and post happens to induce a post request,

2981
01:46:43,129 --> 01:46:44,850
you almost always have to click a button.

2982
01:46:45,129 --> 01:46:47,770
So at least this case the proctor would receive an email.

2983
01:46:47,830 --> 01:46:49,500
They would have to receive an email,

2984
01:46:49,569 --> 01:46:50,359
click on a link,

2985
01:46:50,490 --> 01:46:52,080
and then they would see a web page like this

2986
01:46:52,080 --> 01:46:55,120
that clearly has a button label deregister or the like,

2987
01:46:55,330 --> 01:46:57,890
which is an additional layer of protection.

2988
01:46:57,899 --> 01:47:01,370
And there's even more tax that you can wage by supporting get.

2989
01:47:01,609 --> 01:47:04,970
So in general post requests are preferred any time

2990
01:47:04,970 --> 01:47:09,129
there's anything remotely personally identifiable or remotely destructive,

2991
01:47:09,149 --> 01:47:10,839
like actually changing data

2992
01:47:11,129 --> 01:47:12,890
on the database like this.

2993
01:47:13,470 --> 01:47:13,479
Alright,

2994
01:47:14,299 --> 01:47:14,379
well,

2995
01:47:14,459 --> 01:47:18,770
what more can or should we do with Frosh IMs perhaps?

2996
01:47:19,060 --> 01:47:19,100
Well,

2997
01:47:19,180 --> 01:47:19,560
let's see,

2998
01:47:19,620 --> 01:47:22,479
maybe one or so final flourishes here.

2999
01:47:22,759 --> 01:47:23,069
Um,

3000
01:47:23,080 --> 01:47:27,370
if I want to go ahead and maybe make those error messages a little more interesting,

3001
01:47:27,500 --> 01:47:28,700
let's do that for just a second.

3002
01:47:28,740 --> 01:47:29,859
Let me go back to.

3003
01:47:30,270 --> 01:47:30,729
Uh,

3004
01:47:30,850 --> 01:47:31,680
my

3005
01:47:32,000 --> 01:47:33,160
other browser tab here,

3006
01:47:33,330 --> 01:47:36,080
let's go back to the registration page where the form is,

3007
01:47:36,140 --> 01:47:38,770
and let's deliberately not cooperate and just click register

3008
01:47:38,770 --> 01:47:40,500
so that I get an error about missing name.

3009
01:47:40,729 --> 01:47:40,850
Well,

3010
01:47:40,970 --> 01:47:42,490
wouldn't it be nice if we made this a little more

3011
01:47:42,490 --> 01:47:44,890
user friendly by including like an image on the page,

3012
01:47:44,970 --> 01:47:46,089
as is commonly the case?

3013
01:47:46,100 --> 01:47:46,180
Well,

3014
01:47:46,209 --> 01:47:49,600
we can certainly include images and websites using the image tag,

3015
01:47:49,770 --> 01:47:53,359
but the catch is we actually have to be a little more clever about

3016
01:47:53,359 --> 01:47:57,040
how we store the image on the server in order for this to work.

3017
01:47:57,129 --> 01:47:58,080
So for instance,

3018
01:47:58,290 --> 01:47:59,680
let me go into that error page.

3019
01:47:59,734 --> 01:48:01,955
We don't need success open anymore.

3020
01:48:02,245 --> 01:48:05,194
We don't need layouts anymore or this index anymore.

3021
01:48:05,254 --> 01:48:07,915
Let's focus on error and suppose that I did want to include

3022
01:48:07,915 --> 01:48:11,395
an an error message containing like a grumpy cat on the screen.

3023
01:48:11,564 --> 01:48:11,645
Well,

3024
01:48:11,685 --> 01:48:14,955
ideally I would just do alt or I would do open bracket image,

3025
01:48:15,435 --> 01:48:15,555
uh,

3026
01:48:15,725 --> 01:48:16,714
source equals,

3027
01:48:16,745 --> 01:48:20,524
and then something like cat.jpeg where cat.jpeg is the

3028
01:48:20,524 --> 01:48:23,234
name of a cat in this current folder.

3029
01:48:23,245 --> 01:48:24,234
And just to be clear,

3030
01:48:24,444 --> 01:48:26,645
let's have an alternative text of grumpy

3031
01:48:26,645 --> 01:48:29,205
cat for screen readers or slow connections.

3032
01:48:30,140 --> 01:48:30,720
OK,

3033
01:48:30,850 --> 01:48:32,799
this unfortunately is not going to work.

3034
01:48:32,930 --> 01:48:34,970
Let's go over here and induce the same error

3035
01:48:34,970 --> 01:48:37,319
by just reloading and submitting the same form,

3036
01:48:37,529 --> 01:48:41,040
and you'll see indeed a broken image because that image that cat.

3037
01:48:41,209 --> 01:48:42,479
JPEG does not exist,

3038
01:48:42,729 --> 01:48:44,759
but we do at least see the alternative text.

3039
01:48:44,930 --> 01:48:45,049
Well,

3040
01:48:45,169 --> 01:48:48,580
I did come prepared with a cat already and so let me go.

3041
01:48:48,865 --> 01:48:49,145
and

3042
01:48:49,365 --> 01:48:51,455
grab this cat from another folder,

3043
01:48:51,665 --> 01:48:54,015
and this cat is going to contain,

3044
01:48:54,104 --> 01:48:54,294
uh,

3045
01:48:54,305 --> 01:48:57,384
is going to exist in a file called cat.jpeg and indeed if

3046
01:48:57,384 --> 01:49:00,305
I type LS now after having grabbed a copy of that cat,

3047
01:49:00,544 --> 01:49:03,515
it exists alongside A.ie seems good.

3048
01:49:03,705 --> 01:49:05,174
Let's go back to the browser here.

3049
01:49:05,345 --> 01:49:06,984
Let's reload and we should see.

3050
01:49:08,040 --> 01:49:08,560
Oh,

3051
01:49:08,799 --> 01:49:09,479
still no cat.

3052
01:49:09,669 --> 01:49:09,750
Well,

3053
01:49:09,830 --> 01:49:10,350
why is this?

3054
01:49:10,470 --> 01:49:10,549
Well,

3055
01:49:10,629 --> 01:49:12,620
this is a side effect of using the framework as well.

3056
01:49:12,759 --> 01:49:14,700
It turns out for organizational sake,

3057
01:49:14,910 --> 01:49:18,029
any images you want to display on a page or any CSS

3058
01:49:18,029 --> 01:49:20,339
files or JavaScript files that you want to embed in a page,

3059
01:49:20,350 --> 01:49:24,160
if they're static assets should actually be in a folder called static,

3060
01:49:24,220 --> 01:49:25,950
and by static that just means unchanging.

3061
01:49:26,069 --> 01:49:29,520
You or someone else wrote them once and they're not dynamic in the way that app.ie.

3062
01:49:29,634 --> 01:49:34,455
So I'm actually going to use my MV command and move cat.jpeg into the static folder.

3063
01:49:34,665 --> 01:49:34,895
Indeed,

3064
01:49:34,904 --> 01:49:35,825
if I type LS now,

3065
01:49:36,024 --> 01:49:36,634
CA is gone,

3066
01:49:36,785 --> 01:49:38,415
but it is in the static folder.

3067
01:49:38,584 --> 01:49:40,375
And now if I go back over here,

3068
01:49:40,665 --> 01:49:41,694
I think we'll be good,

3069
01:49:41,754 --> 01:49:43,464
except that I do need to go into error.

3070
01:49:43,625 --> 01:49:44,334
HTML

3071
01:49:44,544 --> 01:49:46,794
and say that the source of this image is actually in

3072
01:49:47,194 --> 01:49:51,134
static scat.jpeg to make clear it's in that folder.

3073
01:49:51,544 --> 01:49:53,895
And so indeed when I now reload the page once more,

3074
01:49:54,185 --> 01:49:58,064
now I see a very grumpy cat at least guiding my error message.

3075
01:49:58,145 --> 01:49:58,575
Oh.

3076
01:49:59,410 --> 01:50:00,680
But there is a difference here,

3077
01:50:00,830 --> 01:50:04,779
even though when accessing the static directory I have to be explicit,

3078
01:50:05,020 --> 01:50:08,859
notice that this whole time we have never once mentioned

3079
01:50:09,109 --> 01:50:10,660
the templates directory.

3080
01:50:10,830 --> 01:50:13,140
The render template function to be clear,

3081
01:50:13,509 --> 01:50:15,310
knows automatically to look in the.

3082
01:50:15,459 --> 01:50:19,330
Templates folder for your template you do not and you should not say

3083
01:50:19,330 --> 01:50:23,080
something like templates here you simply specify the name of the file,

3084
01:50:23,250 --> 01:50:28,120
but in the in the uh HTML template you do actually have to include,

3085
01:50:28,250 --> 01:50:31,330
as I did slash static in the HTML.

3086
01:50:31,890 --> 01:50:31,910
All right,

3087
01:50:32,620 --> 01:50:35,750
let's do one final flourish with the actual code.

3088
01:50:36,069 --> 01:50:36,950
Suppose that

3089
01:50:37,200 --> 01:50:39,549
it's time to modernize and let people register,

3090
01:50:39,560 --> 01:50:41,720
not just for one sport as per the radio buttons,

3091
01:50:41,759 --> 01:50:42,669
but multiple sports.

3092
01:50:42,720 --> 01:50:44,959
It's a little obnoxious to make me go back and fill out my

3093
01:50:44,959 --> 01:50:47,479
name again and again and again if I want to register once,

3094
01:50:47,490 --> 01:50:47,799
twice,

3095
01:50:47,850 --> 01:50:49,229
3 times for sports.

3096
01:50:49,600 --> 01:50:52,220
So why don't we go ahead and in terms of you.

3097
01:50:52,275 --> 01:50:54,496
I changed those radio buttons to checkboxes.

3098
01:50:54,706 --> 01:50:56,186
That's a very easy fix.

3099
01:50:56,266 --> 01:51:00,025
Let me go into my templates folder and into index.

3100
01:51:00,186 --> 01:51:01,695
HTML where this form is.

3101
01:51:01,866 --> 01:51:04,096
And if I want to change radio buttons to checkboxes,

3102
01:51:04,266 --> 01:51:06,255
literally just change radio to checkbox.

3103
01:51:06,465 --> 01:51:08,346
If I go back to the browser here and reload,

3104
01:51:08,386 --> 01:51:10,175
you'll see the familiar checkboxes now,

3105
01:51:10,346 --> 01:51:12,416
which are not mutually exclusive.

3106
01:51:12,662 --> 01:51:14,171
Lets me check multiple ones,

3107
01:51:14,211 --> 01:51:16,481
thereby registering for multiple sports at once,

3108
01:51:16,651 --> 01:51:20,571
but my logic has to change a tiny little bit here whereby if I want

3109
01:51:20,571 --> 01:51:24,001
to go ahead and get all of the sports for which the user is registered,

3110
01:51:24,171 --> 01:51:24,251
well,

3111
01:51:24,262 --> 01:51:26,472
that logic has to change in app.ie.

3112
01:51:26,892 --> 01:51:28,452
So where is my register route?

3113
01:51:28,611 --> 01:51:29,282
Down here,

3114
01:51:29,432 --> 01:51:30,881
and we haven't touched this in a while,

3115
01:51:30,972 --> 01:51:32,892
but recall that the register route here.

3116
01:51:33,490 --> 01:51:34,040
Has

3117
01:51:34,359 --> 01:51:38,600
a validate name chunk of code validate sport chunk of code,

3118
01:51:38,649 --> 01:51:41,200
and we most recently did the insert into

3119
01:51:41,379 --> 01:51:42,839
chunk of code as well.

3120
01:51:43,209 --> 01:51:46,160
But if the user's registering for multiple sports,

3121
01:51:46,250 --> 01:51:48,729
I'm OK with having one row per sport.

3122
01:51:48,955 --> 01:51:50,705
Though I'm sure we could do better than that,

3123
01:51:50,865 --> 01:51:54,055
but how do I iterate over all of the sports that the user gave me?

3124
01:51:54,265 --> 01:51:54,305
Well,

3125
01:51:54,345 --> 01:51:57,095
I need to change my validation code here a little bit.

3126
01:51:57,305 --> 01:51:59,734
If you know the user can select multiple values,

3127
01:51:59,904 --> 01:52:01,254
as with checkboxes,

3128
01:52:01,424 --> 01:52:04,384
you're going to use request.form.getlist.

3129
01:52:04,740 --> 01:52:08,700
And then the name of the uh parameter that you want to get the value of

3130
01:52:08,950 --> 01:52:11,700
and then this is going to give me back a list of values.

3131
01:52:11,870 --> 01:52:14,109
So I'm gonna go ahead and change semantically my code to say

3132
01:52:14,109 --> 01:52:17,979
sports because I'm expecting 0 or more sports now instead of 1.

3133
01:52:18,189 --> 01:52:19,540
So if there are no sports,

3134
01:52:19,549 --> 01:52:22,589
we're gonna just say missing sport heck missing sports.

3135
01:52:22,720 --> 01:52:22,729
Um,

3136
01:52:23,109 --> 01:52:23,819
but then

3137
01:52:24,029 --> 01:52:25,500
I can't simply do this.

3138
01:52:25,669 --> 01:52:26,520
I can't just say,

3139
01:52:26,529 --> 01:52:29,779
is the sport for which the user registered in that array or not

3140
01:52:30,310 --> 01:52:30,660
because

3141
01:52:30,910 --> 01:52:33,180
they might have given me 2 sports or 3.

3142
01:52:33,419 --> 01:52:37,149
So logically I should really check all of the sports that the human

3143
01:52:37,149 --> 01:52:40,680
typed in for me and I should probably do something like this instead.

3144
01:52:41,029 --> 01:52:43,589
So for each sport.

3145
01:52:44,359 --> 01:52:46,970
In the sports that the user typed in,

3146
01:52:47,379 --> 01:52:48,729
go ahead and

3147
01:52:49,279 --> 01:52:50,410
ask the question

3148
01:52:50,740 --> 01:52:52,990
if that sport is not in sports,

3149
01:52:53,060 --> 01:52:54,750
then go ahead and output

3150
01:52:55,060 --> 01:52:56,209
invalid sport.

3151
01:52:56,379 --> 01:52:57,970
So it's just a bit of tedium here.

3152
01:52:58,060 --> 01:52:59,450
We're just adding a bit of logic,

3153
01:52:59,540 --> 01:53:03,620
but this way I'm iterating over every check box that the user checked and making

3154
01:53:03,620 --> 01:53:07,410
sure they didn't do what Kelly did earlier and sort of make up her own sport

3155
01:53:07,609 --> 01:53:09,140
and submit that to me.

3156
01:53:09,569 --> 01:53:11,109
Among all of the others,

3157
01:53:11,359 --> 01:53:13,310
but this now should let me let's try,

3158
01:53:13,560 --> 01:53:14,089
let's reload.

3159
01:53:14,160 --> 01:53:14,350
oh,

3160
01:53:14,359 --> 01:53:17,830
and then actually one other line here we also need to do it down here,

3161
01:53:18,140 --> 01:53:18,589
uh,

3162
01:53:18,600 --> 01:53:21,109
for each sport in sports

3163
01:53:21,479 --> 01:53:23,149
we better execute that line of code

3164
01:53:23,359 --> 01:53:24,290
multiple times.

3165
01:53:24,439 --> 01:53:25,319
So let's see what happens.

3166
01:53:25,419 --> 01:53:27,419
Let's go ahead and register David

3167
01:53:27,919 --> 01:53:30,000
for actually let's see what who's in the database.

3168
01:53:30,180 --> 01:53:31,279
So registrants,

3169
01:53:31,370 --> 01:53:32,439
so we've got John and Doug,

3170
01:53:32,540 --> 01:53:33,290
no David or Kelly.

3171
01:53:33,370 --> 01:53:36,689
So let's reregister David for basketball and soccer click

3172
01:53:36,689 --> 01:53:39,720
register and now I'm indeed registered for both.

3173
01:53:39,930 --> 01:53:40,500
And I

3174
01:53:40,770 --> 01:53:42,680
observed that it's kind of

3175
01:53:43,250 --> 01:53:47,600
bad design that I'm just inserting myself twice into the database.

3176
01:53:47,770 --> 01:53:50,649
So let me go ahead and open up the Fros IMS database one last time.

3177
01:53:50,970 --> 01:53:51,270
Uh,

3178
01:53:51,310 --> 01:53:52,399
let me do a select,

3179
01:53:52,509 --> 01:53:52,740
uh,

3180
01:53:52,750 --> 01:53:55,060
let me do a select star from

3181
01:53:55,310 --> 01:53:56,299
registrants.

3182
01:53:56,430 --> 01:53:58,950
You'll see too that David and David are both there.

3183
01:53:59,009 --> 01:54:00,500
What would be a better design here

3184
01:54:01,310 --> 01:54:02,629
to get rid of the redundancy?

3185
01:54:04,750 --> 01:54:06,950
And to know that I'm the same person ideally.

3186
01:54:08,180 --> 01:54:08,509
Yeah.

3187
01:54:10,279 --> 01:54:10,290
Yeah,

3188
01:54:11,390 --> 01:54:14,080
I should probably have an ID for the the person as well,

3189
01:54:14,100 --> 01:54:16,740
so this is going to complicate it more than we want to play with today,

3190
01:54:16,779 --> 01:54:18,709
but instead of just a registrant's table,

3191
01:54:18,790 --> 01:54:21,270
I should probably have like a student's table that has an

3192
01:54:21,270 --> 01:54:23,660
ID for every student and the name of every student,

3193
01:54:23,779 --> 01:54:28,310
and then change this table as we've seen with the IMDB database and others,

3194
01:54:28,470 --> 01:54:30,790
I should really be storing the IDs of the students,

3195
01:54:30,950 --> 01:54:32,180
the Harvard IDs if you will,

3196
01:54:32,470 --> 01:54:33,790
and not just their names like this.

3197
01:54:33,830 --> 01:54:35,020
So there's room for improvement,

3198
01:54:35,100 --> 01:54:38,229
but the point here is just how we can actually use check boxes and get back.

3199
01:54:38,810 --> 01:54:39,520
Multiple

3200
01:54:39,689 --> 01:54:41,049
items from folks.

3201
01:54:42,089 --> 01:54:42,600
All right.

3202
01:54:44,140 --> 01:54:45,089
That was a lot.

3203
01:54:45,700 --> 01:54:46,680
Questions

3204
01:54:46,939 --> 01:54:48,140
on where we're now at.

3205
01:54:50,890 --> 01:54:51,129
All right,

3206
01:54:51,250 --> 01:54:53,129
to make the coding a little less tedious,

3207
01:54:53,169 --> 01:54:56,799
what we're going to do is look at a few final examples that have sort of come pre-made,

3208
01:54:56,930 --> 01:54:59,729
and we'll walk through the code pointing out only what's different

3209
01:54:59,729 --> 01:55:01,959
as opposed to some of the boilerplate that we keep seeing.

3210
01:55:02,180 --> 01:55:02,259
Um,

3211
01:55:02,450 --> 01:55:04,569
where we left off now recalls that we have App.ie,

3212
01:55:04,609 --> 01:55:06,680
which is all of our logic requirements.text,

3213
01:55:06,689 --> 01:55:09,839
which just enumerates the libraries that we want to use in the project,

3214
01:55:10,089 --> 01:55:10,470
Static,

3215
01:55:10,529 --> 01:55:13,899
which now contains any static files like CATs or JavaScript or CSS,

3216
01:55:14,009 --> 01:55:16,299
and templates which contains our actual templates.

3217
01:55:16,319 --> 01:55:19,370
It's worth noting that we're actually following a fairly common paradigm.

3218
01:55:19,379 --> 01:55:19,770
This is not.

3219
01:55:19,881 --> 01:55:20,981
Specific to flask,

3220
01:55:21,231 --> 01:55:24,032
the model that we've essentially the the paradigm

3221
01:55:24,032 --> 01:55:25,742
that we've essentially been implementing is this.

3222
01:55:25,832 --> 01:55:29,702
If this shape over here represents the human or the user,

3223
01:55:29,992 --> 01:55:33,071
they keep interacting with what the world generally calls a view.

3224
01:55:33,111 --> 01:55:35,912
A view is the term of art that just describes the user interface,

3225
01:55:36,562 --> 01:55:37,071
aka view.

3226
01:55:37,392 --> 01:55:40,242
But that view is generated by a certain type of code,

3227
01:55:40,432 --> 01:55:42,012
namely controller logic.

3228
01:55:42,111 --> 01:55:44,551
So app.ie is technically what the world

3229
01:55:44,551 --> 01:55:47,102
would call controller logic or business logic,

3230
01:55:47,352 --> 01:55:48,461
to use an industry term,

3231
01:55:48,671 --> 01:55:48,872
and that.

3232
01:55:49,034 --> 01:55:49,934
Controller code,

3233
01:55:50,233 --> 01:55:53,264
aka app.ie is generating one or more views.

3234
01:55:53,333 --> 01:55:56,684
So the views that we're referring to here is like everything in your templates.

3235
01:55:56,693 --> 01:55:58,054
Those are your views.

3236
01:55:58,133 --> 01:55:59,574
But there's a third piece of the puzzle that

3237
01:55:59,574 --> 01:56:02,394
we just introduced which is generally called a model,

3238
01:56:02,414 --> 01:56:06,764
and initially my model was just a stupidly simple dictionary in memory,

3239
01:56:06,974 --> 01:56:10,854
and that evolved eventually into Frosh IMs.db. So your model is generally

3240
01:56:10,854 --> 01:56:14,684
your persistent data like where you're storing data related to the application.

3241
01:56:14,894 --> 01:56:16,494
And even though the picture doesn't lend itself

3242
01:56:16,494 --> 01:56:18,003
to pronouncing it in the right order.

3243
01:56:18,166 --> 01:56:22,706
This is what's known as the MVC paradigm model view controller,

3244
01:56:22,916 --> 01:56:26,036
and it's a very common way of developing web apps

3245
01:56:26,036 --> 01:56:28,945
by just thinking about the different problems you need to solve

3246
01:56:29,235 --> 01:56:30,625
with this kind of nomenclature.

3247
01:56:30,636 --> 01:56:33,875
Like I've got to implement my controller which does all of the logic,

3248
01:56:33,916 --> 01:56:34,715
all of the variables,

3249
01:56:34,835 --> 01:56:35,155
functions,

3250
01:56:35,355 --> 01:56:35,715
conditionals,

3251
01:56:35,795 --> 01:56:36,116
loops,

3252
01:56:36,155 --> 01:56:36,866
and so forth.

3253
01:56:37,076 --> 01:56:39,395
I've got to implement the view which contains everything

3254
01:56:39,395 --> 01:56:41,895
the user sees and interacts with like the HTML,

3255
01:56:42,116 --> 01:56:44,395
and I've got to eventually implement the model which is

3256
01:56:44,395 --> 01:56:47,155
like all of the back end data space and such.

3257
01:56:47,720 --> 01:56:48,160
The

3258
01:56:48,450 --> 01:56:51,810
catch though is that this is not a clean line because clearly in views,

3259
01:56:51,890 --> 01:56:52,740
we've seen variables,

3260
01:56:52,850 --> 01:56:53,729
we've seen loops,

3261
01:56:53,870 --> 01:56:55,009
we've seen conditionals,

3262
01:56:55,250 --> 01:56:58,319
so this is just a general mindset to have and then in the real world,

3263
01:56:58,370 --> 01:56:59,040
if you ever

3264
01:56:59,330 --> 01:57:00,859
uh explore web apps again.

3265
01:57:01,390 --> 01:57:03,939
You are henceforth familiar with what's known as this

3266
01:57:04,189 --> 01:57:05,620
MVC model.

3267
01:57:05,870 --> 01:57:08,200
But now let's solve some other real world problems.

3268
01:57:08,350 --> 01:57:10,149
So here's what you see on the occasion

3269
01:57:10,149 --> 01:57:12,390
that you sign into something like Gmail or really

3270
01:57:12,390 --> 01:57:14,350
any other website that asks for a username and

3271
01:57:14,350 --> 01:57:16,339
then eventually a password or some such thing.

3272
01:57:16,509 --> 01:57:17,390
This is just a web form.

3273
01:57:17,430 --> 01:57:19,830
It looks a lot prettier than mine because they're using some fancy

3274
01:57:19,830 --> 01:57:22,750
CSS to make things blue and nicely indented and so forth,

3275
01:57:22,830 --> 01:57:24,390
but it's just HTML underneath the hood.

3276
01:57:24,683 --> 01:57:28,783
with probably an input type equals text to give me this text box.

3277
01:57:29,033 --> 01:57:29,402
Of course,

3278
01:57:29,493 --> 01:57:32,692
when you log into Gmail after providing your password,

3279
01:57:32,913 --> 01:57:35,632
somehow Gmail remembers often for days,

3280
01:57:35,873 --> 01:57:38,263
weeks even that you have logged in already.

3281
01:57:38,473 --> 01:57:40,312
Now how is that actually working?

3282
01:57:40,433 --> 01:57:40,513
Well,

3283
01:57:40,592 --> 01:57:42,913
when you first log into a site like Gmail and

3284
01:57:42,913 --> 01:57:45,183
click submit or the next button in this case,

3285
01:57:45,433 --> 01:57:47,752
presumably the browser is submitting in a

3286
01:57:47,956 --> 01:57:48,436
envelope,

3287
01:57:48,516 --> 01:57:49,105
so to speak,

3288
01:57:49,235 --> 01:57:52,746
a message like this to Google's servers,

3289
01:57:52,755 --> 01:57:55,516
post slash something to accounts.google.com,

3290
01:57:55,556 --> 01:57:58,675
which happens to be the URL that Google typically uses for this.

3291
01:57:58,715 --> 01:57:59,585
And inside of this,

3292
01:58:00,386 --> 01:58:02,755
the is your username and password and anything

3293
01:58:02,755 --> 01:58:04,706
else that might be submitted to the server.

3294
01:58:04,996 --> 01:58:05,585
Ideally,

3295
01:58:05,596 --> 01:58:07,636
the server responds to you with 200 OK,

3296
01:58:07,726 --> 01:58:08,025
like,

3297
01:58:08,076 --> 01:58:08,985
here is your inbox.

3298
01:58:09,036 --> 01:58:09,315
OK,

3299
01:58:09,395 --> 01:58:11,105
you logged in successfully,

3300
01:58:11,585 --> 01:58:11,985
but

3301
01:58:12,235 --> 01:58:13,875
it also underneath the hood.

3302
01:58:14,399 --> 01:58:16,720
Every time you've been logging into Gmail has

3303
01:58:16,720 --> 01:58:19,229
been planting a cookie on your computer,

3304
01:58:19,279 --> 01:58:20,959
and you might be generally familiar with cookies.

3305
01:58:21,040 --> 01:58:22,520
They have kind of a bad rap because they're

3306
01:58:22,520 --> 01:58:25,720
often used and are used quite frequently for tracking,

3307
01:58:25,830 --> 01:58:26,910
for advertising,

3308
01:58:27,439 --> 01:58:29,279
and really kind of keeping eyes on you in some way.

3309
01:58:29,359 --> 01:58:32,160
But in their basic form they're just a feature of HTTP,

3310
01:58:32,240 --> 01:58:33,600
which is wonderfully useful

3311
01:58:33,859 --> 01:58:36,220
because it solves some typical problems.

3312
01:58:36,919 --> 01:58:37,600
This is.

3313
01:58:38,000 --> 01:58:41,270
Another HTTP header that is usually inside of those

3314
01:58:41,270 --> 01:58:43,899
virtual envelopes that come back from servers to browsers.

3315
01:58:44,029 --> 01:58:47,200
In addition to telling the browser what the type of content is in the envelope,

3316
01:58:47,390 --> 01:58:48,350
it might tell the browser,

3317
01:58:48,509 --> 01:58:49,899
Please set the following cookie.

3318
01:58:50,109 --> 01:58:52,339
A cookie is just a key value pair.

3319
01:58:52,549 --> 01:58:56,580
It might be something like session literally equals some value,

3320
01:58:56,790 --> 01:59:01,299
and that value is usually a random string that might be 123456,

3321
01:59:01,310 --> 01:59:02,180
or something like that,

3322
01:59:02,270 --> 01:59:03,750
but it's a unique identifier.

3323
01:59:04,169 --> 01:59:05,359
Or naively,

3324
01:59:05,410 --> 01:59:07,359
if Google implemented cookies poorly,

3325
01:59:07,490 --> 01:59:09,770
they could technically tell your browser to

3326
01:59:09,770 --> 01:59:11,609
store a cookie on your computer containing

3327
01:59:11,609 --> 01:59:15,459
your username and a password so that tomorrow when you open up Gmail,

3328
01:59:15,529 --> 01:59:18,160
you're not prompted again with the stupid form to log in.

3329
01:59:18,370 --> 01:59:20,870
It already knows your browser that you're logged in,

3330
01:59:20,879 --> 01:59:24,520
and your browser can do that by just sending the same cookie it got yesterday

3331
01:59:24,770 --> 01:59:25,560
to the server.

3332
01:59:25,770 --> 01:59:29,569
Now this is bad to use cookies to store usernames and passwords.

3333
01:59:30,169 --> 01:59:32,180
because it's putting very precious data

3334
01:59:32,430 --> 01:59:35,390
in the browser's memory and any sibling or roommate who walks over to your

3335
01:59:35,390 --> 01:59:38,859
browser can now find your username and password by just poking around your cookies.

3336
01:59:39,149 --> 01:59:44,350
So generally what browsers do is more like this screenshot here whereby all the

3337
01:59:44,350 --> 01:59:49,040
server does is it puts a big random value on your computer somewhere,

3338
01:59:49,330 --> 01:59:52,100
essentially a text file containing a big random value,

3339
01:59:52,290 --> 01:59:55,470
and that is equivalent essentially to a sort of a handstamp like if you go.

3340
01:59:55,580 --> 01:59:57,629
To a bar or a club or an amusement park,

3341
01:59:57,770 --> 02:00:01,770
generally you show your ticket once when you go in and then thereafter you just show

3342
02:00:01,770 --> 02:00:04,520
your hand if you want to be able to come and go again and again.

3343
02:00:04,609 --> 02:00:06,879
So right now my hand has not yet been stamped.

3344
02:00:06,930 --> 02:00:09,279
We have this nice little smiley face sticker.

3345
02:00:09,490 --> 02:00:12,970
I might have a smiley face now on my hand any time I want to go back into

3346
02:00:12,970 --> 02:00:15,450
the bar or club or amusement park because they

3347
02:00:15,450 --> 02:00:17,890
now know we already checked who you are,

3348
02:00:18,009 --> 02:00:20,120
presumably the very first time that you came in.

3349
02:00:20,330 --> 02:00:21,330
That's all cookies are.

3350
02:00:21,439 --> 02:00:23,709
Effectively doing is it's putting a virtual hand

3351
02:00:23,709 --> 02:00:26,220
stamp in your browser because the browser,

3352
02:00:26,299 --> 02:00:28,000
the next time you go to Gmail

3353
02:00:28,509 --> 02:00:30,339
and click on a link or click on an email,

3354
02:00:30,470 --> 02:00:31,109
your browser,

3355
02:00:31,149 --> 02:00:32,140
unbeknownst to you,

3356
02:00:32,310 --> 02:00:35,799
will send a get request that looks like this but also contains a line like

3357
02:00:36,189 --> 02:00:37,339
Cookie colon,

3358
02:00:37,470 --> 02:00:39,580
and then that same key value pair.

3359
02:00:39,709 --> 02:00:42,390
It's like presenting your hand stamp again and again every time

3360
02:00:42,390 --> 02:00:44,740
you open an email or click on a link in Gmail.

3361
02:00:45,029 --> 02:00:47,240
This cookie header is what the browser sends.

3362
02:00:47,529 --> 02:00:50,669
This set cookie header is what the server sends.

3363
02:00:50,770 --> 02:00:52,759
So this is the act of stamping your hand.

3364
02:00:52,930 --> 02:00:55,080
This is the act of presenting your hand,

3365
02:00:55,209 --> 02:01:00,399
and that effectively is how browsers and servers remember who you are.

3366
02:01:00,580 --> 02:01:02,640
This is how advertisers generally

3367
02:01:03,129 --> 02:01:07,279
remember who you are because at one point or other they put a cookie on your computer

3368
02:01:07,520 --> 02:01:08,490
and unbeknownst to you,

3369
02:01:08,500 --> 02:01:09,509
you're going to this website,

3370
02:01:09,569 --> 02:01:10,020
this website,

3371
02:01:10,129 --> 02:01:10,669
this website,

3372
02:01:10,850 --> 02:01:13,009
and your browser has been presenting this hand stamp all.

3373
02:01:13,160 --> 02:01:14,000
All this time,

3374
02:01:14,189 --> 02:01:15,270
so advertisers know,

3375
02:01:15,350 --> 02:01:15,410
oh,

3376
02:01:15,430 --> 02:01:16,109
that's David again.

3377
02:01:16,189 --> 02:01:16,830
That's David again,

3378
02:01:16,899 --> 02:01:17,779
that's David again

3379
02:01:18,270 --> 02:01:20,620
because they're seeing the same hand stamp.

3380
02:01:20,740 --> 02:01:22,229
And so one of the reasons why last week,

3381
02:01:22,270 --> 02:01:22,669
for instance,

3382
02:01:22,709 --> 02:01:24,740
I kept opening things in Incognito mode,

3383
02:01:24,910 --> 02:01:26,549
which you might use generally if you want to do something

3384
02:01:26,549 --> 02:01:29,000
private and not have it be saved in the computer's memory,

3385
02:01:29,229 --> 02:01:31,830
is also because Incognito mode gets rid of all

3386
02:01:31,830 --> 02:01:33,620
of your cookies when you close the window,

3387
02:01:33,910 --> 02:01:38,910
effectively like wiping off the hand stamp the next time you go to that same website.

3388
02:01:39,500 --> 02:01:40,850
So that's all a cookie is.

3389
02:01:40,890 --> 02:01:43,290
It's a key value pair that can be planted on your computer,

3390
02:01:43,330 --> 02:01:45,759
but it's a wonderfully powerful mechanism

3391
02:01:46,169 --> 02:01:47,040
for implementing,

3392
02:01:47,169 --> 02:01:49,169
and this is the juiciest idea for today,

3393
02:01:49,250 --> 02:01:51,649
I'd argue what are called sessions.

3394
02:01:51,930 --> 02:01:55,770
Sessions are this feature whereby browsers and servers

3395
02:01:55,770 --> 02:01:58,680
have a persistent connection to each other even though

3396
02:01:59,049 --> 02:02:01,169
HTTP is what we'll call stateless.

3397
02:02:01,330 --> 02:02:03,450
So stateless just means that you don't have a constant.

3398
02:02:03,611 --> 02:02:06,691
Connection to the server when you are using a website and that's

3399
02:02:06,691 --> 02:02:09,211
not always true and nowadays you sometimes do have a consistent,

3400
02:02:09,332 --> 02:02:10,441
a persistent connection,

3401
02:02:10,651 --> 02:02:11,001
but

3402
02:02:11,291 --> 02:02:13,461
cookies allow you to close your laptop,

3403
02:02:13,532 --> 02:02:14,602
even shut down your computer,

3404
02:02:14,691 --> 02:02:17,992
come back the next day and still have the illusion of being connected just

3405
02:02:17,992 --> 02:02:21,852
as you were the previous day because of this virtual presentation of hand stamps.

3406
02:02:22,012 --> 02:02:24,001
So a session more concretely,

3407
02:02:24,051 --> 02:02:27,571
you can think of in Python as a dictionary of key value.

3408
02:02:27,733 --> 02:02:31,124
Pairs that you can associate with each and every user.

3409
02:02:31,333 --> 02:02:31,854
That is to say,

3410
02:02:31,894 --> 02:02:35,724
when I log into a website that is using sessions implemented with cookies,

3411
02:02:36,014 --> 02:02:39,483
they can store any number of key value pairs about me

3412
02:02:39,773 --> 02:02:42,173
in the server's memory and my presentation of

3413
02:02:42,173 --> 02:02:44,403
the hand stamp will ensure that they keep,

3414
02:02:44,813 --> 02:02:47,604
they know which key value pairs to assign to me.

3415
02:02:47,733 --> 02:02:51,443
Let me go back into VS code here and let me CD into a directory with which I came,

3416
02:02:51,494 --> 02:02:51,653
which.

3417
02:02:51,755 --> 02:02:52,525
Called Login,

3418
02:02:52,536 --> 02:02:55,536
which is just going to be a relatively simple flask application that

3419
02:02:55,536 --> 02:02:58,416
demonstrates how you can implement the ability to log into a website,

3420
02:02:58,456 --> 02:03:00,496
and we'll keep it super simple with just user names,

3421
02:03:00,576 --> 02:03:01,375
no passwords,

3422
02:03:01,456 --> 02:03:02,815
but as you'll see in Problems at 9,

3423
02:03:02,855 --> 02:03:04,886
we'll add some passwords to the mix as well.

3424
02:03:05,056 --> 02:03:07,175
If I type LS inside of this login directory,

3425
02:03:07,215 --> 02:03:08,976
you'll see some familiar friends app.ie,

3426
02:03:09,175 --> 02:03:10,016
requirements.text,

3427
02:03:10,215 --> 02:03:11,175
and templates.

3428
02:03:11,215 --> 02:03:13,335
But let me draw our attention to one other library

3429
02:03:13,335 --> 02:03:15,706
we're going to now start using called Flask Session.

3430
02:03:16,217 --> 02:03:18,578
So Flask session is just a third party library that

3431
02:03:18,578 --> 02:03:21,228
gives us the ability to use cookies in our application

3432
02:03:21,538 --> 02:03:26,448
and not have to know or understand any of the screenshots we just saw of HDP requests.

3433
02:03:26,487 --> 02:03:28,127
It sort of suffices to stipulate,

3434
02:03:28,297 --> 02:03:28,587
OK,

3435
02:03:28,777 --> 02:03:30,417
someone figured out how cookies works.

3436
02:03:30,698 --> 02:03:34,408
I just want to use them now as a feature so that when a user uses my website,

3437
02:03:34,618 --> 02:03:37,208
I can associate data with them like who they are,

3438
02:03:37,417 --> 02:03:38,308
what their username is,

3439
02:03:38,417 --> 02:03:39,888
and therefore that they've logged in.

3440
02:03:40,178 --> 02:03:43,138
So let's go ahead and close requirements.text and open up.

3441
02:03:43,700 --> 02:03:45,450
App.ie in this case.

3442
02:03:45,700 --> 02:03:50,810
Here is an implementation of a program whose purpose in life is to enable me to log in.

3443
02:03:50,979 --> 02:03:51,339
And in fact,

3444
02:03:51,580 --> 02:03:54,259
before we before we walk through the code,

3445
02:03:54,339 --> 02:03:56,370
let me do this in this terminal.

3446
02:03:56,500 --> 02:03:58,740
Let's do flask run and I already hit control

3447
02:03:58,740 --> 02:04:00,740
C on my other terminal window a moment ago.

3448
02:04:01,129 --> 02:04:01,410
Uh,

3449
02:04:01,509 --> 02:04:04,339
let me now go into my other tab up here

3450
02:04:04,589 --> 02:04:06,549
and reload the slash route,

3451
02:04:06,589 --> 02:04:09,669
which is now going to be this login route instead of Frosh IMs.

3452
02:04:09,790 --> 02:04:12,270
All this website does by default is it tells me first,

3453
02:04:12,339 --> 02:04:13,250
you are not logged in,

3454
02:04:13,430 --> 02:04:14,779
but here's a link to log in.

3455
02:04:14,910 --> 02:04:15,790
It's a little small,

3456
02:04:15,830 --> 02:04:18,549
but if you look in the bottom left hand corner of my browser right now,

3457
02:04:18,589 --> 02:04:21,459
it's a URL that ends with slash login.

3458
02:04:21,629 --> 02:04:21,950
And in fact,

3459
02:04:22,029 --> 02:04:25,040
I can see that more clearly if I view page source in the browser.

3460
02:04:25,390 --> 02:04:27,470
Here is the only thing I'm really seeing.

3461
02:04:28,029 --> 02:04:29,490
In this web app so far,

3462
02:04:29,660 --> 02:04:30,979
but notice what happens now.

3463
02:04:31,060 --> 02:04:32,450
If I click on log in,

3464
02:04:32,700 --> 02:04:35,810
the route in my URL just changed to slash login.

3465
02:04:35,919 --> 02:04:38,299
I'm again keeping it simple with just usernames,

3466
02:04:38,379 --> 02:04:38,990
no passwords,

3467
02:04:39,100 --> 02:04:41,500
but I'm going to log in as David and click log in.

3468
02:04:41,700 --> 02:04:42,169
But first,

3469
02:04:42,180 --> 02:04:43,250
let me show you the code.

3470
02:04:43,500 --> 02:04:44,770
In View page source,

3471
02:04:45,020 --> 02:04:45,930
I have a form

3472
02:04:46,140 --> 02:04:48,240
that submits to slash login

3473
02:04:48,580 --> 02:04:49,810
using the post method.

3474
02:04:50,100 --> 02:04:52,700
The only thing about this button that's the form that's interesting

3475
02:04:52,700 --> 02:04:54,899
is it's got a text box and a login button.

3476
02:04:55,560 --> 02:04:56,910
Same as we've seen before.

3477
02:04:57,129 --> 02:04:57,950
So let's click it.

3478
02:04:58,160 --> 02:05:01,919
Now I click log in and notice I get whisked away back to the original route,

3479
02:05:02,000 --> 02:05:02,799
the slash route,

3480
02:05:02,879 --> 02:05:05,270
even though Chrome is hiding the slash from me,

3481
02:05:05,479 --> 02:05:08,040
but the website somehow knows that I'm logged in as David.

3482
02:05:08,080 --> 02:05:08,509
In fact,

3483
02:05:08,600 --> 02:05:11,310
if I open up my page source in the browser,

3484
02:05:11,520 --> 02:05:12,279
I'll see that now.

3485
02:05:12,390 --> 02:05:14,089
It doesn't say you are not logged in.

3486
02:05:14,169 --> 02:05:16,120
It says I am logged in as David,

3487
02:05:16,129 --> 02:05:19,359
and it's now giving me apparently conditionally a logout link.

3488
02:05:19,529 --> 02:05:23,479
So I argue this is representative now of any website that lets you log in

3489
02:05:23,689 --> 02:05:24,479
and out of it.

3490
02:05:24,689 --> 02:05:25,649
So how does this work?

3491
02:05:25,689 --> 02:05:25,930
Well,

3492
02:05:26,209 --> 02:05:27,609
in my login account,

3493
02:05:27,850 --> 02:05:29,169
in my login app here.

3494
02:05:29,720 --> 02:05:32,470
What do we have in Aie the following.

3495
02:05:32,520 --> 02:05:34,970
I've got from Flask import flask redirect,

3496
02:05:35,120 --> 02:05:36,069
render template,

3497
02:05:36,479 --> 02:05:36,750
request,

3498
02:05:36,759 --> 02:05:38,500
and a new one session,

3499
02:05:38,759 --> 02:05:42,560
which you can essentially think of as a dictionary where you

3500
02:05:42,560 --> 02:05:45,959
can store key value pairs for each and every user,

3501
02:05:46,040 --> 02:05:48,799
and Flask will make sure that your code.

3502
02:05:49,245 --> 02:05:52,484
has a different copy of session for every user that visits.

3503
02:05:52,564 --> 02:05:55,274
You can just treat it as though you only have one user,

3504
02:05:55,444 --> 02:05:58,125
but Flask will ensure that when a user visits,

3505
02:05:58,165 --> 02:05:59,484
they get their own copy of session,

3506
02:05:59,524 --> 02:06:00,444
their own copy of session,

3507
02:06:00,484 --> 02:06:01,595
their own copy of session,

3508
02:06:01,924 --> 02:06:03,535
essentially to store whatever you want.

3509
02:06:03,845 --> 02:06:05,165
This next line here I just need to

3510
02:06:05,165 --> 02:06:08,084
copy paste from Flask session import capital session.

3511
02:06:08,370 --> 02:06:09,470
This line is the same.

3512
02:06:09,640 --> 02:06:11,149
Turn this file into a flask app.

3513
02:06:11,359 --> 02:06:13,359
This stuff is new and find a copy paste.

3514
02:06:13,560 --> 02:06:18,830
This just says configure this app to use sessions by storing the cookies

3515
02:06:18,830 --> 02:06:22,669
on the server as files instead of in a database or somewhere else,

3516
02:06:22,879 --> 02:06:25,680
but this is the default that we use for our examples.

3517
02:06:25,890 --> 02:06:26,080
All right,

3518
02:06:26,160 --> 02:06:27,350
what's going on here?

3519
02:06:27,640 --> 02:06:27,759
Well,

3520
02:06:27,839 --> 02:06:28,200
in my.

3521
02:06:28,339 --> 02:06:31,330
Slash route I've got an index function whose purpose in

3522
02:06:31,330 --> 02:06:33,290
life seems to be to render a template called index.

3523
02:06:33,450 --> 02:06:35,040
HTML and then pass in

3524
02:06:35,250 --> 02:06:36,629
a name placeholder

3525
02:06:37,009 --> 02:06:39,649
which is the value of session.get.name.

3526
02:06:39,729 --> 02:06:42,049
So whatever name is stored in the session,

3527
02:06:42,089 --> 02:06:42,759
if any,

3528
02:06:42,970 --> 02:06:44,330
that gets passed into the template.

3529
02:06:44,410 --> 02:06:45,700
So let's go down this rabbit hole.

3530
02:06:45,859 --> 02:06:47,069
Let me open up index.

3531
02:06:47,250 --> 02:06:47,939
HTML.

3532
02:06:48,609 --> 02:06:49,470
Interesting.

3533
02:06:49,560 --> 02:06:51,759
So here is the logic that implemented those two

3534
02:06:51,759 --> 02:06:53,830
different versions of the home page that we saw.

3535
02:06:54,080 --> 02:06:55,600
If the name has a value,

3536
02:06:55,669 --> 02:06:56,669
so if it's not empty,

3537
02:06:56,899 --> 02:06:59,390
we saw you are logged in as such and such.

3538
02:06:59,640 --> 02:07:00,910
Here's a logout link.

3539
02:07:01,160 --> 02:07:02,549
If though there was no name,

3540
02:07:02,600 --> 02:07:04,790
as happens by default before you even log in,

3541
02:07:04,959 --> 02:07:06,589
you see you are not logged in.

3542
02:07:06,790 --> 02:07:08,229
Here's a link to log in.

3543
02:07:08,439 --> 02:07:10,000
So that's all the home page is.

3544
02:07:10,095 --> 02:07:13,435
It's conditional logic checking if there is in fact a user logged in.

3545
02:07:13,685 --> 02:07:13,884
All right,

3546
02:07:14,015 --> 02:07:14,165
well,

3547
02:07:14,245 --> 02:07:15,645
let's go back to A.ie.

3548
02:07:15,765 --> 02:07:17,104
How does the login work?

3549
02:07:17,564 --> 02:07:17,955
Well,

3550
02:07:18,205 --> 02:07:20,435
if you find your way to the login route,

3551
02:07:20,765 --> 02:07:22,075
then I'm asking a question.

3552
02:07:22,125 --> 02:07:24,225
If the user got here via post,

3553
02:07:24,484 --> 02:07:28,365
they probably got here by clicking the login button that I gave them.

3554
02:07:28,685 --> 02:07:29,115
So

3555
02:07:29,325 --> 02:07:31,595
let's store in the session dictionary

3556
02:07:32,004 --> 02:07:33,125
the word name.

3557
02:07:33,399 --> 02:07:35,450
And make the value of that key

3558
02:07:35,790 --> 02:07:38,069
this value here where what I've just highlighted

3559
02:07:38,069 --> 02:07:39,629
is whatever the user typed into the form,

3560
02:07:39,669 --> 02:07:40,390
whether it's David,

3561
02:07:40,430 --> 02:07:40,680
Kelly,

3562
02:07:40,830 --> 02:07:41,060
John,

3563
02:07:41,109 --> 02:07:41,979
or anyone else,

3564
02:07:42,350 --> 02:07:45,839
that's what comes back from the form and I'm just storing that in the session,

3565
02:07:45,870 --> 02:07:49,979
which again is like this special global variable that you get one per user

3566
02:07:50,270 --> 02:07:53,720
and it's implemented underneath the hood by way of cookies or these hand stamps.

3567
02:07:53,870 --> 02:07:55,950
Then I'm just redirected to the slash route.

3568
02:07:55,959 --> 02:07:58,549
Otherwise if the request method wasn't post,

3569
02:07:58,629 --> 02:07:59,500
that means the user just

3570
02:07:59,629 --> 02:08:00,069
manually.

3571
02:08:00,172 --> 02:08:02,712
Visited example.com or whatever my website is.

3572
02:08:03,002 --> 02:08:04,362
That's why I show them login.

3573
02:08:04,522 --> 02:08:05,002
HTML.

3574
02:08:05,152 --> 02:08:05,203
All right,

3575
02:08:05,243 --> 02:08:06,413
let's go down that rabbit hole.

3576
02:08:06,562 --> 02:08:07,683
Let's open up login.

3577
02:08:07,882 --> 02:08:08,562
HTML.

3578
02:08:08,842 --> 02:08:09,792
It's pretty simple.

3579
02:08:10,002 --> 02:08:13,163
It's just a stupid form that has a text box and a submit button,

3580
02:08:13,203 --> 02:08:16,612
but the most important part is that as we saw in the browser,

3581
02:08:16,723 --> 02:08:18,402
it submits to slash login,

3582
02:08:18,562 --> 02:08:20,232
the route we just saw.

3583
02:08:20,723 --> 02:08:20,922
All right,

3584
02:08:21,002 --> 02:08:21,962
if I go back to here,

3585
02:08:22,083 --> 02:08:22,873
how do you log out?

3586
02:08:22,922 --> 02:08:23,002
Well,

3587
02:08:23,042 --> 02:08:24,042
we didn't actually click this,

3588
02:08:24,143 --> 02:08:26,842
but here is how you can delete the contents of the.

3589
02:08:26,965 --> 02:08:29,085
Session and actually log the user out,

3590
02:08:29,175 --> 02:08:30,645
you just call session.lear.

3591
02:08:31,056 --> 02:08:31,576
And so in fact,

3592
02:08:31,655 --> 02:08:34,045
if I go back over here and click log out,

3593
02:08:34,215 --> 02:08:36,136
how does the server know that I've logged out?

3594
02:08:36,335 --> 02:08:36,456
Well,

3595
02:08:36,496 --> 02:08:38,855
that route very quickly you didn't even see the URL

3596
02:08:38,855 --> 02:08:42,056
bar change logged me out by clearing the whole session.

3597
02:08:42,096 --> 02:08:43,536
And so the cookie that was planted on

3598
02:08:43,536 --> 02:08:46,445
my computer was essentially deleted at this point

3599
02:08:46,445 --> 02:08:49,016
in time or really the server side data

3600
02:08:49,016 --> 02:08:51,005
that's associated with that cookie was deleted,

3601
02:08:51,255 --> 02:08:52,175
so I'm no longer

3602
02:08:52,596 --> 02:08:53,536
seeing it at all.

3603
02:08:54,200 --> 02:08:55,180
So that's kind of it,

3604
02:08:55,240 --> 02:08:57,209
like if you log into a website,

3605
02:08:57,220 --> 02:08:57,810
whether it's

3606
02:08:58,020 --> 02:09:00,100
Facebook or Gmail or Outlook or anything else

3607
02:09:00,100 --> 02:09:02,060
like that's effectively how they're logging you in,

3608
02:09:02,140 --> 02:09:04,020
but of course they're adding into the mix

3609
02:09:04,020 --> 02:09:08,580
some uh passwords and other security as well.

3610
02:09:08,990 --> 02:09:09,259
All right,

3611
02:09:09,339 --> 02:09:10,649
how about one other example?

3612
02:09:10,740 --> 02:09:13,009
Let me go back into VS code here

3613
02:09:13,220 --> 02:09:15,220
and let me go into my first terminal,

3614
02:09:15,299 --> 02:09:17,729
hit Control C to kill this login example.

3615
02:09:17,899 --> 02:09:20,129
Let me hit CD to go back and then CD

3616
02:09:20,859 --> 02:09:24,220
store to implement the simplest of web stores like some kind

3617
02:09:24,220 --> 02:09:28,089
of e-commerce site that has an actual shopping cart implemented.

3618
02:09:28,259 --> 02:09:30,419
Let me do flask run inside of this directory.

3619
02:09:31,089 --> 02:09:32,640
Open up my other terminal window,

3620
02:09:32,890 --> 02:09:35,560
and in my other terminal window I'm going to go CD to go back

3621
02:09:35,560 --> 02:09:38,839
and then go into store here where I'm going to see some familiar files,

3622
02:09:39,169 --> 02:09:40,169
namely A.ie,

3623
02:09:40,370 --> 02:09:41,169
requirements.text,

3624
02:09:41,290 --> 02:09:41,700
but

3625
02:09:41,970 --> 02:09:44,450
a database file this time in addition to my templates.

3626
02:09:44,569 --> 02:09:44,620
Well,

3627
02:09:44,649 --> 02:09:46,359
let's see what's inside of that database.

3628
02:09:46,569 --> 02:09:49,259
Let me go ahead and run SQLite 3 of store.db.

3629
02:09:50,089 --> 02:09:51,569
Schema to see what's in the database.

3630
02:09:51,689 --> 02:09:51,899
Ah,

3631
02:09:51,990 --> 02:09:52,890
this is like a bookstore,

3632
02:09:52,970 --> 02:09:54,810
like the very first version of Amazon.com.

3633
02:09:55,046 --> 02:09:55,597
If you will,

3634
02:09:55,767 --> 02:09:59,506
and the table has two columns an ID column and a title

3635
02:09:59,506 --> 02:10:02,117
column for all of the books that this store shall sell.

3636
02:10:02,367 --> 02:10:02,416
Well,

3637
02:10:02,486 --> 02:10:03,316
what are those books?

3638
02:10:03,327 --> 02:10:05,407
Select star from books,

3639
02:10:05,446 --> 02:10:06,316
semicolon.

3640
02:10:06,526 --> 02:10:06,807
OK,

3641
02:10:06,926 --> 02:10:09,767
so this is a bookstore that sells only 5 books,

3642
02:10:09,847 --> 02:10:12,117
among them The Hitchhiker's Guide to the Galaxy and

3643
02:10:12,446 --> 02:10:13,126
sequels.

3644
02:10:13,356 --> 02:10:13,486
All right,

3645
02:10:13,606 --> 02:10:16,887
so wouldn't it be nice if we have a website that displays

3646
02:10:16,887 --> 02:10:20,153
everything in this catalog and lets me Add thanks to my cart.

3647
02:10:20,233 --> 02:10:23,113
And in fact here is maybe the better metaphor for what a session is.

3648
02:10:23,284 --> 02:10:26,673
A session essentially gives you the ability to implement a shopping cart like this,

3649
02:10:26,684 --> 02:10:27,443
where the shopping cart,

3650
02:10:27,483 --> 02:10:27,954
of course,

3651
02:10:28,124 --> 02:10:30,273
in the real world is specific to each user.

3652
02:10:30,483 --> 02:10:33,914
Like if I'm on Amazon.com and Kelly's on Amazon.com and both logged in,

3653
02:10:34,003 --> 02:10:36,753
we obviously don't see the contents of each other's carts,

3654
02:10:36,764 --> 02:10:39,923
and that's because we have separate cookies on our hands and

3655
02:10:39,923 --> 02:10:42,724
so flask or whatever Amazon is using creates the illusion.

3656
02:10:42,811 --> 02:10:45,710
In that we each have our own global dictionary

3657
02:10:46,000 --> 02:10:48,920
called session in which Amazon can store any key value

3658
02:10:48,920 --> 02:10:51,541
pairs it wants like what's in our shopping cart.

3659
02:10:51,761 --> 02:10:52,360
So let's try this.

3660
02:10:52,440 --> 02:10:54,471
Let me go back to my other browser and reload,

3661
02:10:54,480 --> 02:10:56,391
so I'll now see not the login example,

3662
02:10:56,480 --> 02:10:57,641
but the bookstore example,

3663
02:10:57,681 --> 02:11:01,630
and it's super ugly because I whipped it up using the simplest of HTML,

3664
02:11:01,840 --> 02:11:06,601
but you'll see here every one of the books in the database plus an add to cart button.

3665
02:11:07,069 --> 02:11:10,850
And even if again you're sort of new to all this web programming,

3666
02:11:11,100 --> 02:11:14,060
there's not all that much you can do with HTML except

3667
02:11:14,060 --> 02:11:16,970
use forms maybe with some hidden elements to achieve this result.

3668
02:11:17,220 --> 02:11:18,939
So here we have the H1 tag with books.

3669
02:11:19,020 --> 02:11:19,810
Here's an H2,

3670
02:11:19,819 --> 02:11:21,529
which is big and bold but not quite as big.

3671
02:11:21,700 --> 02:11:22,629
Here's the,

3672
02:11:22,779 --> 02:11:24,939
here's the here's the button

3673
02:11:25,220 --> 02:11:26,890
for the Hitchhiker's Guide to the Galaxy.

3674
02:11:27,060 --> 02:11:27,720
As an aside,

3675
02:11:27,899 --> 02:11:30,770
because there's like a curly quote or an apostrophe in the book's name.

3676
02:11:30,939 --> 02:11:33,819
This is just an HTML entity that Flask is outputting for me,

3677
02:11:33,859 --> 02:11:34,899
even though it's not there.

3678
02:11:35,245 --> 02:11:35,475
Uh,

3679
02:11:35,484 --> 02:11:36,754
visually in the database.

3680
02:11:37,004 --> 02:11:39,794
So what does the button do for Hitchhiker's Guide to the Galaxy?

3681
02:11:40,044 --> 02:11:40,084
Well,

3682
02:11:40,125 --> 02:11:42,185
it's a form whose action is slash cart,

3683
02:11:42,285 --> 02:11:45,375
presumably because I want to add it to my cart using the post method.

3684
02:11:45,685 --> 02:11:47,274
I've got an input name equals ID,

3685
02:11:47,285 --> 02:11:48,274
the type of which is hidden,

3686
02:11:48,285 --> 02:11:49,674
the value of which is 1,

3687
02:11:49,884 --> 02:11:51,765
and fast forward 234.

3688
02:11:51,805 --> 02:11:54,435
So just like the deregister example for Kelly,

3689
02:11:54,685 --> 02:11:57,325
similarly is each book going to be addable to a

3690
02:11:57,325 --> 02:12:00,274
cart instead of removable by using that unique ID,

3691
02:12:00,404 --> 02:12:02,845
and indeed every form has an add to cart button.

3692
02:12:03,629 --> 02:12:05,819
So what's happening then on the server?

3693
02:12:05,899 --> 02:12:05,979
Well,

3694
02:12:06,060 --> 02:12:07,209
let's take a look at

3695
02:12:07,459 --> 02:12:08,419
the other tab here.

3696
02:12:08,500 --> 02:12:09,740
If I go back into

3697
02:12:10,370 --> 02:12:11,729
uh VS code,

3698
02:12:12,020 --> 02:12:14,770
and if I go into my,

3699
02:12:14,899 --> 02:12:15,899
let's say,

3700
02:12:16,379 --> 02:12:20,540
let's minimize the terminal window here and let's open up inside of store,

3701
02:12:20,669 --> 02:12:23,000
let's open up our template

3702
02:12:23,459 --> 02:12:24,180
for index.

3703
02:12:24,339 --> 02:12:24,970
HTML,

3704
02:12:24,979 --> 02:12:25,979
which is sort of the entry,

3705
02:12:26,500 --> 02:12:27,450
which is not that,

3706
02:12:27,660 --> 02:12:28,089
uh,

3707
02:12:28,220 --> 02:12:31,339
let's open up app.ie first and figure out what's going on.

3708
02:12:31,819 --> 02:12:35,240
So at the top we have some imports including our SQL library.

3709
02:12:35,490 --> 02:12:37,620
We have an app variable being created,

3710
02:12:37,729 --> 02:12:40,879
a DB variable being created using that same store.db.

3711
02:12:41,250 --> 02:12:44,609
We've got this boilerplate code which just again enables cookies and stores

3712
02:12:44,609 --> 02:12:47,600
the contents on the local file system instead of in a database.

3713
02:12:47,770 --> 02:12:47,979
Ah,

3714
02:12:48,169 --> 02:12:49,600
here's the interesting beginning point.

3715
02:12:49,990 --> 02:12:53,270
How did I see that big page with all the books and the buttons?

3716
02:12:53,350 --> 02:12:53,430
Well,

3717
02:12:53,549 --> 02:12:57,430
for the slash route we've got this function that first uses

3718
02:12:57,430 --> 02:12:59,640
some SQL to get all of the books from the database.

3719
02:12:59,870 --> 02:13:01,140
Select Star from books,

3720
02:13:01,399 --> 02:13:01,680
and then,

3721
02:13:01,720 --> 02:13:01,950
ah,

3722
02:13:02,029 --> 02:13:02,709
there's no index.

3723
02:13:02,870 --> 02:13:04,319
HTML because I called it books.

3724
02:13:04,470 --> 02:13:06,310
HTML in this case just because,

3725
02:13:06,629 --> 02:13:10,600
and I set the book's placeholder equal to the value of the book's variable.

3726
02:13:10,979 --> 02:13:11,029
All right,

3727
02:13:11,069 --> 02:13:12,299
let's go down this rabbit hole now.

3728
02:13:12,379 --> 02:13:14,379
Let's open up the templates folders,

3729
02:13:14,430 --> 02:13:14,770
books.

3730
02:13:14,910 --> 02:13:16,020
HTML file.

3731
02:13:16,569 --> 02:13:17,080
OK,

3732
02:13:17,290 --> 02:13:20,009
so here we have that H1 with books and then we have a

3733
02:13:20,009 --> 02:13:23,979
4 loop which is going to output for every book in H2 tag and

3734
02:13:24,370 --> 02:13:25,129
a form

3735
02:13:25,330 --> 02:13:25,620
tag,

3736
02:13:25,689 --> 02:13:27,439
a form tag again and again and again,

3737
02:13:27,609 --> 02:13:28,520
each of which

3738
02:13:28,970 --> 02:13:32,959
has a value that equals the current book's ID,

3739
02:13:33,120 --> 02:13:34,649
but the title in the H2,

3740
02:13:34,689 --> 02:13:35,129
of course,

3741
02:13:35,250 --> 02:13:36,399
is the title of the book,

3742
02:13:36,450 --> 02:13:37,839
which is more human friendly.

3743
02:13:38,049 --> 02:13:39,609
So what happens when I actually click on add

3744
02:13:39,609 --> 02:13:41,419
to cart for The Hitchhiker's Guide to the Galaxy?

3745
02:13:41,450 --> 02:13:41,500
Well,

3746
02:13:41,609 --> 02:13:42,350
I should

3747
02:13:42,569 --> 02:13:44,569
indeed see that now that one book has been added,

3748
02:13:44,609 --> 02:13:45,620
and if I go back.

3749
02:13:45,675 --> 02:13:48,096
At another like the restaurant at the end of the universe,

3750
02:13:48,306 --> 02:13:49,936
I now have two books in my cart.

3751
02:13:50,186 --> 02:13:52,235
So where is that data actually being stored?

3752
02:13:52,286 --> 02:13:52,346
Well,

3753
02:13:52,425 --> 02:13:54,335
if we go back to VS code here,

3754
02:13:55,025 --> 02:13:55,815
hide the terminal,

3755
02:13:55,826 --> 02:13:57,105
and focus on the cart route,

3756
02:13:57,186 --> 02:13:58,045
the cart route,

3757
02:13:58,386 --> 02:14:00,456
because it supports post in addition to get,

3758
02:14:00,706 --> 02:14:02,476
also is doing this for me.

3759
02:14:02,545 --> 02:14:02,666
Well,

3760
02:14:02,815 --> 02:14:03,036
first,

3761
02:14:03,125 --> 02:14:04,576
it's checking with some logic here.

3762
02:14:04,706 --> 02:14:06,735
If there is no cart in the session,

3763
02:14:07,076 --> 02:14:11,025
go ahead and create a key called cart and set it equal to an empty list.

3764
02:14:11,065 --> 02:14:11,545
In other words,

3765
02:14:11,625 --> 02:14:14,706
I can put any key value pairs into the session that I want.

3766
02:14:14,932 --> 02:14:17,921
So if I want my shopping cart to effectively be a list of

3767
02:14:17,921 --> 02:14:20,151
all of the books that the user has added to their cart,

3768
02:14:20,361 --> 02:14:22,881
it stands to reason that my cart by default should

3769
02:14:22,881 --> 02:14:25,432
just be an empty list when they first arrive.

3770
02:14:25,801 --> 02:14:26,222
However,

3771
02:14:26,321 --> 02:14:29,512
if the user has clicked submit in order to get here,

3772
02:14:29,722 --> 02:14:29,791
well,

3773
02:14:29,801 --> 02:14:30,642
I'm going to do this.

3774
02:14:30,682 --> 02:14:34,392
I'm going to get the ID of the book that they've submitted via that form,

3775
02:14:34,711 --> 02:14:36,481
and if it indeed exists and it's not someone

3776
02:14:36,481 --> 02:14:39,041
like Kelly messing around and sending me invalid parameters,

3777
02:14:39,122 --> 02:14:40,111
I am going to

3778
02:14:40,361 --> 02:14:42,872
append to the cart list

3779
02:14:43,162 --> 02:14:44,082
in the session.

3780
02:14:44,549 --> 02:14:45,890
The book ID

3781
02:14:46,060 --> 02:14:49,299
and then I'm just going to redirect the user to the cart and

3782
02:14:49,299 --> 02:14:53,660
anytime you do a redirect that always is using get not post.

3783
02:14:53,779 --> 02:14:56,649
And so when I come back to this cart route later,

3784
02:14:56,819 --> 02:14:58,620
I'm not going to be using post.

3785
02:14:58,709 --> 02:14:59,899
I'm going to be using get,

3786
02:15:00,100 --> 02:15:00,700
which means this.

3787
02:15:00,825 --> 02:15:02,375
chunk of code here is executed.

3788
02:15:02,544 --> 02:15:05,024
I have a variable called books set at equal to the

3789
02:15:05,024 --> 02:15:08,145
results of doing select star from books where ID in the

3790
02:15:08,145 --> 02:15:11,694
following parenthesis list of IDs recall that in is the preposition

3791
02:15:11,694 --> 02:15:14,234
that gives me back multiple IDs if I so choose,

3792
02:15:14,424 --> 02:15:16,814
and then I'm rendering cart.html.

3793
02:15:17,379 --> 02:15:17,930
With

3794
02:15:18,120 --> 02:15:20,720
those their books and if I go back to the application,

3795
02:15:20,759 --> 02:15:23,879
the reason why I'm seeing two elements here and indeed if

3796
02:15:23,879 --> 02:15:27,509
I go to my developer tools or view page source rather,

3797
02:15:27,680 --> 02:15:29,799
I'll see two list items inside of an

3798
02:15:29,799 --> 02:15:33,450
ordered list or numbered list containing the contents then

3799
02:15:33,839 --> 02:15:35,080
of that shopping cart.

3800
02:15:36,040 --> 02:15:36,520
All right,

3801
02:15:36,720 --> 02:15:40,000
so if we now have the ability to use sessions to remember who has logged in and

3802
02:15:40,000 --> 02:15:41,509
we have the ability with sessions to remember

3803
02:15:41,509 --> 02:15:43,350
what someone has added to their shopping cart,

3804
02:15:43,680 --> 02:15:47,910
what else can we do with web applications more generally,

3805
02:15:48,120 --> 02:15:50,040
even if not using sessions?

3806
02:15:50,080 --> 02:15:50,120
Well,

3807
02:15:50,160 --> 02:15:51,950
let me go ahead and close this tab here.

3808
02:15:52,120 --> 02:15:53,569
Let me go back to VS code here,

3809
02:15:53,720 --> 02:15:54,839
close out these two examples,

3810
02:15:54,879 --> 02:15:56,759
and let's do a final set of examples that

3811
02:15:56,759 --> 02:15:59,470
demonstrate what we can do with some real world data

3812
02:15:59,680 --> 02:16:00,279
and a web application.

3813
02:16:00,462 --> 02:16:03,723
I have lastly a directory called shows which is

3814
02:16:03,723 --> 02:16:06,163
evocative of our use of IMDB in the past,

3815
02:16:06,292 --> 02:16:08,362
and I'm going to go ahead into my first terminal window,

3816
02:16:08,533 --> 02:16:11,763
hit Control C and call your attention to one thing before we move on.

3817
02:16:12,013 --> 02:16:16,013
Every time I have executed a SQL query inside of my

3818
02:16:16,013 --> 02:16:19,522
code in my first terminal window where Flask is running,

3819
02:16:19,732 --> 02:16:24,812
you'll see either in green for success or yellow or red for some issues.

3820
02:16:25,053 --> 02:16:26,275
The Actual SQL code,

3821
02:16:26,625 --> 02:16:29,096
SQL commands that are being sent to your database.

3822
02:16:29,266 --> 02:16:32,856
This is useful if you mess something up at some point related to a database query,

3823
02:16:33,026 --> 02:16:37,254
you can actually see in your terminal where you're running flask run,

3824
02:16:37,504 --> 02:16:38,396
actually what

3825
02:16:38,706 --> 02:16:42,536
SQL command was sent to the server to try to troubleshoot errors that way.

3826
02:16:42,665 --> 02:16:44,965
Otherwise you're just flying blind when actually

3827
02:16:44,965 --> 02:16:47,616
interacting only with the web browser.

3828
02:16:47,786 --> 02:16:48,215
But for now,

3829
02:16:48,225 --> 02:16:49,575
let me go ahead and clear that away.

3830
02:16:50,089 --> 02:16:54,709
And CD back to my default directory and CD now into shows where

3831
02:16:54,709 --> 02:16:57,580
if I type LS we'll see a whole bunch of files A.ie,

3832
02:16:57,990 --> 02:16:58,790
requirements.text,

3833
02:16:58,799 --> 02:17:00,308
and this time shows.db,

3834
02:17:00,388 --> 02:17:02,580
which is the very same database that we had

3835
02:17:02,830 --> 02:17:05,429
in past weeks when we played with some of the

3836
02:17:05,429 --> 02:17:08,660
very large number of shows in the internet movie database.

3837
02:17:08,780 --> 02:17:10,429
And what does A.ie do here?

3838
02:17:10,629 --> 02:17:10,750
Well,

3839
02:17:10,790 --> 02:17:12,629
it implements the simplest of programs.

3840
02:17:12,709 --> 02:17:14,308
This gives me access first to shows.

3841
02:17:14,706 --> 02:17:16,254
with some boilerplate up top.

3842
02:17:16,504 --> 02:17:17,536
If I scroll down here,

3843
02:17:17,584 --> 02:17:19,616
you'll see that there's an index.

3844
02:17:19,856 --> 02:17:21,856
HTML template that's rendered by default,

3845
02:17:22,045 --> 02:17:25,225
and then apparently there's a search route which is akin to what Google

3846
02:17:25,225 --> 02:17:28,135
does for us when we searched for cats and dogs in the past.

3847
02:17:28,305 --> 02:17:31,975
But for the first time I'm implementing my own search engine for TV shows,

3848
02:17:32,066 --> 02:17:33,856
not for dogs and cats.

3849
02:17:34,026 --> 02:17:35,344
But what does this search route do?

3850
02:17:35,465 --> 02:17:35,584
Well,

3851
02:17:35,696 --> 02:17:38,706
it uses a shows variable and it executes the sequel,

3852
02:17:38,786 --> 02:17:41,800
so Star from shows where title equals question mark,

3853
02:17:41,971 --> 02:17:43,971
and it passes in just like Google does

3854
02:17:44,130 --> 02:17:47,941
the Q parameter for query and then it renders a template called Search.

3855
02:17:48,101 --> 02:17:51,652
HTML passing in those shows as a placeholder.

3856
02:17:51,861 --> 02:17:52,261
In other words,

3857
02:17:52,341 --> 02:17:52,941
what does this do?

3858
02:17:53,001 --> 02:17:53,061
Well,

3859
02:17:53,141 --> 02:17:54,781
let me go back over to the store,

3860
02:17:54,832 --> 02:17:54,921
uh,

3861
02:17:55,022 --> 02:17:56,290
to the store tab here,

3862
02:17:56,630 --> 02:17:58,111
change the URL to just slash,

3863
02:17:58,181 --> 02:17:59,300
and because I'm now running,

3864
02:17:59,460 --> 02:17:59,732
uh,

3865
02:17:59,861 --> 02:18:01,691
I'm no longer running the store,

3866
02:18:01,902 --> 02:18:03,531
I do want to go ahead and run

3867
02:18:04,022 --> 02:18:05,221
in my first terminal window,

3868
02:18:05,341 --> 02:18:06,011
flaskun.

3869
02:18:06,339 --> 02:18:07,799
To start off

3870
02:18:08,000 --> 02:18:09,599
the show's application instead.

3871
02:18:09,849 --> 02:18:12,400
So if I now go back to that tab because no servers running,

3872
02:18:12,690 --> 02:18:14,610
what I see here now is the simplest of search

3873
02:18:14,610 --> 02:18:17,280
boxes like our Google example asking for a query,

3874
02:18:17,450 --> 02:18:19,259
but this time I can search for things with

3875
02:18:19,259 --> 02:18:22,250
which I'm more familiar like The Office capital T,

3876
02:18:22,330 --> 02:18:22,940
capital O,

3877
02:18:23,129 --> 02:18:23,620
search,

3878
02:18:23,888 --> 02:18:24,799
and what I get back,

3879
02:18:24,950 --> 02:18:25,990
not that enlighteningly,

3880
02:18:26,089 --> 02:18:28,839
but is the title of every show that matches exactly that.

3881
02:18:29,009 --> 02:18:29,419
If I go.

3882
02:18:29,477 --> 02:18:33,268
Head and view page source you'll see that what was generated was an unordered

3883
02:18:33,268 --> 02:18:37,029
list of offices that are in the database and recall there's the British one,

3884
02:18:37,109 --> 02:18:37,668
the American one,

3885
02:18:37,749 --> 02:18:39,298
and a bunch of others as well.

3886
02:18:39,588 --> 02:18:39,939
However,

3887
02:18:40,029 --> 02:18:44,138
this form does not work if I type in something like the office search.

3888
02:18:44,268 --> 02:18:45,749
I get no results in that case,

3889
02:18:45,869 --> 02:18:49,579
which isn't so much a well it's just a lack of features here.

3890
02:18:49,628 --> 02:18:52,499
And so let me actually go into VS code here.

3891
02:18:52,939 --> 02:18:54,318
And let me propose that

3892
02:18:54,489 --> 02:18:56,609
we come up with a better version of this code.

3893
02:18:56,727 --> 02:18:57,048
So in fact,

3894
02:18:57,088 --> 02:19:00,439
I'm gonna go into the premade examples with which I came today.

3895
02:19:00,568 --> 02:19:02,878
I'm going to go into the next version of shows here,

3896
02:19:03,128 --> 02:19:04,958
run flask run here,

3897
02:19:05,338 --> 02:19:07,119
reload the application over here,

3898
02:19:07,208 --> 02:19:10,289
and now show you that the office in lower case does actually work.

3899
02:19:10,369 --> 02:19:10,798
Moreover,

3900
02:19:10,808 --> 02:19:12,239
it searches for anything

3901
02:19:12,489 --> 02:19:13,878
that mentions the office.

3902
02:19:14,128 --> 02:19:15,068
So if you had to guess,

3903
02:19:15,128 --> 02:19:18,159
how might this be implemented underneath the hood,

3904
02:19:18,329 --> 02:19:18,369
well,

3905
02:19:18,409 --> 02:19:21,727
if I open up my other terminal window and go into that same directory.

3906
02:19:21,852 --> 02:19:25,463
Shows one and open up this version of A.ie

3907
02:19:25,843 --> 02:19:28,963
you'll see that instead of using a simple query like before,

3908
02:19:29,003 --> 02:19:30,763
I'm now using the like

3909
02:19:31,164 --> 02:19:35,574
keyword here because I'm checking that it is like the office and notice

3910
02:19:35,574 --> 02:19:38,484
this is a bit clever here or a bit confusing at first glance.

3911
02:19:38,718 --> 02:19:40,980
The placeholder I want is question mark,

3912
02:19:41,230 --> 02:19:43,759
but I don't want to just search for the user's input.

3913
02:19:43,910 --> 02:19:46,950
I want to tolerate zero or more characters to the left via

3914
02:19:46,950 --> 02:19:50,099
the SQL wildcard and zero or more characters to the right.

3915
02:19:50,429 --> 02:19:53,049
So I'm concatenating onto the user's input,

3916
02:19:53,190 --> 02:19:54,070
a percent sign here,

3917
02:19:54,190 --> 02:19:55,269
a percent sign here,

3918
02:19:55,280 --> 02:19:57,240
because we recall from our week 7 with SQL.

3919
02:19:57,469 --> 02:20:01,110
This just means look for anything case insensitively that has

3920
02:20:01,110 --> 02:20:04,070
THE space all F F I C E in it.

3921
02:20:04,429 --> 02:20:07,259
No matter where that string is in the text.

3922
02:20:07,549 --> 02:20:11,589
How did it know to render that though as this bulleted list of all of these offices?

3923
02:20:11,629 --> 02:20:11,709
Well,

3924
02:20:11,830 --> 02:20:14,820
let me go into my terminal here and open up.

3925
02:20:15,349 --> 02:20:16,000
Uh,

3926
02:20:16,530 --> 02:20:16,889
search.

3927
02:20:17,089 --> 02:20:17,650
HTML,

3928
02:20:17,769 --> 02:20:19,839
which is the template that the search route is using,

3929
02:20:19,969 --> 02:20:22,290
and you'll see that I'm just iterating over with a gina

3930
02:20:22,290 --> 02:20:25,839
4 loop each of those shows and then outputting a list item

3931
02:20:26,009 --> 02:20:29,440
for each of those matches effectively just as I did before.

3932
02:20:29,650 --> 02:20:33,559
But there's this other technique I can use altogether and it's generally

3933
02:20:33,559 --> 02:20:36,250
going to open up more possibilities for us in final projects,

3934
02:20:36,290 --> 02:20:37,080
if not beyond,

3935
02:20:37,200 --> 02:20:38,650
of creating essentially my own AP.

3936
02:20:39,160 --> 02:20:41,759
rather than just make a web app that spits out the

3937
02:20:41,759 --> 02:20:44,110
entire HTML page that I want the user to see,

3938
02:20:44,360 --> 02:20:46,160
wouldn't it be nice if I could just start to

3939
02:20:46,160 --> 02:20:49,030
create routes that spit out the data that I want,

3940
02:20:49,099 --> 02:20:49,809
and then I,

3941
02:20:49,820 --> 02:20:52,080
or even some third party making a website with the

3942
02:20:52,080 --> 02:20:55,950
same data can integrate my application into their own.

3943
02:20:56,000 --> 02:21:00,709
And indeed an API is an application programming interface and it's essentially

3944
02:21:00,959 --> 02:21:02,040
web-based function.

3945
02:21:02,120 --> 02:21:07,299
You can call to get data from someone else's services generally using HTTP,

3946
02:21:07,469 --> 02:21:10,740
and you can return the data in any number of formats in text format,

3947
02:21:11,070 --> 02:21:12,139
in HTML format,

3948
02:21:12,190 --> 02:21:13,910
or in something called JSON format,

3949
02:21:13,990 --> 02:21:16,339
which is short for JavaScript object notation,

3950
02:21:16,549 --> 02:21:18,099
which looks a little something like this,

3951
02:21:18,110 --> 02:21:19,299
which is quite like

3952
02:21:19,629 --> 02:21:22,990
Python arrays and dictionaries combined.

3953
02:21:23,150 --> 02:21:24,669
But notice here with the wave of the hand,

3954
02:21:24,709 --> 02:21:27,200
there's a whole bunch of Key value pairs in this particular

3955
02:21:27,200 --> 02:21:31,110
example of all of the offices that are in IMDB's database

3956
02:21:31,110 --> 02:21:34,299
and so I wanted to show us these final versions of

3957
02:21:34,299 --> 02:21:37,049
the same shows application that works a little bit differently.

3958
02:21:37,259 --> 02:21:42,290
If I go into say shows 2 example here now run oops,

3959
02:21:42,299 --> 02:21:45,209
and let's go ahead and exit out of the previous flask copy

3960
02:21:45,419 --> 02:21:48,969
and run shows 2 inside of which is flask run,

3961
02:21:49,339 --> 02:21:51,980
notice here that if I go back to this web form now.

3962
02:21:52,629 --> 02:21:54,950
Notice that there is no more search button because this is

3963
02:21:54,950 --> 02:21:57,900
meant to be highly interactive and I can search for THE

3964
02:21:58,309 --> 02:22:02,820
space O F F I C E and you'll notice that this is effectively autocomplete,

3965
02:22:02,830 --> 02:22:05,179
which we saw a taste of last week with JavaScript,

3966
02:22:05,309 --> 02:22:06,820
which I am in fact using here.

3967
02:22:06,990 --> 02:22:07,820
But how is this working?

3968
02:22:07,889 --> 02:22:07,950
Well,

3969
02:22:08,030 --> 02:22:10,500
let me reload and open up my developer tools

3970
02:22:10,910 --> 02:22:12,200
and in Developer Tools,

3971
02:22:12,269 --> 02:22:15,150
let's watch the network tab this time because when I.

3972
02:22:15,245 --> 02:22:17,785
Type in something like T you'll see that my

3973
02:22:17,785 --> 02:22:21,075
web page suddenly made a request to my own slash

3974
02:22:21,075 --> 02:22:23,495
search route and if I click on my developer

3975
02:22:23,495 --> 02:22:26,025
tools and look at the response that came back,

3976
02:22:26,195 --> 02:22:29,514
you'll see that the slash search route spit out not a

3977
02:22:29,514 --> 02:22:33,214
full web page but just a whole bunch of LI tags.

3978
02:22:33,434 --> 02:22:34,155
Now why is that?

3979
02:22:34,264 --> 02:22:34,315
Well,

3980
02:22:34,394 --> 02:22:37,834
let me go back to VS code and open up in my other terminal.

3981
02:22:38,379 --> 02:22:39,559
Uh app.ie

3982
02:22:40,139 --> 02:22:43,169
and in app.ie scrolling down to search,

3983
02:22:43,419 --> 02:22:45,940
you'll see that when I get shows from the database,

3984
02:22:45,980 --> 02:22:46,980
I'm still using Search.

3985
02:22:47,139 --> 02:22:47,730
HTML,

3986
02:22:47,980 --> 02:22:50,570
which previously extended my layout

3987
02:22:50,860 --> 02:22:51,929
and plugged in

3988
02:22:52,139 --> 02:22:54,209
that whole ordered unordered list.

3989
02:22:54,419 --> 02:22:55,250
But this time,

3990
02:22:55,290 --> 02:22:57,309
if I go into this version of search.

3991
02:22:57,519 --> 02:22:58,190
HTML,

3992
02:22:58,580 --> 02:23:00,660
you'll see that I'm only spitting out raw

3993
02:23:00,660 --> 02:23:03,450
HTML because I'm assuming that maybe someone,

3994
02:23:03,459 --> 02:23:04,059
myself included,

3995
02:23:04,339 --> 02:23:08,080
wants to use slash search to just get a Whole bunch of list

3996
02:23:08,080 --> 02:23:12,549
items that they can put into their own unordered list or UL tag.

3997
02:23:12,759 --> 02:23:16,669
And so what's effectively happening over here is every time I type a letter,

3998
02:23:16,679 --> 02:23:17,790
notice at bottom left,

3999
02:23:18,120 --> 02:23:20,849
another HTTP request goes across the internet,

4000
02:23:21,070 --> 02:23:22,240
another HTTP request,

4001
02:23:22,280 --> 02:23:23,190
and each of those

4002
02:23:23,400 --> 02:23:26,070
is returning the set of LI elements

4003
02:23:26,429 --> 02:23:29,070
that line up with the query that I've typed in.

4004
02:23:29,240 --> 02:23:30,280
But this is a little sloppy,

4005
02:23:30,309 --> 02:23:30,769
arguably,

4006
02:23:30,879 --> 02:23:34,959
and so far as I'm returning a chunk of HTML but out of context and I'm.

4007
02:23:35,070 --> 02:23:37,530
Dictating to the user that they have to use list items,

4008
02:23:37,660 --> 02:23:40,049
wouldn't it be nice to just send the raw data,

4009
02:23:40,259 --> 02:23:41,309
and I can do that too.

4010
02:23:41,419 --> 02:23:44,809
Let me go back into VS code here and look at our final example,

4011
02:23:45,129 --> 02:23:46,019
shows 3,

4012
02:23:46,580 --> 02:23:48,540
inside of which is a version of this code

4013
02:23:48,540 --> 02:23:52,299
that now returns that so-called JavaScript object notation.

4014
02:23:52,379 --> 02:23:53,809
And if I go into shows 3,

4015
02:23:54,059 --> 02:23:55,110
run flaskun,

4016
02:23:55,660 --> 02:23:59,769
go back over now to my browser tab and click reload,

4017
02:24:00,099 --> 02:24:03,259
I'll see now when I search for say T.

4018
02:24:04,200 --> 02:24:05,500
And click on that row.

4019
02:24:05,830 --> 02:24:08,549
Notice now in the response tab of my developer tools

4020
02:24:08,549 --> 02:24:11,259
I'm getting back a whole bunch of juicy information,

4021
02:24:11,269 --> 02:24:15,099
a massive JavaScript object notation chunk of data.

4022
02:24:15,349 --> 02:24:18,040
Notice the square bracket means here comes a list or an array.

4023
02:24:18,259 --> 02:24:20,459
Here comes a dictionary or dict,

4024
02:24:20,610 --> 02:24:21,950
and indeed that's what I'm seeing.

4025
02:24:22,030 --> 02:24:23,059
This looks like Python,

4026
02:24:23,070 --> 02:24:24,309
but it's technically JavaScript and

4027
02:24:24,309 --> 02:24:26,349
it's technically JavaScript's object notation.

4028
02:24:26,589 --> 02:24:29,150
This just means this is the juicy data I'm getting back.

4029
02:24:29,290 --> 02:24:33,839
From the server and if you now think way back to week 0 and even in our family

4030
02:24:33,839 --> 02:24:38,679
weekend lecture on AI lecture on AI where I was writing code that talked to open AIs,

4031
02:24:38,879 --> 02:24:40,070
so-called API,

4032
02:24:40,299 --> 02:24:43,030
to get responses from our server side cat,

4033
02:24:43,320 --> 02:24:46,309
they were sending us JavaScript object notation like this,

4034
02:24:46,360 --> 02:24:49,469
and I was just grabbing the data that I actually cared about,

4035
02:24:49,759 --> 02:24:52,019
namely the cat's actual response.

4036
02:24:52,240 --> 02:24:53,309
And so in this case,

4037
02:24:53,320 --> 02:24:54,200
if I open up.

4038
02:24:54,540 --> 02:24:57,269
And my other terminal window here app.ie,

4039
02:24:57,570 --> 02:25:01,240
you'll see in my search route that instead of returning a template,

4040
02:25:01,410 --> 02:25:04,250
I'm using a crazy named function called Jasonify,

4041
02:25:04,610 --> 02:25:06,610
which is just another function that comes with

4042
02:25:06,610 --> 02:25:10,219
Flask itself that has the effect of taking the

4043
02:25:10,769 --> 02:25:14,440
list of Python dictionaries that came back from my SQL database,

4044
02:25:14,730 --> 02:25:16,620
Jasonifying it in such a way

4045
02:25:16,809 --> 02:25:18,280
that I then can.

4046
02:25:18,830 --> 02:25:19,209
Uh,

4047
02:25:19,469 --> 02:25:21,389
serve it to anyone on the internet,

4048
02:25:21,589 --> 02:25:22,230
myself included,

4049
02:25:22,269 --> 02:25:23,219
as a service

4050
02:25:23,429 --> 02:25:25,620
so that I and they can use my own data

4051
02:25:25,870 --> 02:25:28,610
to implement their own web web applications.

4052
02:25:28,950 --> 02:25:31,429
So that's sort of it for web programming.

4053
02:25:31,580 --> 02:25:33,790
Ultimately you now have all of the building blocks from

4054
02:25:33,790 --> 02:25:35,870
week zero onward to make your own web applications,

4055
02:25:35,910 --> 02:25:37,230
and if you so choose for final projects,

4056
02:25:37,269 --> 02:25:38,669
your own mobile applications,

4057
02:25:38,790 --> 02:25:39,400
even if this too,

4058
02:25:39,469 --> 02:25:39,750
like every.

4059
02:25:39,855 --> 02:25:41,495
Else has felt like a bit of a fire hose.

4060
02:25:41,684 --> 02:25:43,434
It is in the process of your final

4061
02:25:43,434 --> 02:25:46,764
project of specking out and proposing and executing

4062
02:25:46,764 --> 02:25:48,674
your own final project that will make all

4063
02:25:48,674 --> 02:25:50,804
of this feel much more comfortable and familiar,

4064
02:25:50,855 --> 02:25:54,474
and you'll look back on so many of the past weeks as useful building blocks,

4065
02:25:54,724 --> 02:25:58,115
but this then was your CS 50 education week 0 through 9.

4066
02:25:58,245 --> 02:26:00,054
We have just one more left next week,

4067
02:26:00,125 --> 02:26:00,844
so we'll see you then.